
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Viewing STIS Data &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css?v=cd6c26fb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/STIS/view_data/view_data';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="1D Spectra Extraction" href="../extraction/1D_Extraction.html" />
    <link rel="prev" title="Evaluating STIS Target Acquisitions" href="../target_acquisition/target_acquisition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="HST Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="HST Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI HST Notebook Repository HQ
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ACS/README.html">ACS Notebooks</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_cte_forward_model/acs_cte_forward_model_example.html">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_pixel_area_maps/acs_pixel_area_maps.html">Obtaining Pixel Area Maps for ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/README.html">DrizzlePac Jupyter Notebook Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/Initialization/Initialization.html">DrizzlePac Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_to_catalogs/align_to_catalogs.html">Aligning HST images to an absolute reference catalog</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>








<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/drizzle_wfpc2/drizzle_wfpc2.html">Drizzling WFPC2 Images to use a Single Zeropoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/optimize_image_sampling/optimize_image_sampling.html">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/sky_matching/sky_matching.html">Sky Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/use_ds9_regions_in_tweakreg/use_ds9_regions_in_tweakreg.html">Using DS9 Regions to Include and Exclude Sources in HST Image Alignment with TWEAKREG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Using updated astrometry solutions</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HASP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../HASP/Setup/Setup.html">Installing the Hubble Advanced Spectral Products Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HASP/CoaddTutorial/CoaddTutorial.html">Inputting User Data using the Hubble Advanced Spectral Products Script</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../HASP/FluxScaleTutorial/FluxScaleTutorial.html">Scaling Flux while using the Hubble Advanced Spectral Products Script</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">STIS-Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cross-correlation/cross-correlation.html">Correcting for Missing Wavecals with Cross-Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_ccd_darks/custom_ccd_darks.html">Custom CCD Darks <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../drizpac_notebook/STIS_DrizzlePac_Tutorial.html">STIS DrizzlePac Tutorial <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.html">STIS Coronagraphy Visualization Tool (v2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calstis/calstis_2d_ccd.html">Calstis 2-D CCD Data Reduction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../target_acquisition/target_acquisition.html">Evaluating STIS Target Acquisitions <a class="tocSkip"></a></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">WFC3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/README.html">WFC3 Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/calwf3_recalibration/calwf3_recal_tvb.html">Manual Recalibration with calwf3: Turning off the IR Linear Ramp Fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.html">Processing WFC3/UVIS Data with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Using the v1.0 CTE-Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/exception_report/wfc3_exception_report.html">Exception Report Checklist - WFC3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/image_displayer_analyzer/wfc3_image_displayer_analyzer.html">WFC3 Image Displayer &amp; Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_ima_visualization/IR_IMA_Visualization_with_an_Example_of_Time_Variable_Background.html">WFC3/IR IMA Visualization Tools with An Example of Time Variable Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_scattered_light_calwf3_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_Using_calwf3_to_Mask_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Using <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> to Mask Bad Reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_scattered_light_manual_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_by_Manually_Subtracting_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Manually Subtracting Bad Reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/persistence/wfc3_ir_persistence.html">Masking Persistence in WFC3/IR Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/tvb_flattenramp/TVB_flattenramp_notebook.html">Correcting for Helium Line Emission Background in IR Exposures using the “Flatten-Ramp” Technique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/photometry_examples/phot_examples.html">Synthetic Photometry Examples for WFC3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/uvis_pam_corrections/WFC3_UVIS_Pixel_Area_Map_Corrections_for_Subarrays.html">WFC3/UVIS Pixel Area Map Corrections for Subarrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/uvis_time_dependent_photometry/uvis_timedep_phot.html">WFC3/UVIS Time-dependent Photometry</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/STIS/view_data/view_data.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/STIS/view_data/view_data.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/STIS/view_data/view_data.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Viewing STIS Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">0. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-necessary-packages">0.1 Import necessary packages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-stis-data-from-mast-using-astroquery">1. Downloading STIS data from MAST using <code class="docutils literal notranslate"><span class="pre">astroquery</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-in-the-data">2. Reading in the data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#investigating-the-data-basics">2.1 Investigating the data - Basics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-table-data">2.2 Reading table data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-spectrum">3. Plotting the spectrum</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-simple-plot-of-the-spectrum">3.1 Making a simple plot of the spectrum</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-data-quality-flags">4.Working with data quality flags</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality-frequencies-histogram">4.1 Data quality frequencies histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-serious-data-quality-flags">4.2 Removing “Serious Data Quality Flags”</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-stis-image">5. Visualizing STIS Image</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-image-file-structure">5.1 Exploring image file structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#showing-the-image">5.2 Showing the image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-serious-data-quality-pixels">5.3 Removing serious data quality pixels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-time-tag-data">6.Working with Time-Tag data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#investigating-the-tag-data">6.1 Investigating the _tag data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-time-tag-into-accum-image">6.2 Converting Time_Tag into ACCUM image</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-stis-echelle-data">7.Working with STIS Echelle data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#showing-echelle-image">7.1 Showing Echelle Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-echelle-spectrum">7.2 Plotting Echelle Spectrum</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a id=top></a></p>
<section id="viewing-stis-data">
<h1>Viewing STIS Data<a class="headerlink" href="#viewing-stis-data" title="Link to this heading">#</a></h1>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<p>By the end of this tutorial, you will go through:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#section0"><span class="xref myst">0.Introduction</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section0.1"><span class="xref myst">0.1 Import necessary packages</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section1"><span class="xref myst">1. Downloading STIS data from MAST using astroquery</span></a></p></li>
<li><p><a class="reference internal" href="#section2"><span class="xref myst">2. Reading in the data</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section2.1"><span class="xref myst">2.1 Investigating the data - Basics</span></a></p></li>
<li><p><a class="reference internal" href="#section2.2"><span class="xref myst">2.2 Reading the table data</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section3"><span class="xref myst">3. Plotting the spectrum</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section3.1"><span class="xref myst">3.1 Making a simple plot of the spectrum</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section4"><span class="xref myst">4. Working with data quality flags</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section4.1"><span class="xref myst">4.1 Data quality frequencies histogram</span></a></p></li>
<li><p><a class="reference internal" href="#section4.2"><span class="xref myst">4.2 Removing “Serious Data Quality”</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section5"><span class="xref myst">5. Visualizing STIS Image</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section5.1"><span class="xref myst">5.1 Exploring image file structure</span></a></p></li>
<li><p><a class="reference internal" href="#section5.2"><span class="xref myst">5.2 Showing the image</span></a></p></li>
<li><p><a class="reference internal" href="#section5.3"><span class="xref myst">5.3 Removing serious data quality pixels</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section6"><span class="xref myst">6.Working with Time-Tag Data</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section6.1"><span class="xref myst">6.1 Investigating the _tag Data</span></a></p></li>
<li><p><a class="reference internal" href="#section6.2"><span class="xref myst">6.2 Converting Time_Tag into ACCUM image</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section7"><span class="xref myst">7.Working with STIS Echelle data</span></a></p>
<ul>
<li><p><a class="reference internal" href="#section7.1"><span class="xref myst">7.1 Showing Echelle Image</span></a></p></li>
<li><p><a class="reference internal" href="#section7.2"><span class="xref myst">7.2 Plotting Echelle Spectrum</span></a></p></li>
</ul>
</li>
</ul>
<p><a id=section0></a></p>
</section>
<section id="introduction">
<h2>0. Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p><strong>The Space Telescope Imaging Spectrograph (<a class="reference external" href="https://www.stsci.edu/hst/instrumentation/stis">STIS</a>) is a versatile imaging spectrograph installed on the Hubble Space Telescope (<a class="reference external" href="https://www.stsci.edu/hst/about">HST</a>), covering a wide range of wavelengths from the near-infrared region into the ultraviolet.</strong></p>
<p><strong>This tutorial aims to prepare new users to begin analyzing STIS data by going through downloading data, reading and viewing spectra, and viewing STIS images.</strong></p>
<p><strong>There are three detectors on STIS: FUV-MAMA, NUV-MAMA, and CCD. While the detectors are designed for different scientific purposes and operate at a different wavelength, their data are organized in the same structure. Thus we are using FUV-MAMA data as an example in this notebook.</strong></p>
<p>For a detailed overview of the STIS instrument, see the <a class="reference external" href="https://hst-docs.stsci.edu/stisihb">STIS Instrument Handbook</a>. <br />
For more information on STIS data analysis and operations, see the <a class="reference external" href="https://hst-docs.stsci.edu/stisdhb">STIS Data Handbook</a>.</p>
<p><strong>Defining some terms:</strong></p>
<ul class="simple">
<li><p><strong>HST:</strong> Hubble Space Telescope</p></li>
<li><p><strong>STIS:</strong> Space Telescope Imaging Spectrograph on HST (https://www.stsci.edu/hst/instrumentation/stis)</p></li>
<li><p><strong>STIS/NUV-MAMA:</strong> Cs2Te Multi-Anode Microchannel Array (MAMA) detector for observing mainly in the near ultraviolet (NUV)</p></li>
<li><p><strong>STIS/FUV-MAMA:</strong> Solar-blind CsI Multi-Anode Microchannel Array (MAMA) detector for observing mainly in the far ultraviolet (FUV)</p></li>
<li><p><strong>CCD:</strong> Charge Coupled Device</p></li>
<li><p><strong>FITS:</strong> Flexible Image Transport System (https://fits.gsfc.nasa.gov/fits_primer.html)</p></li>
<li><p><strong>HDU:</strong> Header/Data Unit in a FITS file</p></li>
</ul>
<p><a id=section0.1></a></p>
<section id="import-necessary-packages">
<h3>0.1 Import necessary packages<a class="headerlink" href="#import-necessary-packages" title="Link to this heading">#</a></h3>
<p><strong>We will import the following packages:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> for accessing FITS files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">astropy.table.Table</span></code> for creating tidy tables of the data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">astroquery.mast.Observations</span></code> for finding and downloading data from the <a class="reference external" href="https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html">MAST</a> archive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pathlib</span></code> for managing system paths</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> for plotting data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IPython.display</span></code> for formatting display</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> to handle array functions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> to make basic tables and dataframes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stistools</span></code> for operations on STIS data</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import for: Reading in fits file</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>

<span class="c1"># Import for: Downloading necessary files. (Not necessary if you choose to collect data from MAST)</span>
<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Observations</span>

<span class="c1"># Import for: Managing system variables and paths</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Import for: Plotting and specifying plotting parameters</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># Import for: Quick Calculation and Data Analysis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Import for operations on STIS Data</span>
<span class="kn">import</span> <span class="nn">stistools</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following tasks in the stistools package can be run with TEAL:
   basic2d      calstis     ocrreject     wavecal        x1d          x2d
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.6/x64/lib/python3.11/site-packages/stsci/tools/nmpfit.py:8: UserWarning: NMPFIT is deprecated - stsci.tools v 3.5 is the last version to contain it.
  warnings.warn(&quot;NMPFIT is deprecated - stsci.tools v 3.5 is the last version to contain it.&quot;)
/opt/hostedtoolcache/Python/3.11.6/x64/lib/python3.11/site-packages/stsci/tools/gfit.py:18: UserWarning: GFIT is deprecated - stsci.tools v 3.4.12 is the last version to contain it.Use astropy.modeling instead.
  warnings.warn(&quot;GFIT is deprecated - stsci.tools v 3.4.12 is the last version to contain it.&quot;
</pre></div>
</div>
</div>
</div>
<p><a id=section1></a></p>
</section>
</section>
<section id="downloading-stis-data-from-mast-using-astroquery">
<h2>1. Downloading STIS data from <a class="reference external" href="https://archive.stsci.edu/">MAST</a> using <a class="reference external" href="https://astroquery.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">astroquery</span></code></a><a class="headerlink" href="#downloading-stis-data-from-mast-using-astroquery" title="Link to this heading">#</a></h2>
<p>There are other ways to download data from MAST such as using CyberDuck. We are only showing how to use astroquery in this notebook</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make directory for downloading data</span>
<span class="n">datadir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./data&#39;</span><span class="p">)</span>
<span class="n">datadir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search target object by obs_id</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;ODJ102010&#39;</span><span class="p">)</span>
<span class="c1"># get a list of files assiciated with that target</span>
<span class="n">FUV_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<span class="c1"># Download only the SCIENCE fits files</span>
<span class="n">downloads</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span>
    <span class="n">FUV_list</span><span class="p">,</span>
    <span class="n">productType</span><span class="o">=</span><span class="s1">&#39;SCIENCE&#39;</span><span class="p">,</span>
    <span class="n">extension</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">,</span>
    <span class="n">download_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">datadir</span><span class="p">))</span>
<span class="n">downloads</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odj102010_raw.fits to data/mastDownload/HST/odj102010/odj102010_raw.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odj102010_x1d.fits to data/mastDownload/HST/odj102010/odj102010_x1d.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odj102010_x2d.fits to data/mastDownload/HST/odj102010/odj102010_x2d.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odj102010_flt.fits to data/mastDownload/HST/odj102010/odj102010_flt.fits ... [Done]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=4</i>
<table id="table140527293601104" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str50</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>data/mastDownload/HST/odj102010/odj102010_raw.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odj102010/odj102010_x1d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odj102010/odj102010_x2d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odj102010/odj102010_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p><a id=section2></a></p>
</section>
<section id="reading-in-the-data">
<h2>2. Reading in the data<a class="headerlink" href="#reading-in-the-data" title="Link to this heading">#</a></h2>
<p><a id=section2.1></a></p>
<section id="investigating-the-data-basics">
<h3>2.1 Investigating the data - Basics<a class="headerlink" href="#investigating-the-data-basics" title="Link to this heading">#</a></h3>
<p>Before doing any operations on the data, we want to first explore the basics and data file structures.</p>
<p>The 1D-extracted, background subtracted, flux and wavelength calibrated spectra data are stored in a FITS file with suffix <code class="docutils literal notranslate"><span class="pre">_x1d</span></code> (note that for the CCD it is <code class="docutils literal notranslate"><span class="pre">_sx1</span></code>). While we are using the <code class="docutils literal notranslate"><span class="pre">_x1d</span></code> FITS file as an example of investigating STIS data, the following methods for reading in data and viewing a spectra or other fields can be applied to the other STIS data, either calibrated or uncalibrated. For more information on STIS file naming conventions, see <a class="reference external" href="https://hst-docs.stsci.edu/stisdhb/chapter-2-stis-data-structure/2-2-types-of-stis-files">Types of STIS Files</a> in the STIS Data Handbook.</p>
<p>Open the <code class="docutils literal notranslate"><span class="pre">x1d</span></code> fits file and explore its info and header:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get information about the fits file</span>
<span class="n">x1d_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./data/mastDownload/HST/odj102010/odj102010_x1d.fits&#39;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">x1d_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: data/mastDownload/HST/odj102010/odj102010_x1d.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     274   ()      
  1  SCI           1 BinTableHDU    157   1R x 19C   [1I, 1I, 1024D, 1024E, 1024E, 1024E, 1024E, 1024E, 1024E, 1024I, 1E, 1E, 1I, 1E, 1E, 1E, 1E, 1024E, 1E]   
</pre></div>
</div>
</div>
</div>
<p>The primary header that stores keyword information describing the global properties of all of the exposures in the file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get header of the fits file</span>
<span class="n">x1d_header_0</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">x1d_file</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;INSTRUME&quot;</span><span class="p">,</span> <span class="s2">&quot;DETECTOR&quot;</span><span class="p">,</span> <span class="s2">&quot;OBSMODE&quot;</span><span class="p">,</span> <span class="s2">&quot;OPT_ELEM&quot;</span><span class="p">,</span> <span class="s2">&quot;CENWAVE&quot;</span><span class="p">,</span> <span class="s2">&quot;PROPAPER&quot;</span><span class="p">,</span> <span class="s2">&quot;TARGNAME&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="si">{</span><span class="n">x1d_header_0</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>   
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INSTRUME:	STIS
DETECTOR:	FUV-MAMA
OBSMODE:	ACCUM
OPT_ELEM:	G140M
CENWAVE:	1540
PROPAPER:	52X0.2
TARGNAME:	-ALF-CEP
</pre></div>
</div>
</div>
</div>
<p>You can change the keys to check for other fields and metadata, or directly print the x1d_header_0 to get all header information.</p>
<p>Some other metadata, such as exposure data and time, are stored in the first extension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1d_header_1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">x1d_file</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">date</span> <span class="o">=</span> <span class="n">x1d_header_1</span><span class="p">[</span><span class="s2">&quot;DATE-OBS&quot;</span><span class="p">]</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">x1d_header_1</span><span class="p">[</span><span class="s2">&quot;Time-OBS&quot;</span><span class="p">]</span>
<span class="n">exptime</span> <span class="o">=</span> <span class="n">x1d_header_1</span><span class="p">[</span><span class="s2">&quot;EXPTIME&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The data were taken on </span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s2">, starting at </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">, with the exposure time of </span><span class="si">{</span><span class="n">exptime</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The data were taken on 2018-01-14, starting at 08:31:01, with the exposure time of 900.0 seconds
</pre></div>
</div>
</div>
</div>
<p><a id=section2.2></a></p>
</section>
<section id="reading-table-data">
<h3>2.2 Reading table data<a class="headerlink" href="#reading-table-data" title="Link to this heading">#</a></h3>
<p>The main science data is stored in the first extension of the x1d FITS file. We first read in the data as an astropy Table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get data</span>
<span class="n">x1d_data</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">x1d_file</span><span class="p">,</span> <span class="n">hdu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Display a representation of the data:</span>
<span class="n">x1d_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: UnitsWarning: &#39;Angstroms&#39; did not parse as fits unit: At col 0, Unit &#39;Angstroms&#39; not supported by the FITS standard. Did you mean Angstrom or angstrom? If this is meant to be a custom unit, define it with &#39;u.def_unit&#39;. To have it recognized inside a file reader or other code, enable it with &#39;u.add_enabled_units&#39;. For details, see https://docs.astropy.org/en/latest/units/combining_and_defining.html [astropy.units.core]
WARNING: UnitsWarning: &#39;Counts/s&#39; did not parse as fits unit: At col 0, Unit &#39;Counts&#39; not supported by the FITS standard. Did you mean count? If this is meant to be a custom unit, define it with &#39;u.def_unit&#39;. To have it recognized inside a file reader or other code, enable it with &#39;u.add_enabled_units&#39;. For details, see https://docs.astropy.org/en/latest/units/combining_and_defining.html [astropy.units.core]
WARNING: UnitsWarning: &#39;erg/s/cm**2/Angstrom&#39; contains multiple slashes, which is discouraged by the FITS standard [astropy.units.format.generic]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140527292319312" class="table-striped table-bordered table-condensed">
<thead><tr><th>SPORDER</th><th>NELEM</th><th>WAVELENGTH</th><th>GROSS</th><th>BACKGROUND</th><th>NET</th><th>FLUX</th><th>ERROR</th><th>NET_ERROR</th><th>DQ</th><th>A2CENTER</th><th>EXTRSIZE</th><th>MAXSRCH</th><th>BK1SIZE</th><th>BK2SIZE</th><th>BK1OFFST</th><th>BK2OFFST</th><th>EXTRLOCY</th><th>OFFSET</th></tr></thead>
<thead><tr><th></th><th></th><th>Angstroms</th><th>Counts/s</th><th>Counts/s</th><th>Counts/s</th><th>erg / (Angstrom cm2 s)</th><th>erg / (Angstrom cm2 s)</th><th>Counts/s</th><th></th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th></tr></thead>
<thead><tr><th>int16</th><th>int16</th><th>float64[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>int16[1024]</th><th>float32</th><th>float32</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32[1024]</th><th>float32</th></tr></thead>
<tr><td>1</td><td>1024</td><td>1513.611692349868 ..         1567.668670092399</td><td>1.423279 ..      0.04860059</td><td>0.0008550065 ..    -6.92308e-05</td><td>1.422424 ..      0.04866982</td><td>1.96904e-12 ..     9.89624e-14</td><td>5.507516e-14 ..    1.495948e-14</td><td>0.03978601 ..     0.007357089</td><td>2564 ..        2564</td><td>389.5777</td><td>11</td><td>1024</td><td>5</td><td>5</td><td>-300</td><td>300</td><td>382.2857 ..        397.2364</td><td>351.8867</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can also get the columns of this table:</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">x1d_data</span><span class="o">.</span><span class="n">colnames</span>
<span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;SPORDER&#39;,
 &#39;NELEM&#39;,
 &#39;WAVELENGTH&#39;,
 &#39;GROSS&#39;,
 &#39;BACKGROUND&#39;,
 &#39;NET&#39;,
 &#39;FLUX&#39;,
 &#39;ERROR&#39;,
 &#39;NET_ERROR&#39;,
 &#39;DQ&#39;,
 &#39;A2CENTER&#39;,
 &#39;EXTRSIZE&#39;,
 &#39;MAXSRCH&#39;,
 &#39;BK1SIZE&#39;,
 &#39;BK2SIZE&#39;,
 &#39;BK1OFFST&#39;,
 &#39;BK2OFFST&#39;,
 &#39;EXTRLOCY&#39;,
 &#39;OFFSET&#39;]
</pre></div>
</div>
</div>
</div>
<p>Another common way of reading in FITS data from an HDU list as “FITS_rec”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">x1d_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdulist</span><span class="p">:</span>
    <span class="n">fuv_x1d_data</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
<span class="nb">type</span><span class="p">(</span><span class="n">fuv_x1d_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>astropy.io.fits.fitsrec.FITS_rec
</pre></div>
</div>
</div>
</div>
<p><a id=section3></a></p>
</section>
</section>
<section id="plotting-the-spectrum">
<h2>3. Plotting the spectrum<a class="headerlink" href="#plotting-the-spectrum" title="Link to this heading">#</a></h2>
<p><a id=section3.1></a></p>
<section id="making-a-simple-plot-of-the-spectrum">
<h3>3.1 Making a simple plot of the spectrum<a class="headerlink" href="#making-a-simple-plot-of-the-spectrum" title="Link to this heading">#</a></h3>
<p>The actual data of each column are stored in arrays within each row with equal lengths. We collect the spectrum data and plot them with corresponding error bars.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># From the astropy table, we first get all the data we need: wavelength, flux, and error</span>
<span class="c1"># notice that for astropy table, the column name is case sensitive</span>
<span class="c1"># First-order data have data in only the 0th row, so we extract this sparse dimension.</span>
<span class="n">wl</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">x1d_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;WAVELENGTH&#39;</span><span class="p">,</span> <span class="s1">&#39;FLUX&#39;</span><span class="p">,</span> <span class="s1">&#39;ERROR&#39;</span><span class="p">]</span>

<span class="c1"># Make a plot of the data, use this cell to specify the format of the plot.</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span>  <span class="c1"># the x-data &amp; y-data</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># specifies the data points style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">flux</span> <span class="o">-</span> <span class="n">err</span><span class="p">,</span> <span class="n">flux</span> <span class="o">+</span> <span class="n">err</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># shade regions by width of error array</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;STIS FUV Spectrum&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux (ergs/s/cm$^2$/Å)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Flux (ergs/s/cm$^2$/Å)&#39;)
</pre></div>
</div>
<img alt="../../../_images/437b45a35fb210899f04196af9b0e4c28741eec4c400cf5541d84c00fe8c12b0.png" src="../../../_images/437b45a35fb210899f04196af9b0e4c28741eec4c400cf5541d84c00fe8c12b0.png" />
</div>
</div>
<p>You can zoom in to a specific wavelength range</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the spectrum between 1540 and 1560 Å:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span>  <span class="c1"># the x-data &amp; y-data</span>
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># specifies the data point style</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># specifies the format of lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">flux</span> <span class="o">-</span> <span class="n">err</span><span class="p">,</span> <span class="n">flux</span> <span class="o">+</span> <span class="n">err</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># shade regions by width of error array</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;STIS FUV Spectrum&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Flux (ergs/s/cm$^2$/Å)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1540</span><span class="p">,</span> <span class="mi">1560</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1540.0, 1560.0)
</pre></div>
</div>
<img alt="../../../_images/f526334d6a0a33eaaacaf683c3bc903a9428bd78ac97e90b68d295569f01bccc.png" src="../../../_images/f526334d6a0a33eaaacaf683c3bc903a9428bd78ac97e90b68d295569f01bccc.png" />
</div>
</div>
<p>You can also plot the error bar together with the spectrum. For more errorbar styling options, see <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.errorbar.html"><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.errorbar</span></code></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span>  <span class="c1"># the x-data, y-data, and y-axis error</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>  <span class="c1"># specifies the data points style</span>
             <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># specifies the format of lines and error bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;STIS FUV Spectrum&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux (ergs/s/cm$^2$/Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1540</span><span class="p">,</span> <span class="mi">1560</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1540.0, 1560.0)
</pre></div>
</div>
<img alt="../../../_images/5972ebc905ef66051a07417a23f59c5350e0d0259a444166637906a388391ef1.png" src="../../../_images/5972ebc905ef66051a07417a23f59c5350e0d0259a444166637906a388391ef1.png" />
</div>
</div>
<p>For more information on formatting the plots using matplotlib, see <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html"><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot</span></code></a>, <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.errorbar.html"><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.errorbar</span></code></a>.</p>
<p><a id=section4></a></p>
</section>
</section>
<section id="working-with-data-quality-flags">
<h2>4.Working with data quality flags<a class="headerlink" href="#working-with-data-quality-flags" title="Link to this heading">#</a></h2>
<p>Data quality flags are assigned to each pixel in the data quality extension. Each flag has a true (set) or false (unset) state. Flagged conditions are set as specific bits in a 16-bit integer word. For a single pixel, this allows for up to 15 data quality conditions to be flagged simultaneously, using the bitwise logical OR operation. Note that the data quality flags cannot be interpreted simply as integers but may be converted to base-2 and interpreted as flags. These flags are set and used during the course of calibration, and may likewise be interpreted and used by downstream analysis applications.</p>
<p><a id=section4.1></a></p>
<section id="data-quality-frequencies-histogram">
<h3>4.1 Data quality frequencies histogram<a class="headerlink" href="#data-quality-frequencies-histogram" title="Link to this heading">#</a></h3>
<p>Make a histogram according to the data quality flags, and label the bins by what each data quality values actually means.
More info: https://hst-docs.stsci.edu/stisdhb/chapter-2-stis-data-structure/2-5-error-and-data-quality-array</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First get the possible data quality flag values to bitwise-and with the data quality flag:</span>
<span class="n">dq_flags</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Exclusively 0&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="n">dq_bits</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># In the Table representation, the data quality flag is a masked array that &quot;hides&quot; the pixels</span>
<span class="c1"># with no data quality issue. We fill those &quot;good points&quot; with 0 here when counting:</span>
<span class="n">dq_bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">x1d_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;DQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># exclusively 0</span>

<span class="c1"># Loop over non-zero flag values and count each:</span>
<span class="k">for</span> <span class="n">dq_flag</span> <span class="ow">in</span> <span class="n">dq_flags</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">dq_bits</span><span class="p">[</span><span class="n">dq_flag</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">((</span><span class="n">x1d_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;DQ&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dq_flag</span><span class="p">))</span>

<span class="n">dq_bits</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0: 960,
 1: 0,
 2: 0,
 4: 8,
 8: 0,
 16: 43,
 32: 0,
 64: 0,
 128: 0,
 256: 0,
 512: 9,
 1024: 0,
 2048: 22,
 4096: 0,
 8192: 0,
 16384: 0}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign the meaning of each data quality and make a histogram</span>
<span class="n">meanings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span>  <span class="s2">&quot;No Anomalies&quot;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span>  <span class="s2">&quot;Error in the Reed Solomon decoding&quot;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span>  <span class="s2">&quot;Lost data replaced by fill values&quot;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span>  <span class="s2">&quot;Bad detector pixel (e.g., bad column or row, mixed science and bias for overscan, or beyond aperture)&quot;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span>  <span class="s2">&quot;Data masked by occulting bar&quot;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span>  <span class="s2">&quot;Pixel having dark rate &gt; 5 σ times the median dark level&quot;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span>  <span class="s2">&quot;Large blemish, depth &gt; 40</span><span class="si">% o</span><span class="s2">f the normalized p-flat (repeller wire)&quot;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span>  <span class="s2">&quot;Vignetted pixel&quot;</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">:</span>  <span class="s2">&quot;Pixel in the overscan region&quot;</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">:</span>  <span class="s2">&quot;Saturated pixel, count rate at 90</span><span class="si">% o</span><span class="s2">f max possible—local non-linearity turns over and is multi-valued; &quot;</span>
        <span class="s2">&quot;pixels within 10</span><span class="si">% o</span><span class="s2">f turnover and all pixels within 4 pixels of that pixel are flagged.&quot;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;Bad pixel in reference file&quot;</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;Small blemish, depth between 40</span><span class="si">% a</span><span class="s2">nd 70</span><span class="si">% o</span><span class="s2">f the normalized flat. Applies to MAMA and CCD p-flats&quot;</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">:</span> <span class="s2">&quot;&gt;30</span><span class="si">% o</span><span class="s2">f background pixels rejected by sigma-clip, or flagged, during 1-D spectral extraction&quot;</span><span class="p">,</span>
    <span class="mi">13</span><span class="p">:</span> <span class="s2">&quot;Extracted flux affected by bad input data&quot;</span><span class="p">,</span>
    <span class="mi">14</span><span class="p">:</span> <span class="s2">&quot;Data rejected in input pixel during image combination for cosmic ray rejection&quot;</span><span class="p">,</span>
    <span class="mi">15</span><span class="p">:</span> <span class="s2">&quot;Extracted flux not CTI corrected because gross counts are ≤ 0&quot;</span><span class="p">}</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">meanings</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">height</span><span class="o">=</span><span class="n">dq_bits</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">tick_label</span><span class="o">=</span><span class="n">dq_flags</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">dq_flags</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">bits</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">0</span><span class="si">:</span><span class="s1">015b</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="si">:</span><span class="s1">015b</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)]</span>

<span class="n">dq_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Flag Value&quot;</span><span class="p">:</span> <span class="n">dq_flags</span><span class="p">,</span>
    <span class="s2">&quot;Bit Setting&quot;</span><span class="p">:</span> <span class="n">bits</span><span class="p">,</span>
    <span class="s2">&quot;Quality Condition Indicated&quot;</span><span class="p">:</span> <span class="n">meanings</span><span class="o">.</span><span class="n">values</span><span class="p">()})</span>
<span class="n">dq_table</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Flag Value&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">dq_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/7666181c0c6a7e6fc521fe2a7bcad7c3fdb1459b16e20141fbb4474cab508469.png" src="../../../_images/7666181c0c6a7e6fc521fe2a7bcad7c3fdb1459b16e20141fbb4474cab508469.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bit Setting</th>
      <th>Quality Condition Indicated</th>
    </tr>
    <tr>
      <th>Flag Value</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Exclusively 0</th>
      <td>000000000000000</td>
      <td>No Anomalies</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000000000000001</td>
      <td>Error in the Reed Solomon decoding</td>
    </tr>
    <tr>
      <th>2</th>
      <td>000000000000010</td>
      <td>Lost data replaced by fill values</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000000000000100</td>
      <td>Bad detector pixel (e.g., bad column or row, mixed science and bias for overscan, or beyond aperture)</td>
    </tr>
    <tr>
      <th>8</th>
      <td>000000000001000</td>
      <td>Data masked by occulting bar</td>
    </tr>
    <tr>
      <th>16</th>
      <td>000000000010000</td>
      <td>Pixel having dark rate &gt; 5 σ times the median dark level</td>
    </tr>
    <tr>
      <th>32</th>
      <td>000000000100000</td>
      <td>Large blemish, depth &gt; 40% of the normalized p-flat (repeller wire)</td>
    </tr>
    <tr>
      <th>64</th>
      <td>000000001000000</td>
      <td>Vignetted pixel</td>
    </tr>
    <tr>
      <th>128</th>
      <td>000000010000000</td>
      <td>Pixel in the overscan region</td>
    </tr>
    <tr>
      <th>256</th>
      <td>000000100000000</td>
      <td>Saturated pixel, count rate at 90% of max possible—local non-linearity turns over and is multi-valued; pixels within 10% of turnover and all pixels within 4 pixels of that pixel are flagged.</td>
    </tr>
    <tr>
      <th>512</th>
      <td>000001000000000</td>
      <td>Bad pixel in reference file</td>
    </tr>
    <tr>
      <th>1024</th>
      <td>000010000000000</td>
      <td>Small blemish, depth between 40% and 70% of the normalized flat. Applies to MAMA and CCD p-flats</td>
    </tr>
    <tr>
      <th>2048</th>
      <td>000100000000000</td>
      <td>&gt;30% of background pixels rejected by sigma-clip, or flagged, during 1-D spectral extraction</td>
    </tr>
    <tr>
      <th>4096</th>
      <td>001000000000000</td>
      <td>Extracted flux affected by bad input data</td>
    </tr>
    <tr>
      <th>8192</th>
      <td>010000000000000</td>
      <td>Data rejected in input pixel during image combination for cosmic ray rejection</td>
    </tr>
    <tr>
      <th>16384</th>
      <td>100000000000000</td>
      <td>Extracted flux not CTI corrected because gross counts are ≤ 0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a id=section4.2></a></p>
</section>
<section id="removing-serious-data-quality-flags">
<h3>4.2 Removing “Serious Data Quality Flags”<a class="headerlink" href="#removing-serious-data-quality-flags" title="Link to this heading">#</a></h3>
<p>Through the calibaration pipeline, some data qualities are marked “serious”. The value of serious data qualities are marked through “SDQFLAGS”. We can decompose that value according to the bits in order to see the specific data quality flags that are marked serious.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdqFlags_fuv</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getval</span><span class="p">(</span><span class="n">x1d_file</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keyword</span><span class="o">=</span><span class="s2">&quot;SDQFLAGS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The SDQFLAGS is </span><span class="si">{</span><span class="n">sdqFlags_fuv</span><span class="si">}</span><span class="s1">, which is in binary </span><span class="si">{</span><span class="n">sdqFlags_fuv</span><span class="si">:</span><span class="s1">015b</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Therefore the following data qualities are marked &quot;serious&quot;:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">2</span><span class="o">**</span><span class="n">i</span> <span class="o">&amp;</span> <span class="n">sdqFlags_fuv</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s1">2.0f</span><span class="si">}</span><span class="s1">: &#39;</span> <span class="o">+</span> <span class="n">meanings</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The SDQFLAGS is 31743, which is in binary 111101111111111,
Therefore the following data qualities are marked &quot;serious&quot;:
	 1: Error in the Reed Solomon decoding
	 2: Lost data replaced by fill values
	 3: Bad detector pixel (e.g., bad column or row, mixed science and bias for overscan, or beyond aperture)
	 4: Data masked by occulting bar
	 5: Pixel having dark rate &gt; 5 σ times the median dark level
	 6: Large blemish, depth &gt; 40% of the normalized p-flat (repeller wire)
	 7: Vignetted pixel
	 8: Pixel in the overscan region
	 9: Saturated pixel, count rate at 90% of max possible—local non-linearity turns over and is multi-valued; pixels within 10% of turnover and all pixels within 4 pixels of that pixel are flagged.
	10: Bad pixel in reference file
	12: &gt;30% of background pixels rejected by sigma-clip, or flagged, during 1-D spectral extraction
	13: Extracted flux affected by bad input data
	14: Data rejected in input pixel during image combination for cosmic ray rejection
	15: Extracted flux not CTI corrected because gross counts are ≤ 0
</pre></div>
</div>
</div>
</div>
<p>We can now remove the data points with SDQ flags. In the plots below, the first one is the same as the spectrum in which we do not handle the SDQ flags. The second one is the spectrum with SDQ flagged data removed, and the SDQ flagged data points are marked with red ‘+’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">)</span>

<span class="c1"># First zoom in to the region where SDQ got removed</span>
<span class="n">wl</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">dq</span> <span class="o">=</span> <span class="n">x1d_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;WAVELENGTH&#39;</span><span class="p">,</span> <span class="s1">&#39;FLUX&#39;</span><span class="p">,</span> <span class="s1">&#39;ERROR&#39;</span><span class="p">,</span> <span class="s1">&#39;DQ&#39;</span><span class="p">]</span>

<span class="c1"># Filter the datapoints to where there are no serious DQ flags</span>
<span class="n">mask_noSDQ</span> <span class="o">=</span> <span class="p">(</span><span class="n">dq</span> <span class="o">&amp;</span> <span class="n">sdqFlags_fuv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

<span class="c1"># get the spectrum without SDQ using the mask we just created</span>
<span class="n">wvln_noSDQ</span><span class="p">,</span> <span class="n">flux_noSDQ</span><span class="p">,</span> <span class="n">err_noSDQ</span> <span class="o">=</span> <span class="n">wl</span><span class="p">[</span><span class="n">mask_noSDQ</span><span class="p">],</span> <span class="n">flux</span><span class="p">[</span><span class="n">mask_noSDQ</span><span class="p">],</span> <span class="n">err</span><span class="p">[</span><span class="n">mask_noSDQ</span><span class="p">]</span>
<span class="c1"># inverse the _noSDQ mask to collect the data points with SDQ flags</span>
<span class="n">wvln_SDQ</span><span class="p">,</span> <span class="n">flux_SDQ</span> <span class="o">=</span> <span class="n">wl</span><span class="p">[</span><span class="o">~</span><span class="n">mask_noSDQ</span><span class="p">],</span> <span class="n">flux</span><span class="p">[</span><span class="o">~</span><span class="n">mask_noSDQ</span><span class="p">]</span>  <span class="c1"># apply the bitwise-not of mask</span>

<span class="c1"># plot1: the spectrum with SDQ flagged data included</span>
<span class="c1"># plt.subplot(2,1,1)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wl</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span>  <span class="c1"># the x-data, y-data</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># specifies the data points style</span>

<span class="c1"># plot2: plot the spectrum without SDQ flagged data, then mark the SDQ data points with +</span>
<span class="c1"># Plot the filtered datapoints</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wvln_noSDQ</span><span class="p">,</span> <span class="n">flux_noSDQ</span><span class="p">,</span>  <span class="c1"># the x-data, y-data</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;SDQ cleaned spectrum&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wvln_SDQ</span><span class="p">,</span> <span class="n">flux_SDQ</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SDQ-flagged data&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

<span class="c1"># Format the figures:</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FUV with SDQ-flagged data&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FUV without SDQ flagged data&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (Å)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flux (ergs/s/cm$^2$/Å)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">wl</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1520</span><span class="p">)</span>  <span class="c1"># zoom in on left edge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/f812591c0beef7b76eb380e4dc7a102883a40deebab3cd2e5986bcdf79934387.png" src="../../../_images/f812591c0beef7b76eb380e4dc7a102883a40deebab3cd2e5986bcdf79934387.png" />
</div>
</div>
<p><a id=section5></a></p>
</section>
</section>
<section id="visualizing-stis-image">
<h2>5. Visualizing STIS Image<a class="headerlink" href="#visualizing-stis-image" title="Link to this heading">#</a></h2>
<p>The STIS images are stored as two-dimensional arrays in FITS image extension files. For more information on STIS image files and extension, see <a class="reference external" href="https://hst-docs.stsci.edu/stisdhb/chapter-2-stis-data-structure/2-3-stis-file-structures#id-2.3STISFileStructures-2.3.12.3.1STISFITSImageExtensionFiles">STIS FITS Image Extension Files</a></p>
<p><a id=section5.1></a></p>
<section id="exploring-image-file-structure">
<h3>5.1 Exploring image file structure<a class="headerlink" href="#exploring-image-file-structure" title="Link to this heading">#</a></h3>
<p>The rectified, wavelength and flux calibrated first order spectra or Geometrically corrected imaging data is stored in the fits file with the x2d extension (note that for the CCD the similar extension is sx2). Similar to what we did to the x1d file, we first open the fits file to explore its file structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the x2d file and get its info</span>
<span class="n">x2d_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./data/mastDownload/HST/odj102010/odj102010_x2d.fits&#39;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">x2d_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: data/mastDownload/HST/odj102010/odj102010_x2d.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     277   ()      
  1  SCI           1 ImageHDU       121   (1201, 1201)   float32   
  2  ERR           1 ImageHDU        61   (1201, 1201)   float32   
  3  DQ            1 ImageHDU        44   (1201, 1201)   int16   
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The first, of extension type SCI, stores the science count/flux values.</p></li>
<li><p>The second, of extension type ERR, contains the statistical errors, which are propagated through the calibration process. It is unpopulated in raw data files.</p></li>
<li><p>The third, of extension type DQ, stores the data quality values, which flag suspect pixels in the corresponding SCI data. It is unpopulated in raw data files.</p></li>
</ul>
<p><img alt="ch2_stis_data4.1.jpg" src="../../../_images/ch2_stis_data4.1.jpg" /></p>
<p>Similarly, we can also get the header from this FITS file to see the scientific metadata.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get header of the fits file</span>
<span class="n">x2d_header</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">x2d_file</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x2d_header</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>  <span class="c1"># additional lines are not displayed here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SIMPLE  =                    T / file does conform to FITS standard             
BITPIX  =                   16 / number of bits per data pixel                  
NAXIS   =                    0 / number of data axes                            
EXTEND  =                    T / FITS dataset may contain extensions            
COMMENT   FITS (Flexible Image Transport System) format is defined in &#39;Astronomy
COMMENT   and Astrophysics&#39;, volume 376, page 359; bibcode: 2001A&amp;A...376..359H 
ORIGIN  = &#39;HSTIO/CFITSIO March 2010&#39; / FITS file originator                     
DATE    = &#39;2023-07-28&#39; / date this file was written (yyyy-mm-dd)                
NEXTEND =                    3 / Number of standard extensions                  
FILENAME= &#39;odj102010_x2d.fits&#39; / name of file                                   
FILETYPE= &#39;SCI      &#39;          / type of data found in data file                
                                                                                
TELESCOP= &#39;HST&#39;                / telescope used to acquire data                 
INSTRUME= &#39;STIS  &#39;             / identifier for instrument used to acquire data 
EQUINOX =               2000.0 / equinox of celestial coord. system             
</pre></div>
</div>
</div>
</div>
<p><a id=section5.2></a></p>
</section>
<section id="showing-the-image">
<h3>5.2 Showing the image<a class="headerlink" href="#showing-the-image" title="Link to this heading">#</a></h3>
<p>Now we collect the science image data from the fits file and show the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get data as a numpy array</span>
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">x2d_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu_list</span><span class="p">:</span>
    <span class="n">x2d_data</span> <span class="o">=</span> <span class="n">hdu_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<p>Make a histogram of the magnitude of the image data so that we have a general idea on the distribution. Knowing the distribution is essential for us to normalize the data when showing the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove infinities and NaNs from the data when making the histogram</span>
<span class="n">filtered_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x2d_data</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">row</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_data</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">20.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.5</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Magnitude order of _x2d image data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;_x2d Data Magnitude Order frequencies&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1894/3318306081.py:2: RuntimeWarning: divide by zero encountered in log10
  filtered_data = [v for row in np.log10(x2d_data) for v in row if not (np.isinf(v) or np.isnan(v))]
/tmp/ipykernel_1894/3318306081.py:2: RuntimeWarning: invalid value encountered in log10
  filtered_data = [v for row in np.log10(x2d_data) for v in row if not (np.isinf(v) or np.isnan(v))]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;_x2d Data Magnitude Order frequencies&#39;)
</pre></div>
</div>
<img alt="../../../_images/7448ee86e1e36df111a7130bab97d8baf35eb72d362c70e6fdded701d744c0db.png" src="../../../_images/7448ee86e1e36df111a7130bab97d8baf35eb72d362c70e6fdded701d744c0db.png" />
</div>
</div>
<p>When showing the image, we normalize the color of each pixel to a specific range through vmin and vmax to make the features of image clear. These values typically matches the magnitude of the <code class="docutils literal notranslate"><span class="pre">x2d</span></code> data according to the histogram above, but can be experimented and changed to bring out features at different levels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show the image</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x2d_data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e-13</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7fcf0b5d9d90&gt;
</pre></div>
</div>
<img alt="../../../_images/c20467f5ce9da80f4f4db18f09d3e582890ab1e8864a975de31174f899566434.png" src="../../../_images/c20467f5ce9da80f4f4db18f09d3e582890ab1e8864a975de31174f899566434.png" />
</div>
</div>
<p>For more color map and normalizing options, see: <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html"><code class="docutils literal notranslate"><span class="pre">Choosing</span> <span class="pre">Colormaps</span> <span class="pre">in</span> <span class="pre">Matplotlib</span></code></a>, <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html"><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.imshow</span></code></a>.</p>
<p><a id=section5.3></a></p>
</section>
<section id="removing-serious-data-quality-pixels">
<h3>5.3 Removing serious data quality pixels<a class="headerlink" href="#removing-serious-data-quality-pixels" title="Link to this heading">#</a></h3>
<p>Now we are going to remove the pixels with series data quality flags as described above. The removed pixels will appear grey like the background. The horizontal stripes of removed data are from the bar (top) and repeller wire shadow (middle).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the serious data quality flag</span>
<span class="n">sdqFlags_fuv</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">x2d_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;SDQFLAGS&quot;</span><span class="p">]</span>
<span class="c1"># get data quality flags of each pixels</span>
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">x2d_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu_list</span><span class="p">:</span>
    <span class="n">x2d_dq</span> <span class="o">=</span> <span class="n">hdu_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
    
<span class="c1"># create a mask of bad pixels and set them to nan</span>
<span class="k">def</span> <span class="nf">check_dq</span><span class="p">(</span><span class="n">dq</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">dq</span> <span class="o">&amp;</span> <span class="n">sdqFlags_fuv</span><span class="p">)</span>


<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">check_dq</span><span class="p">)(</span><span class="n">x2d_dq</span><span class="p">)</span>
<span class="n">x2d_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x2d_data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="c1"># plot the image</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x2d_mask</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e-13</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7fcf0b584fd0&gt;
</pre></div>
</div>
<img alt="../../../_images/ed63e042ef60aea99ec5cd428bb3dd515fa75ac1b088e20b7c7a44057ef16ca5.png" src="../../../_images/ed63e042ef60aea99ec5cd428bb3dd515fa75ac1b088e20b7c7a44057ef16ca5.png" />
</div>
</div>
<p><a id=section6></a></p>
</section>
</section>
<section id="working-with-time-tag-data">
<h2>6.Working with Time-Tag data<a class="headerlink" href="#working-with-time-tag-data" title="Link to this heading">#</a></h2>
<p>The MAMA detecters have a unique Time-Tag mode besides ACCUM mode. TIME-TAG mode is used for high-time-resolution spectroscopy and imaging in the UV. In TIME-TAG mode, the position and detection time of every photon is recorded in an event list. The Time-Tag mode operation for the MAMA detectors can be found at: <a class="reference external" href="https://hst-docs.stsci.edu/stisihb/chapter-11-data-taking/11-1-basic-operating-modes#id-11.1BasicOperatingModes-Section11.1.311.1.3MAMATIME-TAGMode">MAMA TIME-TAG Mode</a>.</p>
<p>In TIME-TAG mode, the position and detection time of every photon is recorded in an event list.
First download the _tag data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search target objscy by obs_id</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;odgxt9010&#39;</span><span class="p">)</span>
<span class="c1"># get a list of files assiciated with that target</span>
<span class="n">NUV_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<span class="c1"># Download only the SCIENCE fits files</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">NUV_list</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">datadir</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_jif.fits to data/mastDownload/HST/odgxt9010/odgxt9010_jif.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_jit.fits to data/mastDownload/HST/odgxt9010/odgxt9010_jit.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_jwf.fits to data/mastDownload/HST/odgxt9010/odgxt9010_jwf.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_jwt.fits to data/mastDownload/HST/odgxt9010/odgxt9010_jwt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_spt.fits to data/mastDownload/HST/odgxt9010/odgxt9010_spt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_tag.fits to data/mastDownload/HST/odgxt9010/odgxt9010_tag.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_trl.fits to data/mastDownload/HST/odgxt9010/odgxt9010_trl.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_wav.fits to data/mastDownload/HST/odgxt9010/odgxt9010_wav.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_wsp.fits to data/mastDownload/HST/odgxt9010/odgxt9010_wsp.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_asn.fits to data/mastDownload/HST/odgxt9010/odgxt9010_asn.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_raw.fits to data/mastDownload/HST/odgxt9010/odgxt9010_raw.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_x1d.fits to data/mastDownload/HST/odgxt9010/odgxt9010_x1d.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_x2d.fits to data/mastDownload/HST/odgxt9010/odgxt9010_x2d.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/odgxt9010_flt.fits to data/mastDownload/HST/odgxt9010/odgxt9010_flt.fits ... [Done]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=14</i>
<table id="table140527188966352" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str50</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_jif.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_jit.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_jwf.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_jwt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_spt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_tag.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_trl.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_wav.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_wsp.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_asn.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_raw.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_x1d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_x2d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/odgxt9010/odgxt9010_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p><a id=section6.1></a></p>
<section id="investigating-the-tag-data">
<h3>6.1 Investigating the _tag data<a class="headerlink" href="#investigating-the-tag-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get info about the tag extension fits file</span>
<span class="n">tag</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./data/mastDownload/HST/odgxt9010/odgxt9010_tag.fits&quot;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: data/mastDownload/HST/odgxt9010/odgxt9010_tag.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     218   ()      
  1  EVENTS        1 BinTableHDU    148   4802131R x 4C   [1J, 1I, 1I, 1I]   
  2  GTI           1 BinTableHDU     22   1R x 2C   [1D, 1D]   
</pre></div>
</div>
</div>
</div>
<p>The _tag fits file has two binary table extensions: EVENTS and GTI (Good Time Interval).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get header of the EVENTS extension</span>
<span class="c1"># print only the TIMETAG EVENTS TABLE COLUMNS (line 130-147)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">130</span><span class="p">:</span><span class="mi">147</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SHIFTA2 =             0.000000 / Spectrum shift in AXIS2 calculated from WAVECAL
                                                                                
              / TIMETAG EVENTS TABLE COLUMNS                                    
                                                                                
TTYPE1  = &#39;TIME    &#39;           / event clock time                               
TFORM1  = &#39;1J      &#39;           / data format for TIME: 32-bit integer           
TUNIT1  = &#39;seconds &#39;           / units for TIME: seconds                        
TSCAL1  =             0.000125 / scale factor to convert s/c clock ticks to sec 
TZERO1  =                  0.0 / TIME zero point: starting time of obs.         
TTYPE2  = &#39;AXIS1   &#39;           / Doppler corrected axis 1 detector coordinate   
TFORM2  = &#39;1I      &#39;           / data format for AXIS1: 16-bit integer          
TUNIT2  = &#39;pixels  &#39;           / physical units for AXIS1: pixels               
TTYPE3  = &#39;AXIS2   &#39;           / axis 2 detector coordinate                     
TFORM3  = &#39;1I      &#39;           / data format for AXIS2: 16-bit integer          
TUNIT3  = &#39;pixels  &#39;           / physical units for AXIS2: pixels               
TTYPE4  = &#39;DETAXIS1&#39;           / raw 1 detector coordinate                      
TFORM4  = &#39;1I      &#39;           / data format for DETAXIS1: 16-bit integer       
</pre></div>
</div>
</div>
</div>
<p>Columns in the EVENTS extension:</p>
<ul class="simple">
<li><p>TIME: the time each event was recorded relative to the start time</p></li>
<li><p>AXIS1: pixel coordinate along the spectral axis with the corretion term on Doppler shifts</p></li>
<li><p>AXIS2: pixel coordinate along the spatial axis</p></li>
<li><p>DETAXIS1: pixel coordinate along the spectral axis without the corretion term on Doppler shifts</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get header of the GTI extension</span>
<span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XTENSION= &#39;BINTABLE&#39;           / extension type                                 
BITPIX  =                    8 / bits per data value                            
NAXIS   =                    2 / number of data axes                            
NAXIS1  =                   16 / length of first data axis                      
NAXIS2  =                    1 / length of second data axis                     
PCOUNT  =                    0 / number of group parameters                     
GCOUNT  =                    1 / number of groups                               
TFIELDS =                    2 / number of fields in each table row             
INHERIT =                    T / inherit the primary header                     
EXTNAME = &#39;GTI     &#39;           / extension name                                 
EXTVER  =                    1 / extension version number                       
ROOTNAME= &#39;odgxt9010                         &#39; / rootname of the observation set
EXPNAME = &#39;odgxt9rfq                &#39; / exposure identifier                     
                                                                                
              / TIMETAG GTI TABLE COLUMN DESCRIPTORS                            
                                                                                
TTYPE1  = &#39;START   &#39;           / start of good time interval                    
TFORM1  = &#39;1D      &#39;           / data format for START: REAL*8                  
TUNIT1  = &#39;seconds &#39;           / physical units for START                       
TTYPE2  = &#39;STOP    &#39;           / end of good time interval                      
TFORM2  = &#39;1D      &#39;           / data format for STOP: REAL*8                   
TUNIT2  = &#39;seconds &#39;           / physical units for STOP                        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: UnitsWarning: &#39;seconds&#39; did not parse as fits unit: At col 0, Unit &#39;seconds&#39; not supported by the FITS standard.  If this is meant to be a custom unit, define it with &#39;u.def_unit&#39;. To have it recognized inside a file reader or other code, enable it with &#39;u.add_enabled_units&#39;. For details, see https://docs.astropy.org/en/latest/units/combining_and_defining.html [astropy.units.core]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140527225043728" class="table-striped table-bordered table-condensed">
<thead><tr><th>START</th><th>STOP</th></tr></thead>
<thead><tr><th>seconds</th><th>seconds</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th></tr></thead>
<tr><td>0.022625</td><td>2380.222</td></tr>
</table></div></div></div>
</div>
<p>Columns in the GTI extension:</p>
<ul class="simple">
<li><p>START: start of good time interval</p></li>
<li><p>STOP: end of good time interval</p></li>
</ul>
<p>Now we make a time series plot of the total flux over all wavelengths to see how the flux changes over the time interval:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the events data as a pandas dataframe for easier manipulation</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="c1"># get the good time interval from the GTI extension</span>
<span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="s2">&quot;START&quot;</span><span class="p">],</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[</span><span class="s2">&quot;STOP&quot;</span><span class="p">]</span>
<span class="c1"># group the events by time with bin = 3 seconds</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">stop</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">events</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">],</span> <span class="n">time</span><span class="p">)</span>
<span class="n">total_flux</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s2">&quot;TIME&quot;</span><span class="p">]</span>
<span class="c1"># plot the flux as a function of time</span>
<span class="c1"># notice here that the unit of flux is counts since we are counting the number of events in a time series</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">total_flux</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Total Flux [counts]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: UnitsWarning: &#39;pixels&#39; did not parse as fits unit: At col 0, Unit &#39;pixels&#39; not supported by the FITS standard. Did you mean pixel? If this is meant to be a custom unit, define it with &#39;u.def_unit&#39;. To have it recognized inside a file reader or other code, enable it with &#39;u.add_enabled_units&#39;. For details, see https://docs.astropy.org/en/latest/units/combining_and_defining.html [astropy.units.core]
WARNING: UnitsWarning: &#39;seconds&#39; did not parse as fits unit: At col 0, Unit &#39;seconds&#39; not supported by the FITS standard.  If this is meant to be a custom unit, define it with &#39;u.def_unit&#39;. To have it recognized inside a file reader or other code, enable it with &#39;u.add_enabled_units&#39;. For details, see https://docs.astropy.org/en/latest/units/combining_and_defining.html [astropy.units.core]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Total Flux [counts]&#39;)
</pre></div>
</div>
<img alt="../../../_images/9c71728e4cce25cf5b0dc0dc90ef4ada401c7b205a4b2df1da0879a1993f7cd0.png" src="../../../_images/9c71728e4cce25cf5b0dc0dc90ef4ada401c7b205a4b2df1da0879a1993f7cd0.png" />
</div>
</div>
<p>As the plot shows, though the total flux fluctuates, it is roughly a constant over the good time interval.</p>
<p><a id=section6.2></a></p>
</section>
<section id="converting-time-tag-into-accum-image">
<h3>6.2 Converting Time_Tag into ACCUM image<a class="headerlink" href="#converting-time-tag-into-accum-image" title="Link to this heading">#</a></h3>
<p>Time tag data can be converted into ACCUM image using the inttag method in stistools.
More information: <a class="reference external" href="https://stistools.readthedocs.io/en/latest/inttag.html">inttag</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the output file</span>
<span class="n">accum</span> <span class="o">=</span> <span class="s2">&quot;./data/mastDownload/HST/odgxt9010/odgxt9010_accum.fits&quot;</span>
<span class="c1"># convert Time_Tag into ACCUM</span>
<span class="c1"># the first parameter is the path to the _tag fits file, the second parameter is the output directory</span>
<span class="n">stistools</span><span class="o">.</span><span class="n">inttag</span><span class="o">.</span><span class="n">inttag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">accum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>imset: 1, start: 0.022625, stop: 2380.222, exposure time: 2380.199375
</pre></div>
</div>
</div>
</div>
<p>Then the output file is in the same structure as a STIS image fits file, which we can open and plot in the same way we explored above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">accum</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7fcf05955a50&gt;
</pre></div>
</div>
<img alt="../../../_images/8a61800cd943d2259f0b4ae786269b598a425849de0fcd07f193d7dcb0114f11.png" src="../../../_images/8a61800cd943d2259f0b4ae786269b598a425849de0fcd07f193d7dcb0114f11.png" />
</div>
</div>
<p>inttag can be run to produce multiple output imsets: rcount specifies the number of imsets, imcrements specifies the time interval for each imsets in seconds</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stistools</span><span class="o">.</span><span class="n">inttag</span><span class="o">.</span><span class="n">inttag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">accum</span><span class="p">,</span> <span class="n">rcount</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">accum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>imset: 1, start: 0.022625, stop: 700.022625, exposure time: 700.0
imset: 2, start: 700.022625, stop: 1400.022625, exposure time: 700.0000000000001
imset: 3, start: 1400.022625, stop: 2100.022625, exposure time: 700.0
Filename: ./data/mastDownload/HST/odgxt9010/odgxt9010_accum.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     218   ()      
  1  SCI           1 ImageHDU       139   (1024, 1024)   float64   
  2  ERR           1 ImageHDU       139   (1024, 1024)   float64   
  3  DQ            1 ImageHDU       140   ()      
  4  SCI           2 ImageHDU       139   (1024, 1024)   float64   
  5  ERR           2 ImageHDU       139   (1024, 1024)   float64   
  6  DQ            2 ImageHDU       140   ()      
  7  SCI           3 ImageHDU       139   (1024, 1024)   float64   
  8  ERR           3 ImageHDU       139   (1024, 1024)   float64   
  9  DQ            3 ImageHDU       140   ()      
</pre></div>
</div>
</div>
</div>
<p>Compare the 3 accum images produced by inttag, using the same scale and colormap:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">accum</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;extension </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fde7a49ca30e7c9b34952511e33bbf71389aa7a7a8680fe36cd4d90da929ecbe.png" src="../../../_images/fde7a49ca30e7c9b34952511e33bbf71389aa7a7a8680fe36cd4d90da929ecbe.png" />
</div>
</div>
<p>The output file is a series of extensions with each imset having a SCI, ERR, and DQ extension, as shown above.</p>
<p><a id=section7></a></p>
</section>
</section>
<section id="working-with-stis-echelle-data">
<h2>7.Working with STIS Echelle data<a class="headerlink" href="#working-with-stis-echelle-data" title="Link to this heading">#</a></h2>
<p>The STIS Echelle mode uses diffraction and interference to separate a spectrum into different spectral orders (the keyword in the headers is SPORDER), with each spectral order covering different wavelength range. The echelle were designed to maximize the spectral range covered in a single echellogram. For more information, see <a class="reference external" href="https://hst-docs.stsci.edu/stisihb/chapter-4-spectroscopy/4-3-echelle-spectroscopy-in-the-ultraviolet">Echelle Spectroscopy in the Ultraviolet</a>.</p>
<p>We first download data taken with an echelle:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search target objscy by obs_id</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;OCTX01030&#39;</span><span class="p">)</span>
<span class="c1"># get a list of files assiciated with that target</span>
<span class="n">NUV_list</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<span class="c1"># Download only the SCIENCE fits files</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">NUV_list</span><span class="p">,</span> <span class="n">productType</span><span class="o">=</span><span class="s2">&quot;SCIENCE&quot;</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">datadir</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/octx01030_raw.fits to data/mastDownload/HST/octx01030/octx01030_raw.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/octx01030_x1d.fits to data/mastDownload/HST/octx01030/octx01030_x1d.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/octx01030_flt.fits to data/mastDownload/HST/octx01030/octx01030_flt.fits ... [Done]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=3</i>
<table id="table140527188954576" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str50</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>data/mastDownload/HST/octx01030/octx01030_raw.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/octx01030/octx01030_x1d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>data/mastDownload/HST/octx01030/octx01030_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p><a id=section7.1></a></p>
<section id="showing-echelle-image">
<h3>7.1 Showing Echelle Image<a class="headerlink" href="#showing-echelle-image" title="Link to this heading">#</a></h3>
<p>Open the _flt (Flat-fielded science) image in the same way we open other image files, and show the image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flt_file</span> <span class="o">=</span> <span class="s2">&quot;./data/mastDownload/HST/octx01030/octx01030_flt.fits&quot;</span>
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">flt_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/dad295db4c3e7a70dc33500a798a46e3f083aa08623d5ff87ece3febead7bd19.png" src="../../../_images/dad295db4c3e7a70dc33500a798a46e3f083aa08623d5ff87ece3febead7bd19.png" />
</div>
</div>
<p>As shown in the image above, there are multiple horizontal bands with different spectral orders. Each spectral order also has distinct wavelength range, which we will explore in the next section.</p>
<p><a id=section7.2></a></p>
</section>
<section id="plotting-echelle-spectrum">
<h3>7.2 Plotting Echelle Spectrum<a class="headerlink" href="#plotting-echelle-spectrum" title="Link to this heading">#</a></h3>
<p>We first read in the _x1d data as an astropy table. Notice that when we read in the FUV _x1d data in <a class="reference internal" href="#section2.2"><span class="xref myst">section2.2</span></a>, the table has a single row with SPORDER = 1. But for echelle mode data, the data is separated into multiple rows, with each row having a distinct order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">echelle_file</span> <span class="o">=</span> <span class="s2">&quot;./data/mastDownload/HST/octx01030/octx01030_x1d.fits&quot;</span>
<span class="n">echelle_data</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">echelle_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">echelle_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: UnitsWarning: &#39;Angstroms&#39; did not parse as fits unit: At col 0, Unit &#39;Angstroms&#39; not supported by the FITS standard. Did you mean Angstrom or angstrom? If this is meant to be a custom unit, define it with &#39;u.def_unit&#39;. To have it recognized inside a file reader or other code, enable it with &#39;u.add_enabled_units&#39;. For details, see https://docs.astropy.org/en/latest/units/combining_and_defining.html [astropy.units.core]
WARNING: UnitsWarning: &#39;Counts/s&#39; did not parse as fits unit: At col 0, Unit &#39;Counts&#39; not supported by the FITS standard. Did you mean count? If this is meant to be a custom unit, define it with &#39;u.def_unit&#39;. To have it recognized inside a file reader or other code, enable it with &#39;u.add_enabled_units&#39;. For details, see https://docs.astropy.org/en/latest/units/combining_and_defining.html [astropy.units.core]
WARNING: UnitsWarning: &#39;erg/s/cm**2/Angstrom&#39; contains multiple slashes, which is discouraged by the FITS standard [astropy.units.format.generic]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=24</i>
<table id="table140527227674768" class="table-striped table-bordered table-condensed">
<thead><tr><th>SPORDER</th><th>NELEM</th><th>WAVELENGTH</th><th>GROSS</th><th>BACKGROUND</th><th>NET</th><th>FLUX</th><th>ERROR</th><th>NET_ERROR</th><th>DQ</th><th>A2CENTER</th><th>EXTRSIZE</th><th>MAXSRCH</th><th>BK1SIZE</th><th>BK2SIZE</th><th>BK1OFFST</th><th>BK2OFFST</th><th>EXTRLOCY</th><th>OFFSET</th></tr></thead>
<thead><tr><th></th><th></th><th>Angstroms</th><th>Counts/s</th><th>Counts/s</th><th>Counts/s</th><th>erg / (Angstrom cm2 s)</th><th>erg / (Angstrom cm2 s)</th><th>Counts/s</th><th></th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th><th>pix</th></tr></thead>
<thead><tr><th>int16</th><th>int16</th><th>float64[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>float32[1024]</th><th>int16[1024]</th><th>float32</th><th>float32</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32[1024]</th><th>float32</th></tr></thead>
<tr><td>66</td><td>1024</td><td>3067.682086855123 ..         3119.012536891768</td><td>-0.0002928353 ..       0.4817821</td><td>0.006654883 ..     0.003304005</td><td>-0.006947719 ..       0.4784781</td><td>-2.030472e-14 ..      2.9376e-12</td><td>3.13553e-17 ..    4.646945e-13</td><td>1.072892e-05 ..      0.07568973</td><td>2628 ..        2564</td><td>14.40747</td><td>7</td><td>10</td><td>5</td><td>5</td><td>28.01995</td><td>-28.77343</td><td>19.45284 ..        9.476334</td><td>0.6031901</td></tr>
<tr><td>67</td><td>1024</td><td>3021.857427057288 ..         3072.451049005796</td><td>-0.0002917696 ..       0.8308571</td><td>0.004698814 ..    0.0009105802</td><td>-0.004990583 ..       0.8299465</td><td>-1.021074e-14 ..    3.076689e-12</td><td>2.202596e-17 ..    3.702814e-13</td><td>1.076537e-05 ..      0.09988457</td><td>2628 ..        2580</td><td>71.19333</td><td>7</td><td>10</td><td>5</td><td>5</td><td>27.28738</td><td>-28.01995</td><td>75.95515 ..        66.73722</td><td>0.6031901</td></tr>
<tr><td>68</td><td>1024</td><td>2977.380919809147 ..         3027.257338502545</td><td>-0.008585975 ..       0.4190482</td><td>0.01313506 ..     0.002161205</td><td>-0.02172103 ..        0.416887</td><td>-3.754732e-14 ..    1.087724e-12</td><td>1.012584e-16 ..    1.857633e-13</td><td>5.857771e-05 ..      0.07119664</td><td>2580 ..        2564</td><td>126.3683</td><td>7</td><td>10</td><td>5</td><td>5</td><td>26.57536</td><td>-27.28738</td><td>131.2862 ..        122.4106</td><td>0.6031901</td></tr>
<tr><td>69</td><td>1024</td><td>2934.193937243135 ..         2983.372006818285</td><td>-0.0003262974 ..       0.9740262</td><td>0.01347407 ..     0.002397954</td><td>-0.01380036 ..       0.9716282</td><td>-2.190875e-14 ..    2.144429e-12</td><td>1.805634e-17 ..    2.292797e-13</td><td>1.137373e-05 ..       0.1038853</td><td>2564 ..        2564</td><td>179.9044</td><td>7</td><td>10</td><td>5</td><td>5</td><td>25.88353</td><td>-26.57536</td><td>184.4561 ..        176.3899</td><td>0.5168006</td></tr>
<tr><td>70</td><td>1024</td><td>2892.241202288543 ..         2940.739046013224</td><td>-0.0003810195 ..        1.413689</td><td>0.01000194 ..     0.003849149</td><td>-0.01038296 ..         1.40984</td><td>-1.478441e-14 ..    3.037708e-12</td><td>1.750356e-17 ..    2.665483e-13</td><td>1.229259e-05 ..       0.1237086</td><td>2564 ..        2564</td><td>232.084</td><td>7</td><td>10</td><td>5</td><td>5</td><td>25.21152</td><td>-25.88353</td><td>236.3518 ..        228.9839</td><td>0.5693149</td></tr>
<tr><td>71</td><td>1024</td><td>2851.470552660116 ..         2899.305600220004</td><td>-0.0002589348 ..        1.353963</td><td>0.002504814 ..     0.005018473</td><td>-0.002763749 ..        1.348944</td><td>-3.966172e-15 ..    2.761381e-12</td><td>1.45592e-17 ..    2.479407e-13</td><td>1.014529e-05 ..       0.1211199</td><td>2564 ..        2564</td><td>282.7352</td><td>7</td><td>10</td><td>5</td><td>5</td><td>24.55895</td><td>-25.21152</td><td>286.8198 ..        280.1042</td><td>0.5335948</td></tr>
<tr><td>72</td><td>1024</td><td>2811.832724517215 ..         2859.021746954763</td><td>-0.0002629836 ..       0.3712038</td><td>0.005110647 ..     0.001835793</td><td>-0.00537363 ..        0.369368</td><td>-7.334717e-15 ..    7.610627e-13</td><td>1.40482e-17 ..    1.381501e-13</td><td>1.029212e-05 ..      0.06704865</td><td>2564 ..        2564</td><td>332.0811</td><td>7</td><td>10</td><td>5</td><td>5</td><td>23.92547</td><td>-24.55895</td><td>335.8839 ..        329.9276</td><td>0.5793937</td></tr>
<tr><td>73</td><td>1024</td><td>2773.281153907109 ..         2819.840296387559</td><td>-0.007595196 ..       0.7308141</td><td>0.005754123 ..     0.002980053</td><td>-0.01334932 ..        0.727834</td><td>-1.893139e-14 ..    1.559154e-12</td><td>7.808778e-17 ..    1.939492e-13</td><td>5.506296e-05 ..      0.09053811</td><td>2580 ..        2564</td><td>380.1232</td><td>7</td><td>10</td><td>5</td><td>5</td><td>23.31071</td><td>-23.92547</td><td>383.655 ..        378.4149</td><td>0.6563193</td></tr>
<tr><td>74</td><td>1024</td><td>2735.771794309852 ..         2781.716606874576</td><td>-0.0002480344 ..       0.3054057</td><td>0.003892346 ..     0.001905411</td><td>-0.00414038 ..       0.3035003</td><td>-6.107451e-15 ..    6.842402e-13</td><td>1.461313e-17 ..    1.387065e-13</td><td>9.906572e-06 ..      0.06152438</td><td>2564 ..        2564</td><td>426.7452</td><td>7</td><td>10</td><td>5</td><td>5</td><td>22.7143</td><td>-23.31071</td><td>430.1284 ..        425.6361</td><td>0.5977612</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>80</td><td>1024</td><td>2530.413003679701 ..         2572.968492248937</td><td>-0.0003557455 ..       0.2057582</td><td>0.0008996339 ..    0.0008307099</td><td>-0.001255379 ..       0.2049275</td><td>-2.266979e-15 ..    6.605272e-13</td><td>2.129495e-17 ..    1.840417e-13</td><td>1.179246e-05 ..      0.05709862</td><td>2564 ..        2580</td><td>682.4249</td><td>7</td><td>10</td><td>5</td><td>5</td><td>19.50066</td><td>-19.99467</td><td>684.3518 ..        683.5427</td><td>0.574106</td></tr>
<tr><td>81</td><td>1024</td><td>2499.145134209817 ..         2541.180702698945</td><td>-0.0003548819 ..       0.1215624</td><td>0.001022874 ..    0.0004910007</td><td>-0.001377756 ..       0.1210714</td><td>-2.67421e-15 ..    4.349387e-13</td><td>2.296038e-17 ..    1.542925e-13</td><td>1.182921e-05 ..      0.04294955</td><td>2564 ..        2564</td><td>721.4458</td><td>7</td><td>10</td><td>5</td><td>5</td><td>19.02243</td><td>-19.50066</td><td>723.0336 ..        722.7673</td><td>0.6433231</td></tr>
<tr><td>82</td><td>1024</td><td>2468.640092359287 ..         2510.167438601849</td><td>-0.0003482449 ..    -0.003966084</td><td>0.0008586684 ..     0.000385318</td><td>-0.001206913 ..    -0.004351402</td><td>-2.455758e-15 ..   -1.745655e-14</td><td>2.389558e-17 ..    9.369933e-14</td><td>1.174379e-05 ..      0.02335647</td><td>2564 ..        2564</td><td>759.4905</td><td>7</td><td>10</td><td>5</td><td>5</td><td>18.55963</td><td>-19.02243</td><td>760.7408 ..        761.0947</td><td>0.6800641</td></tr>
<tr><td>83</td><td>1024</td><td>2438.870300747431 ..         2479.900734272652</td><td>-0.0003480999 ..      0.01043349</td><td>0.0008362265 ..    0.0003163153</td><td>-0.001184326 ..      0.01011717</td><td>-2.494167e-15 ..    4.517789e-14</td><td>2.477215e-17 ..    1.178575e-13</td><td>1.176277e-05 ..      0.02639309</td><td>2564 ..        2564</td><td>796.5957</td><td>7</td><td>10</td><td>5</td><td>5</td><td>18.11187</td><td>-18.55963</td><td>797.6779 ..        798.4939</td><td>0.6858787</td></tr>
<tr><td>84</td><td>1024</td><td>2409.809495426899 ..          2450.35395445196</td><td>-0.009019177 ..     -0.02464523</td><td>0.0007386059 ..    0.0002919547</td><td>-0.009757783 ..     -0.02493719</td><td>-2.180459e-14 ..   -1.227559e-13</td><td>1.338733e-16 ..    8.824105e-14</td><td>5.990969e-05 ..      0.01792569</td><td>2580 ..        2564</td><td>832.8112</td><td>7</td><td>10</td><td>5</td><td>5</td><td>17.6788</td><td>-18.11187</td><td>833.6877 ..        835.0537</td><td>0.6772088</td></tr>
<tr><td>85</td><td>1024</td><td>2381.432648611571 ..         2421.501716113727</td><td>-0.0003795348 ..      0.01215911</td><td>0.0006555628 ..    0.0002394877</td><td>-0.001035098 ..      0.01191962</td><td>-2.473746e-15 ..     6.20382e-14</td><td>2.926687e-17 ..    1.381439e-13</td><td>1.224623e-05 ..      0.02654208</td><td>2564 ..        2564</td><td>868.1068</td><td>7</td><td>10</td><td>5</td><td>5</td><td>17.26004</td><td>-17.6788</td><td>868.6304 ..        870.5798</td><td>0.5922172</td></tr>
<tr><td>86</td><td>1024</td><td>2353.715896795153 ..         2393.319815723954</td><td>-0.001006938 ..    0.0003168302</td><td>0.0005367392 ..    0.0001913979</td><td>-0.001543677 ..    0.0001254323</td><td>-3.907116e-15 ..    7.426204e-16</td><td>5.0486e-17 ..    1.442338e-13</td><td>1.99467e-05 ..      0.02436181</td><td>2564 ..        2564</td><td>902.6919</td><td>7</td><td>10</td><td>5</td><td>5</td><td>16.85524</td><td>-17.26004</td><td>903.1175 ..        905.5428</td><td>0.610154</td></tr>
<tr><td>87</td><td>1024</td><td>2326.636473828409 ..         2365.785161512079</td><td>-0.0004271266 ..     -0.03641235</td><td>0.0004190952 ..    0.0001836866</td><td>-0.0008462218 ..     -0.03659604</td><td>-2.284579e-15 ..   -2.450691e-13</td><td>3.48386e-17 ..    9.885516e-14</td><td>1.290443e-05 ..      0.01476199</td><td>2628 ..        2564</td><td>936.4824</td><td>7</td><td>10</td><td>5</td><td>5</td><td>16.46401</td><td>-16.85524</td><td>936.36 ..        939.4832</td><td>0.6185553</td></tr>
<tr><td>88</td><td>1024</td><td>2300.172648559522 ..         2338.875710356606</td><td>-0.0003803358 ..     -0.02699966</td><td>0.000322222 ..    0.0001343358</td><td>-0.0007025579 ..       -0.027134</td><td>-2.107181e-15 ..   -1.893928e-13</td><td>3.685634e-17 ..    1.203252e-13</td><td>1.228832e-05 ..      0.01723879</td><td>2628 ..        2564</td><td>969.464</td><td>7</td><td>10</td><td>5</td><td>5</td><td>16.08601</td><td>-16.46401</td><td>969.1404 ..        972.7743</td><td>0.5765868</td></tr>
<tr><td>89</td><td>1024</td><td>2274.303666679877 ..         2312.570408922325</td><td>-0.0004408245 ..     -0.03575523</td><td>7.672486e-05 ..    9.676442e-05</td><td>-0.0005175493 ..       -0.035852</td><td>-1.849008e-15 ..   -2.878802e-13</td><td>4.733922e-17 ..    1.175477e-13</td><td>1.325056e-05 ..      0.01463914</td><td>2628 ..        2564</td><td>1001.779</td><td>7</td><td>10</td><td>5</td><td>5</td><td>15.72085</td><td>-16.08601</td><td>1001.03 ..        1005.438</td><td>0.6015919</td></tr>
</table></div></div></div>
</div>
<p>Now we can plot the spectrum of all spectral orders in one plot, with each spectral order having a distinct color:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the spectrum; the color of each SPORDER is specified through a matplotlib built-in colormap</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">echelle_data</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">echelle_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;WAVELENGTH&#39;</span><span class="p">],</span> <span class="n">echelle_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;FLUX&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;prism&#39;</span><span class="p">)(</span><span class="n">i</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">echelle_data</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="n">echelle_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;SPORDER&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength [&#39;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">197</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Flux [ergs/s/cm$^2$/&quot;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">197</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;STIS Echelle Mode Spectrum&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1894/1991047114.py:5: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed two minor releases later. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap(obj)`` instead.
  plt.plot(echelle_data[i][&#39;WAVELENGTH&#39;], echelle_data[i][&#39;FLUX&#39;], color=cm.get_cmap(&#39;prism&#39;)(i/len(echelle_data)), label=echelle_data[i][&#39;SPORDER&#39;], alpha=0.7)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;STIS Echelle Mode Spectrum&#39;)
</pre></div>
</div>
<img alt="../../../_images/bb4bd5840f36ae5fa3bb120f95a5a27556b8024f19a0281e0ab11e2cbfe27935.png" src="../../../_images/bb4bd5840f36ae5fa3bb120f95a5a27556b8024f19a0281e0ab11e2cbfe27935.png" />
</div>
</div>
<p>As the spectrum illustrates, each spectral order covers a specific wavelength range. Notice that some of the wavelength ranges overlap.</p>
</section>
</section>
<hr class="docutils" />
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Link to this heading">#</a></h2>
<p><strong>Author:</strong> <a class="reference internal" href="#kding&#64;stsci.edu"><span class="xref myst">Keyi Ding</span></a></p>
<p><strong>Updated On:</strong> 2023-01-05</p>
<blockquote>
<div><p><em>This tutorial was generated to be in compliance with the <a class="reference external" href="https://github.com/spacetelescope/style-guides">STScI style guides</a> and would like to cite the <a class="reference external" href="https://github.com/spacetelescope/style-guides/blob/master/templates/example_notebook.ipynb">Jupyter guide</a> in particular.</em></p>
</div></blockquote>
</section>
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Link to this heading">#</a></h2>
<p>If you use <code class="docutils literal notranslate"><span class="pre">astropy</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">astroquery</span></code>, or <code class="docutils literal notranslate"><span class="pre">numpy</span></code> for published research, please cite the
authors. Follow these links for more information about citations:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.scipy.org/citing.html">Citing <code class="docutils literal notranslate"><span class="pre">astropy</span></code>/<code class="docutils literal notranslate"><span class="pre">numpy</span></code>/<code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></p></li>
<li><p><a class="reference external" href="https://astroquery.readthedocs.io/en/latest/">Citing <code class="docutils literal notranslate"><span class="pre">astroquery</span></code></a></p></li>
</ul>
<hr class="docutils" />
<p><a class="reference internal" href="#top"><span class="xref myst">Top of Page</span></a>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/STIS/view_data"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../target_acquisition/target_acquisition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Evaluating STIS Target Acquisitions <a class="tocSkip"></p>
      </div>
    </a>
    <a class="right-next"
       href="../extraction/1D_Extraction.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">1D Spectra Extraction <a class="tocSkip"></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">0. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-necessary-packages">0.1 Import necessary packages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-stis-data-from-mast-using-astroquery">1. Downloading STIS data from MAST using <code class="docutils literal notranslate"><span class="pre">astroquery</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-in-the-data">2. Reading in the data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#investigating-the-data-basics">2.1 Investigating the data - Basics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-table-data">2.2 Reading table data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-spectrum">3. Plotting the spectrum</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-simple-plot-of-the-spectrum">3.1 Making a simple plot of the spectrum</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-data-quality-flags">4.Working with data quality flags</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality-frequencies-histogram">4.1 Data quality frequencies histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-serious-data-quality-flags">4.2 Removing “Serious Data Quality Flags”</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-stis-image">5. Visualizing STIS Image</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-image-file-structure">5.1 Exploring image file structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#showing-the-image">5.2 Showing the image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-serious-data-quality-pixels">5.3 Removing serious data quality pixels</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-time-tag-data">6.Working with Time-Tag data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#investigating-the-tag-data">6.1 Investigating the _tag data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-time-tag-into-accum-image">6.2 Converting Time_Tag into ACCUM image</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-stis-echelle-data">7.Working with STIS Echelle data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#showing-echelle-image">7.1 Showing Echelle Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-echelle-spectrum">7.2 Plotting Echelle Spectrum</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>