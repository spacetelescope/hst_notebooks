

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Processing WFC3/UVIS Data with calwf3 Using the v1.0 CTE-Correction &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Masking Persistence in WFC3/IR Images" href="../persistence/wfc3_ir_persistence.html" />
    <link rel="prev" title="Exception Report Checklist - WFC3" href="../exception_report/wfc3_exception_report.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="HST Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="HST Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI HST Notebook Repository HQ
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ACS/README.html">ACS Notebooks</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_cte_forward_model/acs_cte_forward_model_example.html">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_pixel_area_maps/acs_pixel_area_maps.html">Obtaining Pixel Area Maps for ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_focus_diverse_epsfs/acs_focus_diverse_epsfs.html">Focus Diverse ePSFs for ACS/WFC</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/ExceptionReport/ExceptionReport.html">What to do when you get an Exception Report for COS</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/README.html">DrizzlePac Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Improving Astrometry Using Alternate WCS Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_to_catalogs/align_to_catalogs.html">Aligning HST images to an Absolute Reference Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/use_ds9_regions_in_tweakreg/use_ds9_regions_in_tweakreg.html">TWEAKREG Tips - Using DS9 Regions for Source Inclusion/Exclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/optimize_image_sampling/optimize_image_sampling.html">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_mosaics/align_mosaics.html">Aligning HST Mosaics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/sky_matching/sky_matching.html">Sky Matching for HST Mosaics <a id="top"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HASP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../HASP/Setup/Setup.html">Installing the Hubble Advanced Spectral Products Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HASP/CoaddTutorial/CoaddTutorial.html">Inputting User Data using the Hubble Advanced Spectral Products Script</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../HASP/FluxScaleTutorial/FluxScaleTutorial.html">Scaling Flux while using the Hubble Advanced Spectral Products Script</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../HASP/DataDiagnostic/DataDiagnostics.html">HASP Data Diagnostic Notebook</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../HASP/WavelengthAdjustment/WavelengthAdjustment.html">Wavelength Adjustments for Running the Hubble Advanced Spectral Products (HASP) Script</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../STIS/README.html">STIS-Notebooks</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../STIS/cross-correlation/cross-correlation.html">Correcting for Missing Wavecals with Cross-Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/custom_ccd_darks/custom_ccd_darks.html">Custom CCD Darks <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/drizpac_notebook/STIS_DrizzlePac_Tutorial.html">STIS DrizzlePac Tutorial <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.html">STIS Coronagraphy Visualization Tool (v2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/calstis/calstis_2d_ccd.html">Calstis 2-D CCD Data Reduction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/target_acquisition/target_acquisition.html">Evaluating STIS Target Acquisitions <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/view_data/view_data.html">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/low_count_uncertainties/Low_Count_Uncertainties.html">Low Count Uncertainties in STIS <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/contrast_sensitivity/STIS_Coronagraphic_Observation_Feasibility.html">STIS Coronagraphic Observation Feasibility</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">WFC3</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">WFC3 Notebooks</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../general_tools.html">General Tools</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../image_displayer_analyzer/wfc3_image_displayer_analyzer.html">WFC3 Image Displayer &amp; Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exception_report/wfc3_exception_report.html">Exception Report Checklist - WFC3</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Processing WFC3/UVIS Data with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Using the v1.0 CTE-Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../persistence/wfc3_ir_persistence.html">Masking Persistence in WFC3/IR Images</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ir_tvb.html">WFC3/IR Time Variable Background (TVB)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ir_ima_visualization/IR_IMA_Visualization_with_an_Example_of_Time_Variable_Background.html">WFC3/IR IMA Visualization Tools with An Example of Time Variable Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../calwf3_recalibration/calwf3_recal_tvb.html">Manual Recalibration with calwf3: Turning off the IR Linear Ramp Fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tvb_flattenramp/TVB_flattenramp_notebook.html">Correcting for Helium Line Emission Background in IR Exposures using the “Flatten-Ramp” Technique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ir_scattered_light_calwf3_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_Using_calwf3_to_Mask_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Using <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> to Mask Bad Reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ir_scattered_light_manual_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_by_Manually_Subtracting_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Manually Subtracting Bad Reads</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../photometry.html">Photometry</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../filter_transformations/filter_transformations.html">WFC3/UVIS Filter Transformations with stsynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../flux_conversion_tool/flux_conversion_tool.html">Flux Unit Conversions with synphot and stsynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../photometry_examples/phot_examples.html">Synthetic Photometry Examples for WFC3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../uvis_time_dependent_photometry/uvis_timedep_phot.html">WFC3/UVIS Time-dependent Photometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zeropoints/zeropoints.html">Calculating WFC3 Zeropoints with STSynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../uvis_pam_corrections/WFC3_UVIS_Pixel_Area_Map_Corrections_for_Subarrays.html">WFC3/UVIS Pixel Area Map Corrections for Subarrays</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../point_spread_function.html">Point Spread Function (PSF)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../point_spread_function/hst_point_spread_function.html">HST WFC3 Point Spread Function Modeling   </a></li>
<li class="toctree-l2"><a class="reference internal" href="../mast_api_psf/download_psf_cutouts.html">Downloading WFC3 and WFPC2 PSF Cutouts from MAST</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Processing WFC3/UVIS Data with calwf3 Using the v1.0 CTE-Correction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">1. Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-archived-drkcfiles-txt-is-in-cwd">2. Verify <code class="docutils literal notranslate"><span class="pre">archived_drkcfiles.txt</span></code> is in CWD</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-that-calwf3-version-is-v3-5-2">3. Check that <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Version is <code class="docutils literal notranslate"><span class="pre">v3.5.2</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#query-mast-and-download-a-wfc3-raw-fits-image">4. Query MAST and Download a WFC3 <code class="docutils literal notranslate"><span class="pre">raw.fits</span></code> Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-crds-environment-variable-and-download-reference-files">5. Set CRDS Environment Variable and Download Reference Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-crds-bestrefs">5.1 Run <code class="docutils literal notranslate"><span class="pre">crds</span> <span class="pre">bestrefs</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-image-header">5.2 Inspect Image Header</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-correct-v1-0-drkcfile">6. Find the Correct v1.0 <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-correct-drkcfile-from-crds">6.1 Download the Correct <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> from CRDS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modify-the-image-header-keyword-drkcfile">6.2 Modify the Image Header Keyword, <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-v1-0-pctetab">7. Download the v1.0 <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modify-the-image-header-keyword-pctetab">7.1 Modify the Image Header Keyword, <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#re-inspect-image-header">8. Re-Inspect Image Header</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-calwf3">9. Run <code class="docutils literal notranslate"><span class="pre">calwf3</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-flc-image-header">10. Inspect FLC Image Header</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#investigate-v1-0-and-v2-0-differences">11. Investigate v1.0 and v2.0 Differences</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-v2-0-flc-file">11.1 Download the v2.0 FLC File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-files">11.2 Open Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-50x50-pixel-background-subsection">11.3 Display 50x50 Pixel Background Subsection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-distribution-of-background-subsections">11.3.1 Pixel Distribution of Background Subsections</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-image-subsection">11.4 Display Image Subsection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aperture-photometry">11.5 Aperture Photometry</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">12. Conclusions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#congratulations-you-have-completed-the-notebook">Congratulations, you have completed the notebook!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a id="top"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="processing-wfc3-uvis-data-with-calwf3-using-the-v1-0-cte-correction">
<h1>Processing WFC3/UVIS Data with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Using the v1.0 CTE-Correction<a class="headerlink" href="#processing-wfc3-uvis-data-with-calwf3-using-the-v1-0-cte-correction" title="Permalink to this heading">#</a></h1>
<hr class="docutils" />
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<p>This notebook explains how to calibrate <code class="docutils literal notranslate"><span class="pre">raw</span></code> WFC3/UVIS data with the v1.0 pixel-based CTE correction within <code class="docutils literal notranslate"><span class="pre">calwf3</span></code>.
<br></p>
<p>By the end of this tutorial, you will:</p>
<ul class="simple">
<li><p>Download a raw WFC3 image from MAST.</p></li>
<li><p>Find the necessary reference files needed for calibration.</p></li>
<li><p>Edit header keywords.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> <code class="docutils literal notranslate"><span class="pre">v3.5.2</span></code> to calibrate the raw image with the v1.0 pixel based CTE-correction.</p></li>
<li><p>Compare v1.0 and v2.0 products.</p></li>
</ul>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<p><span class="xref myst">Introduction</span><br></p>
<p><span class="xref myst">1. Imports</span> <br>
<span class="xref myst">2. Verify <code class="docutils literal notranslate"><span class="pre">archived_drkcfiles.txt</span></code> is in CWD</span> <br>
<span class="xref myst">3. Check that <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Version is <code class="docutils literal notranslate"><span class="pre">v3.5.2</span></code></span> <br>
<span class="xref myst">4. Query MAST and Download a WFC3 <code class="docutils literal notranslate"><span class="pre">raw.fits</span></code> Image</span> <br>
<span class="xref myst">5. Set CRDS Environment Variable and Download Reference Files</span> <br>
      <span class="xref myst">5.1 Run <code class="docutils literal notranslate"><span class="pre">crds</span> <span class="pre">bestrefs</span></code></span> <br>
      <span class="xref myst">5.2 Inspect Image Header</span> <br>
<span class="xref myst">6. Find the Correct v1.0 DRKCFILE</span> <br>
      <span class="xref myst">6.1 Download the Correct DRKCFILE from CRDS</span> <br>
      <span class="xref myst">6.2 Modify the Image Header Keyword, <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code></span> <br>
<span class="xref myst">7. Download the v1.0 PCTETAB</span> <br>
      <span class="xref myst">7.1 Modify the Image Header Keyword <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code></span> <br>
<span class="xref myst">8. Re-Inspect Image Header</span> <br>
<span class="xref myst">9. Run <code class="docutils literal notranslate"><span class="pre">calwf3</span></code></span> <br>
<span class="xref myst">10. Inspect <code class="docutils literal notranslate"><span class="pre">FLC</span></code> Image Header</span> <br>
<span class="xref myst">11. Investigate v1.0 and v2.0 Differences</span> <br>
      <span class="xref myst">11.1 Download the v2.0 FLC File</span><br>
      <span class="xref myst">11.2 Open Files</span> <br>
      <span class="xref myst">11.3 Display 50x50 Pixel Background Subsection</span> <br>
            <span class="xref myst">11.3.1 Pixel Distribution of Background Subsections</span> <br>
      <span class="xref myst">11.4 Display Image Subsection</span> <br>
      <span class="xref myst">11.5 Aperture Photometry</span> <br>
<span class="xref myst">12. Conclusions</span> <br></p>
<p><span class="xref myst">Additional Resources</span> <br>
<span class="xref myst">About the Notebook</span> <br>
<span class="xref myst">Citations</span></p>
<p><a id="intro"></a></p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The v1.0 pixel-based Charge Transfer Efficiency (CTE) correction was first implemented into <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> <code class="docutils literal notranslate"><span class="pre">v3.3</span></code> in 2016 <br> (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2016wfc..rept....1R/abstract">Ryan et al. 2016</a>, <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2010PASP..122.1035A/abstract">Anderson &amp; Bedin 2010</a>, <a class="reference external" href="https://github.com/spacetelescope/hstcal/releases/tag/1.0.0">HSTCAL release notes</a>). This also marked the first time users could directly <br> download CTE-corrected <code class="docutils literal notranslate"><span class="pre">flc</span> <span class="pre">&amp;</span> <span class="pre">drc</span></code> files from <a class="reference external" href="https://mast.stsci.edu/search/hst/ui/#/">MAST</a>.  While the v1.0 correction was sufficient  for many years, the <br> degradation of CTE over time reduced the efficacy of the model in treating low-level pixels. The v1.0 correction adversely <br> impacts (overcorrects) both the image background and faint sources. In April 2021 the v2.0 pixel-based CTE correction <br> was implemented in <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> <code class="docutils literal notranslate"><span class="pre">v3.6.0</span></code> (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2021wfc..rept....9A/abstract">Anderson et al. 2021</a>, <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2021wfc..rept....6K/abstract">Kuhn &amp; Anderson 2021</a>,  <a class="reference external" href="https://github.com/spacetelescope/hstcal/releases/tag/2.7.0">HSTCAL release notes</a>). Since <br> MAST uses the latest release of <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> for calibration, any WFC3/UVIS CTE corrected data retrieved from MAST, <br> regardless of observation date, will be calibrated with the v2.0 pixel-based CTE correction. Although v1.0 pixel-based <br> CTE-corrected <code class="docutils literal notranslate"><span class="pre">flc</span> <span class="pre">&amp;</span> <span class="pre">drc</span></code> files are no longer accessable through MAST, this notebook steps through the procedure <br> required to calibrate WFC3/UVIS images using the v1.0 CTE correction. <br></p>
<p>One of the limiting factors of using the v1.0 CTE correction are the CTE corrected dark current reference files (<code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code>). <br> These dark reference files are delivered to MAST by the WFC3 team and use the same pixel-based CTE correction within <br> <code class="docutils literal notranslate"><span class="pre">calwf3</span></code>. Now that we have switched to the v2.0 CTE correction there is a cut off for dark current reference files that use <br> the v1.0 correction. Observations taken after February 2021 will not have CTE corrected dark files using the v1.0 algorithm, <br> which means <strong>applying the v1.0 CTE correction works best for observations taken between May 2009 - February 2021.</strong> <br> If the observation being calibrated was taken after February 2021 there are two options: <strong>1)</strong> use the last v1.0 CTE corrected <br> dark reference file from February 2021 or <strong>2)</strong> use the v2.0 CTE corrected dark with the most appropriate <code class="docutils literal notranslate"><span class="pre">USEAFTER</span></code> for the <br> science exposure’s observation date.</p>
<p><a id="imports"></a></p>
</section>
<section id="imports">
<h2>1. Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="alert alert-block alert-warning" style="color:black" > <b> This notebook assumes you have created and activated a virtual environment using the requirements file in this notebook's repository. Please make sure you have read the README file before continuing.</b> <br> </div>
<p>We import: <br></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Package Name</p></th>
<th class="head text-left"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">glob</span></code></p></td>
<td class="text-left"><p>creating list of files</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">os</span></code></p></td>
<td class="text-left"><p>directory maintenance and setting environment variables</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></p></td>
<td class="text-left"><p>opening and modifying fits files</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">astroquery.mast.Observations</span></code></p></td>
<td class="text-left"><p>downloading data from MAST</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">astropy.table.Table</span></code></p></td>
<td class="text-left"><p>creating and manipulating data tables</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">astropy.visualization.ZScaleInterval</span></code></p></td>
<td class="text-left"><p>finding z-scale limits when displaying images</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code></p></td>
<td class="text-left"><p>plotting and displaying images</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></td>
<td class="text-left"><p>finding indices and concatenating arrays</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">photutils.aperture.aperture_photometry</span></code></p></td>
<td class="text-left"><p>performing aperture photometry</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">photutils.aperture.CircularAperture</span></code></p></td>
<td class="text-left"><p>creating circular apertures</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">photutils.aperture.CircularAnnulus</span></code></p></td>
<td class="text-left"><p>creating circular annuli</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">wfc3tools.calwf3</span></code></p></td>
<td class="text-left"><p>verifying the version and running pipeline</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">background_median.aperture_stats_tbl</span></code></p></td>
<td class="text-left"><p>measuring background values within annuli</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZScaleInterval</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">photutils.aperture</span><span class="w"> </span><span class="kn">import</span> <span class="n">aperture_photometry</span><span class="p">,</span> <span class="n">CircularAperture</span><span class="p">,</span> <span class="n">CircularAnnulus</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">wfc3tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">calwf3</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">example.background_median</span><span class="w"> </span><span class="kn">import</span> <span class="n">aperture_stats_tbl</span>
</pre></div>
</div>
</div>
</div>
<p><a id="txtfile"></a></p>
</section>
<section id="verify-archived-drkcfiles-txt-is-in-cwd">
<h2>2. Verify <code class="docutils literal notranslate"><span class="pre">archived_drkcfiles.txt</span></code> is in CWD<a class="headerlink" href="#verify-archived-drkcfiles-txt-is-in-cwd" title="Permalink to this heading">#</a></h2>
<p>When you cloned/downloaded this notebook from <a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/">hst_notebooks</a>, a .txt file should have been included. The file name is <br> <code class="docutils literal notranslate"><span class="pre">archived_drkcfiles.txt</span></code> and it is used later on in the notebook. This .txt file includes the file name, delivery date, activation <br> date, and USEAFTER date for every v1.0 CTE corrected dark reference file between May 2009 - February 2021. Below, we will use <br> this file in conjunction with the observation date of the file(s) being calibrated to pick out the most appropriate v1.0 CTE corrected <br> dark reference file(s).<br></p>
<p>Please make sure the <code class="docutils literal notranslate"><span class="pre">archived_drkcfiles.txt</span></code> file is in the current working directory before continuing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list cwd to verify txt file is there</span>
<span class="o">!</span>ls<span class="w"> </span>-l<span class="w"> </span>archived_drkcfiles.txt
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-rw-r--r-- 1 runner docker 350644 Mar 13 14:46 archived_drkcfiles.txt
</pre></div>
</div>
</div>
</div>
<p><a id="checkcalver"></a></p>
</section>
<section id="check-that-calwf3-version-is-v3-5-2">
<h2>3. Check that <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Version is <code class="docutils literal notranslate"><span class="pre">v3.5.2</span></code><a class="headerlink" href="#check-that-calwf3-version-is-v3-5-2" title="Permalink to this heading">#</a></h2>
<p>In April 2021, a new <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> version was released that contains the v2.0 CTE-correction.
If you would like to use the v1.0 correction, your <br> current environment must be using <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> versions equal to or between <code class="docutils literal notranslate"><span class="pre">3.3</span></code> - <code class="docutils literal notranslate"><span class="pre">3.5.2</span></code>. However, in order to get the best v1.0 calibrated <br>images we must use <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> <code class="docutils literal notranslate"><span class="pre">v3.5.2</span></code>. This version of <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> includes the recent (<a class="reference external" href="https://github.com/spacetelescope/hstcal/releases/tag/2.5.0">~Jan 2021</a>) update that added MJD as a parameterized <br> variable for the <code class="docutils literal notranslate"><span class="pre">PHOTMODE</span></code> keyword, which enables a time-dependent photometric correction and zeropoint.  If your version is <code class="docutils literal notranslate"><span class="pre">3.6.0</span></code> or higher, <br> you must downgrade the <a class="reference external" href="https://github.com/spacetelescope/hstcal"><code class="docutils literal notranslate"><span class="pre">hstcal</span></code> package</a>. The safer option, however, is to create a new environment using the requirements file provided in <br> the <a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/tree/main/notebooks/WFC3/calwf3_v1.0_cte">notebook’s repository</a>: <br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">conda</span> <span class="pre">config</span> <span class="pre">--add</span> <span class="pre">channels</span> <span class="pre">http://ssb.stsci.edu/astroconda</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">conda</span> <span class="pre">create</span> <span class="pre">-n</span> <span class="pre">v1_PCTE</span> <span class="pre">hstcal==2.5.0</span> <span class="pre">python=3.11</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">conda</span> <span class="pre">activate</span> <span class="pre">v1_PCTE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">hstcal</span></code> <code class="docutils literal notranslate"><span class="pre">v2.5.0</span></code> provides version <code class="docutils literal notranslate"><span class="pre">3.5.2</span></code> of <code class="docutils literal notranslate"><span class="pre">calwf3</span></code>, which is the last version that offers the v1.0 pixel-based CTE correction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print calwf3 version to make sure its equal to or between 3.3 and 3.5.2 </span>
<span class="o">!</span>calwf3.e<span class="w"> </span>--version
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.7.2
</pre></div>
</div>
</div>
</div>
<p><a id="download"></a></p>
</section>
<section id="query-mast-and-download-a-wfc3-raw-fits-image">
<h2>4. Query MAST and Download a WFC3 <code class="docutils literal notranslate"><span class="pre">raw.fits</span></code> Image<a class="headerlink" href="#query-mast-and-download-a-wfc3-raw-fits-image" title="Permalink to this heading">#</a></h2>
<p>Here, we download our image via <code class="docutils literal notranslate"><span class="pre">astroquery</span></code>. For more information, please look at the documentation for <a class="reference external" href="https://astroquery.readthedocs.io/en/latest/">Astroquery</a>,
<a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html">Astroquery.mast</a>, and <br>
<a class="reference external" href="https://mast.stsci.edu/api/v0/_c_a_o_mfields.html">CAOM Field Descriptions</a>, which is used for the <code class="docutils literal notranslate"><span class="pre">obs_table</span></code> variable below. Additionally, you may download the data from MAST using either <br> the <a class="reference external" href="https://mast.stsci.edu/search/hst/ui/#/">HST MAST Search Engine</a> or the more general <a class="reference external" href="https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html">MAST Portal</a>.</p>
<p>We download a <code class="docutils literal notranslate"><span class="pre">raw</span></code> image of star cluster 47 Tucanae (47Tuc, NGC 104), offset from the core, from CAL proposal <a class="reference external" href="https://www.stsci.edu/cgi-bin/get-proposal-info?id=15576&amp;submit=Go&amp;observatory=HST">15576</a> (July 2019).<br>
After downloading the image, we move it to the current working directory (cwd).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Edit this cell&#39;s first line if you would to download your own file(s)</span>
<span class="c1"># Get the observation records</span>
<span class="n">obs_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;idv404axq*&#39;</span><span class="p">,</span> <span class="n">proposal_id</span><span class="o">=</span><span class="mi">15576</span><span class="p">)</span>

<span class="c1"># Get the listing of data products</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs_table</span><span class="p">)</span>

<span class="c1"># Filter the products for the RAW files</span>
<span class="n">filtered_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="s1">&#39;RAW&#39;</span><span class="p">)</span>

<span class="c1"># Download all the images above</span>
<span class="n">download_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">filtered_products</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># For convenience move raws to cwd and remove empty download dir</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">download_table</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">]:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;mastDownload/HST/&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span>
        
<span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;mastDownload/HST/&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;mastDownload/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/idv404axq_raw.fits to ./mastDownload/HST/idv404axq/idv404axq_raw.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show list of current dir to verify fits file is there</span>
<span class="o">!</span>ls<span class="w"> </span>-l<span class="w"> </span>*raw.fits
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-rw-r--r-- 1 runner docker 34891200 Mar 13 14:47 idv404axq_raw.fits
</pre></div>
</div>
</div>
</div>
<p><a id="env_var"></a></p>
</section>
<section id="set-crds-environment-variable-and-download-reference-files">
<h2>5. Set CRDS Environment Variable and Download Reference Files<a class="headerlink" href="#set-crds-environment-variable-and-download-reference-files" title="Permalink to this heading">#</a></h2>
<div class="alert alert-block alert-warning" style="color:black" > <b> If you already have the absolute paths set for CRDS, please skip the code cell immediately below and proceed to the crds bestrefs command in Section 5.1.</b> <br> </div>
<p>Before we run <code class="docutils literal notranslate"><span class="pre">crds</span> <span class="pre">bestfefs</span></code> and <code class="docutils literal notranslate"><span class="pre">calwf3</span></code>, we need to <a class="reference external" href="https://hst-crds.stsci.edu/docs/cmdline_bestrefs/">set environment variables</a> for several subsequent calibration tasks.  We will point to a <br> subdirectory within the main <code class="docutils literal notranslate"><span class="pre">crds_cache/</span></code> using the <code class="docutils literal notranslate"><span class="pre">IREF</span></code> environment variable. The <code class="docutils literal notranslate"><span class="pre">IREF</span></code> variable is used for WFC3 reference files. Other <br> instruments use other variables, e.g., <code class="docutils literal notranslate"><span class="pre">JREF</span></code> for ACS. You have the option to permanently add these environment variables to your user profile by <br> adding the path in your shell’s configuration file. If you’re using bash, you would edit the <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code> file with lines such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">CRDS_SERVER_URL=&quot;https://hst-crds.stsci.edu&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">CRDS_SERVER=&quot;https://hst-crds.stsci.edu&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">CRDS_PATH=&quot;$HOME/crds_cache&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">iref=&quot;${CRDS_PATH}/references/hst/wfc3/&quot;</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_SERVER_URL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;https://hst-crds.stsci.edu&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_SERVER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;https://hst-crds.stsci.edu&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;crds_cache&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;iref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;crds_cache/references/hst/wfc3/&#39;</span>
</pre></div>
</div>
</div>
</div>
<p><a id="bestrefs"></a></p>
</section>
<section id="run-crds-bestrefs">
<h2>5.1 Run <code class="docutils literal notranslate"><span class="pre">crds</span> <span class="pre">bestrefs</span></code><a class="headerlink" href="#run-crds-bestrefs" title="Permalink to this heading">#</a></h2>
<p>The cell below calls <a class="reference external" href="https://hst-crds.stsci.edu/static/users_guide/basic_use.html">CRDS bestref</a>, which will copy the necessary reference files from CRDS over to your local machine, if you do not already have <br> them. Without running this command we would not be able to calibrate the image with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>crds<span class="w"> </span>bestrefs<span class="w"> </span>--update-bestrefs<span class="w"> </span>--sync-references<span class="o">=</span><span class="m">1</span><span class="w"> </span>--files<span class="w"> </span>idv404axq_raw.fits
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_wf4tfile_0250.rmap         678 bytes  (1 / 142 files) (0 / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_shadfile_0250.rmap         977 bytes  (2 / 142 files) (678 / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_offtab_0250.rmap           642 bytes  (3 / 142 files) (1.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_maskfile_0250.rmap         685 bytes  (4 / 142 files) (2.3 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_idctab_0250.rmap           696 bytes  (5 / 142 files) (3.0 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_flatfile_0250.rmap      30.0 K bytes  (6 / 142 files) (3.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_dgeofile_0250.rmap         801 bytes  (7 / 142 files) (33.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_darkfile_0250.rmap     178.4 K bytes  (8 / 142 files) (34.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_biasfile_0250.rmap       3.3 K bytes  (9 / 142 files) (212.8 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_atodfile_0250.rmap         874 bytes  (10 / 142 files) (216.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfpc2_0250.imap                  782 bytes  (11 / 142 files) (217.0 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_snkcfile_0003.rmap          681 bytes  (12 / 142 files) (217.8 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_satufile_0002.rmap        1.0 K bytes  (13 / 142 files) (218.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_pfltfile_0253.rmap       34.2 K bytes  (14 / 142 files) (219.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_pctetab_0004.rmap           698 bytes  (15 / 142 files) (253.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_oscntab_0250.rmap           747 bytes  (16 / 142 files) (254.4 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_npolfile_0254.rmap        4.0 K bytes  (17 / 142 files) (255.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_nlinfile_0250.rmap          726 bytes  (18 / 142 files) (259.2 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_mdriztab_0254.rmap          845 bytes  (19 / 142 files) (259.9 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_imphttab_0257.rmap          683 bytes  (20 / 142 files) (260.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_idctab_0254.rmap            661 bytes  (21 / 142 files) (261.4 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_flshfile_0256.rmap        5.8 K bytes  (22 / 142 files) (262.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_drkcfile_0201.rmap      243.8 K bytes  (23 / 142 files) (267.9 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_dfltfile_0002.rmap       17.1 K bytes  (24 / 142 files) (511.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_darkfile_0501.rmap      291.1 K bytes  (25 / 142 files) (528.8 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_d2imfile_0251.rmap          605 bytes  (26 / 142 files) (819.9 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_crrejtab_0250.rmap          803 bytes  (27 / 142 files) (820.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_ccdtab_0250.rmap            799 bytes  (28 / 142 files) (821.3 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_bpixtab_0318.rmap        12.1 K bytes  (29 / 142 files) (822.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_biasfile_0267.rmap       23.4 K bytes  (30 / 142 files) (834.3 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_biacfile_0003.rmap          692 bytes  (31 / 142 files) (857.6 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_atodtab_0250.rmap           651 bytes  (32 / 142 files) (858.3 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_wfc3_0613.imap                 1.3 K bytes  (33 / 142 files) (859.0 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_synphot_tmttab_0002.rmap         745 bytes  (34 / 142 files) (860.3 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_synphot_tmgtab_0012.rmap         767 bytes  (35 / 142 files) (861.0 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_synphot_tmctab_0055.rmap         743 bytes  (36 / 142 files) (861.8 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_synphot_thruput_0059.rmap    329.6 K bytes  (37 / 142 files) (862.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_synphot_thermal_0003.rmap     20.4 K bytes  (38 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_synphot_obsmodes_0004.rmap       743 bytes  (39 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_synphot_0070.imap                579 bytes  (40 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_xtractab_0250.rmap          815 bytes  (41 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_wcptab_0251.rmap            578 bytes  (42 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_teltab_0250.rmap            745 bytes  (43 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_tdstab_0254.rmap            921 bytes  (44 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_tdctab_0253.rmap            650 bytes  (45 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_srwtab_0250.rmap            745 bytes  (46 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_sptrctab_0251.rmap          895 bytes  (47 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_sdctab_0251.rmap            889 bytes  (48 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_riptab_0254.rmap            877 bytes  (49 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_phottab_0258.rmap         1.6 K bytes  (50 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_pfltfile_0250.rmap       23.7 K bytes  (51 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_pctab_0250.rmap           3.1 K bytes  (52 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_mofftab_0250.rmap           747 bytes  (53 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_mlintab_0250.rmap           601 bytes  (54 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_lfltfile_0250.rmap       11.8 K bytes  (55 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_lamptab_0250.rmap           610 bytes  (56 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_inangtab_0250.rmap          815 bytes  (57 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_imphttab_0252.rmap          616 bytes  (58 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_idctab_0251.rmap            775 bytes  (59 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_halotab_0250.rmap           747 bytes  (60 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_gactab_0250.rmap            651 bytes  (61 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_exstab_0250.rmap            745 bytes  (62 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_echsctab_0250.rmap          749 bytes  (63 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_disptab_0250.rmap           813 bytes  (64 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_darkfile_0361.rmap       61.5 K bytes  (65 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_crrejtab_0250.rmap          711 bytes  (66 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_cdstab_0250.rmap            745 bytes  (67 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_ccdtab_0252.rmap            893 bytes  (68 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_bpixtab_0250.rmap           845 bytes  (69 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_biasfile_0362.rmap      122.0 K bytes  (70 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_apertab_0250.rmap           588 bytes  (71 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_apdestab_0252.rmap          636 bytes  (72 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_stis_0378.imap                 1.7 K bytes  (73 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_zprattab_0250.rmap        646 bytes  (74 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_tempfile_0250.rmap      1.1 K bytes  (75 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_tdffile_0250.rmap       8.9 K bytes  (76 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_saadfile_0250.rmap        771 bytes  (77 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_saacntab_0250.rmap        594 bytes  (78 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_rnlcortb_0250.rmap        771 bytes  (79 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_pmskfile_0250.rmap        603 bytes  (80 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_pmodfile_0250.rmap        603 bytes  (81 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_phottab_0250.rmap         862 bytes  (82 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_pedsbtab_0250.rmap        594 bytes  (83 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_noisfile_0250.rmap      2.6 K bytes  (84 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_nlinfile_0250.rmap      1.7 K bytes  (85 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_maskfile_0250.rmap      1.2 K bytes  (86 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_illmfile_0250.rmap      5.8 K bytes  (87 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_idctab_0250.rmap          767 bytes  (88 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_flatfile_0250.rmap     11.0 K bytes  (89 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_darkfile_0250.rmap     14.9 K bytes  (90 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_nicmos_0250.imap               1.1 K bytes  (91 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_ywlkfile_0003.rmap           922 bytes  (92 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_xwlkfile_0002.rmap           922 bytes  (93 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_xtractab_0269.rmap         1.6 K bytes  (94 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_wcptab_0257.rmap           1.3 K bytes  (95 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_twozxtab_0277.rmap           990 bytes  (96 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_tracetab_0276.rmap           998 bytes  (97 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_tdstab_0272.rmap             803 bytes  (98 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_spwcstab_0255.rmap         1.1 K bytes  (99 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_spottab_0007.rmap            766 bytes  (100 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_proftab_0276.rmap          1.0 K bytes  (101 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_phatab_0250.rmap             668 bytes  (102 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_lamptab_0264.rmap          1.4 K bytes  (103 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_hvtab_0259.rmap              567 bytes  (104 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_hvdstab_0002.rmap          1.0 K bytes  (105 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_gsagtab_0261.rmap            712 bytes  (106 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_geofile_0250.rmap            670 bytes  (107 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_fluxtab_0282.rmap          1.7 K bytes  (108 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_flatfile_0264.rmap         1.8 K bytes  (109 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_disptab_0276.rmap          1.7 K bytes  (110 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_dgeofile_0002.rmap           909 bytes  (111 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_deadtab_0250.rmap            711 bytes  (112 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_brsttab_0250.rmap            696 bytes  (113 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_brftab_0250.rmap             614 bytes  (114 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_bpixtab_0260.rmap            773 bytes  (115 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_badttab_0252.rmap            643 bytes  (116 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_cos_0360.imap                  1.4 K bytes  (117 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_spottab_0251.rmap            641 bytes  (118 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_snkcfile_0104.rmap         7.7 K bytes  (119 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_shadfile_0251.rmap           531 bytes  (120 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_satufile_0002.rmap         1.2 K bytes  (121 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_pfltfile_0253.rmap        69.2 K bytes  (122 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_pctetab_0254.rmap            615 bytes  (123 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_oscntab_0251.rmap            781 bytes  (124 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_npolfile_0253.rmap         3.2 K bytes  (125 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_mlintab_0250.rmap            646 bytes  (126 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_mdriztab_0253.rmap           769 bytes  (127 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_imphttab_0260.rmap           769 bytes  (128 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_idctab_0256.rmap           1.5 K bytes  (129 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_flshfile_0268.rmap         3.4 K bytes  (130 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_drkcfile_0456.rmap        15.2 K bytes  (131 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_dgeofile_0250.rmap         3.2 K bytes  (132 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_darkfile_0446.rmap        87.2 K bytes  (133 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_d2imfile_0253.rmap           601 bytes  (134 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_crrejtab_0251.rmap           945 bytes  (135 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_cfltfile_0250.rmap         1.2 K bytes  (136 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_ccdtab_0256.rmap           1.4 K bytes  (137 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_bpixtab_0253.rmap          1.1 K bytes  (138 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_biasfile_0444.rmap        57.2 K bytes  (139 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_atodtab_0251.rmap            528 bytes  (140 / 142 files) (1.8 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_acs_0548.imap                  1.3 K bytes  (141 / 142 files) (1.8 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/mappings/hst/hst_1220.pmap                        495 bytes  (142 / 142 files) (1.8 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  No comparison context or source comparison requested.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  ===&gt; Processing idv404axq_raw.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/2731450pi_idc.fits         40.3 K bytes  (1 / 18 files) (0 / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/27d1518pi_npl.fits         49.0 K bytes  (2 / 18 files) (40.3 K / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/2ck18260i_mdz.fits        118.1 K bytes  (3 / 18 files) (89.3 K / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/3a32019bi_bpx.fits          1.7 M bytes  (4 / 18 files) (207.4 K / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/42h2117di_bia.fits        174.2 M bytes  (5 / 18 files) (1.9 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/51c1638pi_imp.fits        397.4 K bytes  (6 / 18 files) (176.1 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/54l1347ei_cte.fits          1.2 M bytes  (7 / 18 files) (176.5 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/6c82013hi_fls.fits        209.0 M bytes  (8 / 18 files) (177.6 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/7b21735ti_sat.fits        174.2 M bytes  (9 / 18 files) (386.6 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/7bg1930ki_dkc.fits        168.1 M bytes  (10 / 18 files) (560.8 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/7bg1956fi_drk.fits        168.1 M bytes  (11 / 18 files) (728.9 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/n9i1435li_crr.fits         11.5 K bytes  (12 / 18 files) (897.0 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/q911321oi_osc.fits         25.9 K bytes  (13 / 18 files) (897.0 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/t291659mi_ccd.fits        247.7 K bytes  (14 / 18 files) (897.0 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/y7b1516hi_d2i.fits         51.8 K bytes  (15 / 18 files) (897.3 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/zcv20544i_pfl.fits        168.1 M bytes  (16 / 18 files) (897.3 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/zcv2057ni_bic.fits        174.2 M bytes  (17 / 18 files) (1.1 G / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/zcv2057oi_snk.fits         69.7 M bytes  (18 / 18 files) (1.2 G / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  0 errors
CRDS - INFO -  0 warnings
CRDS - INFO -  162 infos
</pre></div>
</div>
</div>
</div>
<p><a id="imageheaders"></a></p>
</section>
<section id="inspect-image-header">
<h2>5.2 Inspect Image Header<a class="headerlink" href="#inspect-image-header" title="Permalink to this heading">#</a></h2>
<p>When processing a raw file through <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> ,  the pipeline uses a few different header keywords to initiate and run the pixel-based CTE <br> correction. Here, we inspect the important header keywords from the raw file just downloaded.<br>
At this step, you should see: <br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pctetab</span></code> set to <code class="docutils literal notranslate"><span class="pre">iref$54l1347ei_cte.fits</span></code><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">drkcfile</span></code> set to <code class="docutils literal notranslate"><span class="pre">iref$54n2022fi_dkc.fits</span></code><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pctecorr</span></code> set to <code class="docutils literal notranslate"><span class="pre">PERFORM</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Collect header keyword info from raw file</span>
<span class="n">file</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">expstart</span><span class="p">,</span> <span class="n">pctetab</span><span class="p">,</span> <span class="n">drkcfile</span><span class="p">,</span> <span class="n">pctecorr</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*raw.fits&#39;</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span>
    <span class="n">date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;date-obs&#39;</span><span class="p">])</span>
    <span class="n">expstart</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;expstart&#39;</span><span class="p">])</span>
    <span class="n">pctetab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;pctetab&#39;</span><span class="p">])</span>
    <span class="n">drkcfile</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;drkcfile&#39;</span><span class="p">])</span>
    <span class="n">pctecorr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;pctecorr&#39;</span><span class="p">])</span>

<span class="n">image_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">file</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">expstart</span><span class="p">,</span> <span class="n">pctetab</span><span class="p">,</span> <span class="n">drkcfile</span><span class="p">,</span> <span class="n">pctecorr</span><span class="p">],</span>
                    <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;date-obs&#39;</span><span class="p">,</span> <span class="s1">&#39;expstart&#39;</span><span class="p">,</span> <span class="s1">&#39;pctetab&#39;</span><span class="p">,</span> <span class="s1">&#39;drkcfile&#39;</span><span class="p">,</span> <span class="s1">&#39;pctecorr&#39;</span><span class="p">))</span>
<span class="n">image_table</span><span class="p">[</span><span class="s1">&#39;expstart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;5.6f&#39;</span>

<span class="c1"># Sort and display the table</span>
<span class="n">image_table</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;expstart&#39;</span><span class="p">)</span>
<span class="n">image_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140359360608144" class="table-striped table-bordered table-condensed">
<thead><tr><th>file</th><th>date-obs</th><th>expstart</th><th>pctetab</th><th>drkcfile</th><th>pctecorr</th></tr></thead>
<thead><tr><th>str18</th><th>str10</th><th>float64</th><th>str23</th><th>str23</th><th>str7</th></tr></thead>
<tr><td>idv404axq_raw.fits</td><td>2019-07-29</td><td>58693.181643</td><td>iref$54l1347ei_cte.fits</td><td>iref$7bg1930ki_dkc.fits</td><td>PERFORM</td></tr>
</table></div></div></div>
</div>
<p><a id="finddark"></a></p>
</section>
<section id="find-the-correct-v1-0-drkcfile">
<h2>6. Find the Correct v1.0 <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code><a class="headerlink" href="#find-the-correct-v1-0-drkcfile" title="Permalink to this heading">#</a></h2>
<p>Below, we open the .txt file containing a list of all the <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> reference files created with the v1.0 pixel-based CTE correction. <br><code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> reference files are CTE corrected files used by the pipeline to perform the dark current subtraction during the generation <br> of the <code class="docutils literal notranslate"><span class="pre">flc</span></code> file. The <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> files listed in <code class="docutils literal notranslate"><span class="pre">archived_drkcfiles.txt</span></code> have been archived on the CRDS database and while <br> they are still accessible for use and download, they are not being actively used by MAST. <br></p>
<p>In the first cell, we generate an <code class="docutils literal notranslate"><span class="pre">astropy.Table</span></code> ( <code class="docutils literal notranslate"><span class="pre">drkc_table</span></code> ) using the data from the file <code class="docutils literal notranslate"><span class="pre">archived_drkcfiles.txt</span></code>, mentioned <br> in <span class="xref myst">Section 2</span>, and create empty lists for the final table. Then, in the second cell, we index the <code class="docutils literal notranslate"><span class="pre">drkc_table</span></code> table for the best <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> <br> that corresponds to the <code class="docutils literal notranslate"><span class="pre">DATE-OBS</span></code>  of the <code class="docutils literal notranslate"><span class="pre">raw</span></code> file being calibrated. Lastly, in the third cell, we create and display the final <code class="docutils literal notranslate"><span class="pre">astropy.table</span></code> <br>that contains just the necessary <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code>.<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate astropy table from `archived_drkcfiles.txt`</span>
<span class="n">drkc_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;archived_drkcfiles.txt&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.commented_header&#39;</span><span class="p">)</span>

<span class="c1"># Create empty lists for final astropy table</span>
<span class="n">rawfiles</span><span class="p">,</span> <span class="n">obsdates</span><span class="p">,</span> <span class="n">dkcfiles</span><span class="p">,</span> <span class="n">uafters</span><span class="p">,</span> <span class="n">active_dates</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using image header table from section 4.1 find closest drkcfile</span>
<span class="k">for</span> <span class="n">expstart</span> <span class="ow">in</span> <span class="n">image_table</span><span class="p">[</span><span class="s1">&#39;expstart&#39;</span><span class="p">]:</span>
    <span class="n">table_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">drkc_table</span><span class="p">[</span><span class="s1">&#39;useafter-mjd&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">expstart</span><span class="p">)</span> <span class="o">==</span> <span class="nb">abs</span><span class="p">(</span><span class="n">drkc_table</span><span class="p">[</span><span class="s1">&#39;useafter-mjd&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">expstart</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">rawfile</span> <span class="o">=</span> <span class="n">image_table</span><span class="p">[</span><span class="n">image_table</span><span class="p">[</span><span class="s1">&#39;expstart&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">expstart</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># if drkcfile has useafter date &gt; rawfile expstart use previous drkcfile</span>
    <span class="k">if</span> <span class="n">drkc_table</span><span class="p">[</span><span class="n">table_idx</span><span class="p">][</span><span class="s1">&#39;useafter-mjd&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">image_table</span><span class="p">[</span><span class="n">image_table</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">rawfile</span><span class="p">][</span><span class="s1">&#39;expstart&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">table_idx</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="c1"># append info</span>
    <span class="n">rawfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rawfile</span><span class="p">)</span>
    <span class="n">obsdates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_table</span><span class="p">[</span><span class="n">image_table</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">rawfile</span><span class="p">][</span><span class="s1">&#39;date-obs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">dkcfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drkc_table</span><span class="p">[</span><span class="n">table_idx</span><span class="p">][</span><span class="s1">&#39;drkcfile&#39;</span><span class="p">])</span>
    <span class="n">uafters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drkc_table</span><span class="p">[</span><span class="n">table_idx</span><span class="p">][</span><span class="s1">&#39;useafter&#39;</span><span class="p">])</span>
    <span class="n">active_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drkc_table</span><span class="p">[</span><span class="n">table_idx</span><span class="p">][</span><span class="s1">&#39;activation-date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate table of filename, date-obs, drkc-filename, corresponding useafter</span>
<span class="n">raw_dkc_tab</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">rawfiles</span><span class="p">,</span> <span class="n">obsdates</span><span class="p">,</span> <span class="n">dkcfiles</span><span class="p">,</span> <span class="n">uafters</span><span class="p">,</span> <span class="n">active_dates</span><span class="p">],</span>
                    <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;date-obs&#39;</span><span class="p">,</span> <span class="s1">&#39;dkc-filename&#39;</span><span class="p">,</span> <span class="s1">&#39;dkc-useafter&#39;</span><span class="p">,</span> <span class="s1">&#39;dkc-activation&#39;</span><span class="p">))</span>
<span class="c1"># Display table</span>
<span class="n">raw_dkc_tab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140358755037904" class="table-striped table-bordered table-condensed">
<thead><tr><th>filename</th><th>date-obs</th><th>dkc-filename</th><th>dkc-useafter</th><th>dkc-activation</th></tr></thead>
<thead><tr><th>str18</th><th>str10</th><th>str18</th><th>str10</th><th>str10</th></tr></thead>
<tr><td>idv404axq_raw.fits</td><td>2019-07-29</td><td>3961719li_dkc.fits</td><td>2019-07-28</td><td>2019-09-09</td></tr>
</table></div></div></div>
</div>
<p><a id="sync_dkc"></a></p>
</section>
<section id="download-the-correct-drkcfile-from-crds">
<h2>6.1 Download the Correct <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> from CRDS<a class="headerlink" href="#download-the-correct-drkcfile-from-crds" title="Permalink to this heading">#</a></h2>
<p>Now that we know the name of the correct <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code>, it must be retrieved from CRDS and stored on your local machine so that it can be used <br>during calibration. To copy the file from CRDS we use the <a class="reference external" href="https://hst-crds.stsci.edu/static/users_guide/command_line_tools.html#crds-sync">crds sync</a> command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dkc</span> <span class="ow">in</span> <span class="n">raw_dkc_tab</span><span class="p">[</span><span class="s1">&#39;dkc-filename&#39;</span><span class="p">]:</span>
    <span class="o">!</span>crds<span class="w"> </span>sync<span class="w"> </span>--hst<span class="w"> </span>--files<span class="w"> </span><span class="o">{</span>dkc<span class="o">}</span><span class="w"> </span>--output-dir<span class="w"> </span><span class="o">{</span>os.environ<span class="o">[</span><span class="s1">&#39;iref&#39;</span><span class="o">]}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Symbolic context &#39;hst-latest&#39; resolves to &#39;hst_1220.pmap&#39;
CRDS - INFO -  Reorganizing 0 references from &#39;instrument&#39; to &#39;flat&#39;
CRDS - INFO -  Reorganizing from &#39;instrument&#39; to &#39;flat&#39; cache,  removing instrument directories.
CRDS - INFO -  Syncing explicitly listed files.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/3961719li_dkc.fits        168.1 M bytes  (1 / 1 files) (0 / 168.1 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  0 errors
CRDS - INFO -  0 warnings
CRDS - INFO -  5 infos
</pre></div>
</div>
</div>
</div>
<p><a id="mod_dkc"></a></p>
</section>
<section id="modify-the-image-header-keyword-drkcfile">
<h2>6.2 Modify the Image Header Keyword, <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code><a class="headerlink" href="#modify-the-image-header-keyword-drkcfile" title="Permalink to this heading">#</a></h2>
<p>With the v1.0 CTE-corrected dark current reference file that corresponds to our <code class="docutils literal notranslate"><span class="pre">raw</span></code> science file copied to our local machine, we’re ready to <br> edit the header keyword with the proper <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;i*raw.fits&#39;</span><span class="p">):</span>
    <span class="c1"># Using raw_dkc_tab from above, grab appropriate drkcfile</span>
    <span class="n">ctecorr_dark</span> <span class="o">=</span> <span class="s1">&#39;iref$&#39;</span><span class="o">+</span><span class="n">raw_dkc_tab</span><span class="p">[</span><span class="n">raw_dkc_tab</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">file</span><span class="p">][</span><span class="s1">&#39;dkc-filename&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;DRKCFILE&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ctecorr_dark</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a id="sync_pctetab"></a></p>
</section>
<section id="download-the-v1-0-pctetab">
<h2>7. Download the v1.0 <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code><a class="headerlink" href="#download-the-v1-0-pctetab" title="Permalink to this heading">#</a></h2>
<p>The next reference file we’re going to download from CRDS is the <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code>. This is the pixel-based correction reference table and without it <br> the algorithm will not work. In order to use the v1.0 pixel based correction, we must retrieve the v1.0 <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code> and set the header keyword to <br> the proper reference file. In the cells below, we use the <code class="docutils literal notranslate"><span class="pre">crds</span> <span class="pre">sync</span></code> command again and then set the <code class="docutils literal notranslate"><span class="pre">raw</span></code> file’s <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code> to the v1.0 <br> reference table, <a class="reference external" href="https://hst-crds.stsci.edu/browse/zcv2057mi_cte.fits">zcv2057mi_cte.fits</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>crds<span class="w"> </span>sync<span class="w"> </span>--hst<span class="w"> </span>--files<span class="w"> </span>zcv2057mi_cte.fits<span class="w"> </span>--output-dir<span class="w"> </span><span class="o">{</span>os.environ<span class="o">[</span><span class="s1">&#39;iref&#39;</span><span class="o">]}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Symbolic context &#39;hst-latest&#39; resolves to &#39;hst_1220.pmap&#39;
CRDS - INFO -  Reorganizing 26 references from &#39;flat&#39; to &#39;flat&#39;
CRDS - INFO -  Syncing explicitly listed files.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  crds_cache/references/hst/wfc3/zcv2057mi_cte.fits          1.2 M bytes  (1 / 1 files) (0 / 1.2 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  0 errors
CRDS - INFO -  0 warnings
CRDS - INFO -  4 infos
</pre></div>
</div>
</div>
</div>
<p><a id="mod_pcte"></a></p>
</section>
<section id="modify-the-image-header-keyword-pctetab">
<h2>7.1 Modify the Image Header Keyword, <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code><a class="headerlink" href="#modify-the-image-header-keyword-pctetab" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;idv404axq_raw.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;PCTETAB&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;iref$zcv2057mi_cte.fits&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p><a id="reinspect"></a></p>
</section>
<section id="re-inspect-image-header">
<h2>8. Re-Inspect Image Header<a class="headerlink" href="#re-inspect-image-header" title="Permalink to this heading">#</a></h2>
<p>Now with the headers modified, we inspect the keywords one last time to verify the file was updated properly before we process <br> it through <code class="docutils literal notranslate"><span class="pre">calwf3</span></code>. At this point you should see:<br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code> set to <code class="docutils literal notranslate"><span class="pre">iref$zcv2057mi_cte.fits</span></code><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> set to <code class="docutils literal notranslate"><span class="pre">iref$3961719li_dkc.fits</span></code><br></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recollect and display header keywords</span>
<span class="n">file</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">expstart</span><span class="p">,</span> <span class="n">pctetab</span><span class="p">,</span> <span class="n">drkcfile</span><span class="p">,</span> <span class="n">pctecorr</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*raw.fits&#39;</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span>
    <span class="n">date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;date-obs&#39;</span><span class="p">])</span>
    <span class="n">expstart</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;expstart&#39;</span><span class="p">])</span>
    <span class="n">pctetab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;pctetab&#39;</span><span class="p">])</span>
    <span class="n">drkcfile</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;drkcfile&#39;</span><span class="p">])</span>
    <span class="n">pctecorr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;pctecorr&#39;</span><span class="p">])</span>

<span class="n">updated_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">file</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">expstart</span><span class="p">,</span> <span class="n">pctetab</span><span class="p">,</span> <span class="n">drkcfile</span><span class="p">,</span> <span class="n">pctecorr</span><span class="p">],</span>
                      <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;date-obs&#39;</span><span class="p">,</span> <span class="s1">&#39;expstart&#39;</span><span class="p">,</span> <span class="s1">&#39;pctetab&#39;</span><span class="p">,</span> <span class="s1">&#39;drkcfile&#39;</span><span class="p">,</span> <span class="s1">&#39;pctecorr&#39;</span><span class="p">))</span>
<span class="n">updated_table</span><span class="p">[</span><span class="s1">&#39;expstart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;5.6f&#39;</span>

<span class="c1"># Sort and display the table</span>
<span class="n">updated_table</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;expstart&#39;</span><span class="p">)</span>
<span class="n">updated_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140359360510416" class="table-striped table-bordered table-condensed">
<thead><tr><th>file</th><th>date-obs</th><th>expstart</th><th>pctetab</th><th>drkcfile</th><th>pctecorr</th></tr></thead>
<thead><tr><th>str18</th><th>str10</th><th>float64</th><th>str23</th><th>str23</th><th>str7</th></tr></thead>
<tr><td>idv404axq_raw.fits</td><td>2019-07-29</td><td>58693.181643</td><td>iref$zcv2057mi_cte.fits</td><td>iref$3961719li_dkc.fits</td><td>PERFORM</td></tr>
</table></div></div></div>
</div>
<p><a id="runcal"></a></p>
</section>
<section id="run-calwf3">
<h2>9. Run <code class="docutils literal notranslate"><span class="pre">calwf3</span></code><a class="headerlink" href="#run-calwf3" title="Permalink to this heading">#</a></h2>
<p>As a reminder, the <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> version must be <code class="docutils literal notranslate"><span class="pre">3.5.2</span></code> to use the v1.0 pixel-base CTE correction with the most up-to-date calibration parameters. <br> If you are not using version <code class="docutils literal notranslate"><span class="pre">3.5.2</span></code> the below <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> call will crash due to an out-of-date <code class="docutils literal notranslate"><span class="pre">IMPHTTAB</span></code> reference file. <br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;idv404axq_flt.fits&#39;</span><span class="p">):</span>
    <span class="n">calwf3</span><span class="p">(</span><span class="s1">&#39;idv404axq_raw.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty

git branch: HEAD

HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4





CALBEG*** CALWF3 -- Version 3.7.2 (Apr-15-2024) ***

Begin    13-Mar-2025 14:48:59 UTC





Input    idv404axq_raw.fits

loading asn



LoadAsn:  Processing SINGLE exposure

Trying to open idv404axq_raw.fits...

Read in Primary header from idv404axq_raw.fits...

Using parallel processing provided by OpenMP inside CTE routine

Setting max threads to 4 of 4 cpus





CALBEG*** WFC3CTE -- Version 3.7.2 (Apr-15-2024) ***

Begin    13-Mar-2025 14:48:59 UTC

Input    idv404axq_raw.fits

Output   idv404axq_rac_tmp.fits

Creating new trailer file `idv404axq.tra&#39;.

Trying to open idv404axq_raw.fits...

Read in Primary header from idv404axq_raw.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trying to open iref$zcv2057mi_cte.fits...

Read in Primary header from iref$zcv2057mi_cte.fits...



CTE_NAME: pixelCTE 2012

CTE_VER: 1.0

CTEDATE0: 54962

CTEDATE1: 56173

PCTETLEN: 60

PCTERNFOR: 5

PCTERNPAR: 7

PCTENSMD: 0

PCTETRSH: -10

Reading in image from extension 3

Reading in image from extension 4
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CTE: Subtracting BIACFILE: iref$zcv2057ni_bic.fits for imset 1

CTE: Subtracting BIACFILE: iref$zcv2057ni_bic.fits for imset 2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CTE_FF:    3.081 

PCTERNOI:   0.0000 (source: primary header of science image)





RNOIVAL:   6.0121 BKGDVAL:  20.3068



PCTERNOI:   6.0121 (source: computed on-the-fly from science image)

This computed value supersedes any value obtained from the primary

header of the science image.





CTE: jumping into the routine...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                             

   INSIDE sub_ctecor_v2.f... 

          ---&gt; PCTERNOI:   6.0121 

          ---&gt; FIX_ROCR: -10.0000 

          ---&gt;  NITFORs:     5 

          ---&gt;  NITPARs:     7 

                             

CTE: returning from the routine...

PCTEFRAC saved to header

PCTERNOI saved to header
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PCTECORR COMPLETE





CALBEG*** WF3CCD -- Version 3.7.2 (Apr-15-2024) ***

Begin    13-Mar-2025 14:54:34 UTC

Input:   idv404axq_rac_tmp.fits

Output:  idv404axq_blc_tmp.fits

Trying to open idv404axq_rac_tmp.fits...

Read in Primary header from idv404axq_rac_tmp.fits...

APERTURE UVIS

FILTER   F502N

DETECTOR UVIS





Imset 1  Begin 14:54:34 UTC

CCDTAB   iref$t291659mi_ccd.fits

CCDTAB   PEDIGREE=GROUND

CCDTAB   DESCRIP =UVIS-1 CCD characteristics from TV3 data

CCDTAB   DESCRIP =From TV3 data

    Uncertainty array initialized,

    readnoise =3.03,3.13,3.08,3.18

    gain =1.56,1.56,1.56,1.56

    default bias levels = 2556.4,2543.8,2503.3,2605.7

DQICORR  PERFORM

DQITAB   iref$3a32019bi_bpx.fits

DQITAB   PEDIGREE=INFLIGHT 23/06/2009 15/10/2009

DQITAB   DESCRIP =Based on SMOV and Cycle 17 data.-----------------------------------

Amp: ABCD chip: 2 ccdamp: CD 

Number of amps 2

DQICORR  COMPLETE

ATODCORR OMIT

BLEVCORR PERFORM

OSCNTAB  iref$q911321oi_osc.fits

OSCNTAB  PEDIGREE=GROUND

OSCNTAB  DESCRIP =WFC3 normal overscan CCD data compatible

(blevcorr) Rejected 132 bias values from parallel fit.

Computed a parallel fit with slope of -0.000199413

(blevcorr) Rejected 1 bias values from serial fit.

Computed a serial fit with slope of 4.68593e-05 and intercept of 2501.47

(blevcorr) Rejected 149 bias values from parallel fit.

Computed a parallel fit with slope of 0.000126276

(blevcorr) Rejected 3 bias values from serial fit.

Computed a serial fit with slope of -1.40576e-05 and intercept of 2602.82

Bias level from overscan has been subtracted;

     mean of bias levels subtracted was 2552.18.

     bias level of 2501.68 was subtracted for AMP C.

     bias level of 2602.68 was subtracted for AMP D.

BLEVCORR COMPLETE

BIASCORR PERFORM

BIASFILE iref$42h2117di_bia.fits

BIASFILE PEDIGREE=INFLIGHT 2019-01-01 2019-12-31

BIASFILE DESCRIP =2019 Superbias intended for use with WFC3/UVIS non-subarray data
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BIASCORR COMPLETE

SATUFILE iref$7b21735ti_sat.fits

SATUFILE PEDIGREE=GROUND

SATUFILE DESCRIP =Saturation level map for full-frame unbinned and subarray &amp;



Full-well saturation flagging being performed.

Image has starting location of 0,0 in the reference image

Saturation image and input are the same size.

Amp: ABCD chip: 2 ccdamp: CD 

Number of amps 2

Full-frame full-well saturation image flagging step done.





Performing SINK pixel detection for imset 1

Sink pixel flagging complete

FLSHCORR PERFORM

FLSHFILE iref$6c82013hi_fls.fits

FLSHFILE PEDIGREE=INFLIGHT 27/08/2012 07/12/2022

FLSHFILE DESCRIP =Post-flash created from in-flight WFC3/UVIS frames.----------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean of post-flash image (MEANFLSH) = 12.0681

FLSHCORR COMPLETE

Imset 1  End 14:54:34 UTC





Imset 2  Begin 14:54:34 UTC

CCDTAB   iref$t291659mi_ccd.fits

CCDTAB   PEDIGREE=GROUND

CCDTAB   DESCRIP =UVIS-1 CCD characteristics from TV3 data

CCDTAB   DESCRIP =From TV3 data

    Uncertainty array initialized,

    readnoise =3.03,3.13,3.08,3.18

    gain =1.56,1.56,1.56,1.56

    default bias levels = 2556.4,2543.8,2503.3,2605.7

DQICORR  PERFORM

Amp: ABCD chip: 1 ccdamp: AB 

Number of amps 2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DQICORR  COMPLETE

ATODCORR OMIT

BLEVCORR PERFORM

(blevcorr) Rejected 162 bias values from parallel fit.

Computed a parallel fit with slope of -7.74594e-05

(blevcorr) Rejected 0 bias values from serial fit.

Computed a serial fit with slope of 2.42297e-05 and intercept of 2554.35

(blevcorr) Rejected 165 bias values from parallel fit.

Computed a parallel fit with slope of -1.0644e-05

(blevcorr) Rejected 0 bias values from serial fit.

Computed a serial fit with slope of 3.90277e-05 and intercept of 2541.86

Bias level from overscan has been subtracted;

     mean of bias levels subtracted was 2548.15.

     bias level of 2554.43 was subtracted for AMP A.

     bias level of 2541.87 was subtracted for AMP B.

     bias level of 2501.68 was subtracted for AMP C.

     bias level of 2602.68 was subtracted for AMP D.

BLEVCORR COMPLETE

BIASCORR PERFORM

BIASCORR COMPLETE



Full-well saturation flagging being performed.

Image has starting location of 0,0 in the reference image

Saturation image and input are the same size.

Amp: ABCD chip: 1 ccdamp: AB 

Number of amps 2

Full-frame full-well saturation image flagging step done.





Performing SINK pixel detection for imset 2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sink pixel flagging complete

FLSHCORR PERFORM

Mean of post-flash image (MEANFLSH) = 12.0962

FLSHCORR COMPLETE

Imset 2  End 14:54:35 UTC

Setting Bias Keywords in header





End      13-Mar-2025 14:54:35 UTC

*** WF3CCD complete ***





CALBEG*** WF3CCD -- Version 3.7.2 (Apr-15-2024) ***

Begin    13-Mar-2025 14:54:35 UTC

Revising existing trailer file `idv404axq.tra&#39;.

Input:   idv404axq_raw.fits

Output:  idv404axq_blv_tmp.fits

Trying to open idv404axq_raw.fits...

Read in Primary header from idv404axq_raw.fits...

APERTURE UVIS

FILTER   F502N

DETECTOR UVIS





Imset 1  Begin 14:54:35 UTC

CCDTAB   iref$t291659mi_ccd.fits

CCDTAB   PEDIGREE=GROUND

CCDTAB   DESCRIP =UVIS-1 CCD characteristics from TV3 data

CCDTAB   DESCRIP =From TV3 data
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Uncertainty array initialized,

    readnoise =3.03,3.13,3.08,3.18

    gain =1.56,1.56,1.56,1.56

    default bias levels = 2556.4,2543.8,2503.3,2605.7

DQICORR  PERFORM

DQITAB   iref$3a32019bi_bpx.fits

DQITAB   PEDIGREE=INFLIGHT 23/06/2009 15/10/2009

DQITAB   DESCRIP =Based on SMOV and Cycle 17 data.-----------------------------------

Amp: ABCD chip: 2 ccdamp: CD 

Number of amps 2

DQICORR  COMPLETE

ATODCORR OMIT

BLEVCORR PERFORM

OSCNTAB  iref$q911321oi_osc.fits

OSCNTAB  PEDIGREE=GROUND

OSCNTAB  DESCRIP =WFC3 normal overscan CCD data compatible

(blevcorr) Rejected 38 bias values from parallel fit.

Computed a parallel fit with slope of -0.000120045

(blevcorr) Rejected 1 bias values from serial fit.

Computed a serial fit with slope of 7.17663e-05 and intercept of 2501.52

(blevcorr) Rejected 29 bias values from parallel fit.

Computed a parallel fit with slope of 0.000100165

(blevcorr) Rejected 2 bias values from serial fit.

Computed a serial fit with slope of -2.86934e-06 and intercept of 2602.87

Bias level from overscan has been subtracted;

     mean of bias levels subtracted was 2552.2.

     bias level of 2501.65 was subtracted for AMP C.

     bias level of 2602.76 was subtracted for AMP D.

BLEVCORR COMPLETE

BIASCORR PERFORM

BIASFILE iref$42h2117di_bia.fits

BIASFILE PEDIGREE=INFLIGHT 2019-01-01 2019-12-31

BIASFILE DESCRIP =2019 Superbias intended for use with WFC3/UVIS non-subarray data

BIASCORR COMPLETE

SATUFILE iref$7b21735ti_sat.fits

SATUFILE PEDIGREE=GROUND

SATUFILE DESCRIP =Saturation level map for full-frame unbinned and subarray &amp;



Full-well saturation flagging being performed.

Image has starting location of 0,0 in the reference image

Saturation image and input are the same size.

Amp: ABCD chip: 2 ccdamp: CD 

Number of amps 2

Full-frame full-well saturation image flagging step done.





Performing SINK pixel detection for imset 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sink pixel flagging complete

FLSHCORR PERFORM

FLSHFILE iref$6c82013hi_fls.fits

FLSHFILE PEDIGREE=INFLIGHT 27/08/2012 07/12/2022

FLSHFILE DESCRIP =Post-flash created from in-flight WFC3/UVIS frames.----------------

Mean of post-flash image (MEANFLSH) = 12.0681

FLSHCORR COMPLETE

Imset 1  End 14:54:36 UTC





Imset 2  Begin 14:54:36 UTC

CCDTAB   iref$t291659mi_ccd.fits

CCDTAB   PEDIGREE=GROUND

CCDTAB   DESCRIP =UVIS-1 CCD characteristics from TV3 data

CCDTAB   DESCRIP =From TV3 data
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Uncertainty array initialized,

    readnoise =3.03,3.13,3.08,3.18

    gain =1.56,1.56,1.56,1.56

    default bias levels = 2556.4,2543.8,2503.3,2605.7

DQICORR  PERFORM

Amp: ABCD chip: 1 ccdamp: AB 

Number of amps 2

DQICORR  COMPLETE

ATODCORR OMIT

BLEVCORR PERFORM

(blevcorr) Rejected 34 bias values from parallel fit.

Computed a parallel fit with slope of 0.000116704

(blevcorr) Rejected 0 bias values from serial fit.

Computed a serial fit with slope of -2.20229e-05 and intercept of 2554.44

(blevcorr) Rejected 26 bias values from parallel fit.

Computed a parallel fit with slope of 7.74437e-05

(blevcorr) Rejected 1 bias values from serial fit.

Computed a serial fit with slope of 1.28148e-05 and intercept of 2541.94

Bias level from overscan has been subtracted;

     mean of bias levels subtracted was 2548.08.

     bias level of 2554.31 was subtracted for AMP A.

     bias level of 2541.85 was subtracted for AMP B.

     bias level of 2501.65 was subtracted for AMP C.

     bias level of 2602.76 was subtracted for AMP D.

BLEVCORR COMPLETE

BIASCORR PERFORM

BIASCORR COMPLETE



Full-well saturation flagging being performed.

Image has starting location of 0,0 in the reference image

Saturation image and input are the same size.

Amp: ABCD chip: 1 ccdamp: AB 

Number of amps 2

Full-frame full-well saturation image flagging step done.





Performing SINK pixel detection for imset 2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sink pixel flagging complete

FLSHCORR PERFORM

Mean of post-flash image (MEANFLSH) = 12.0962

FLSHCORR COMPLETE

Imset 2  End 14:54:36 UTC

Setting Bias Keywords in header





End      13-Mar-2025 14:54:36 UTC

*** WF3CCD complete ***





CALBEG*** WF32D -- Version 3.7.2 (Apr-15-2024) ***

Begin    13-Mar-2025 14:54:36 UTC

Input    idv404axq_blv_tmp.fits

Output   idv404axq_flt.fits

Trying to open idv404axq_blv_tmp.fits...

Read in Primary header from idv404axq_blv_tmp.fits...

APERTURE UVIS

FILTER   F502N

DETECTOR UVIS





Imset 1  Begin 14:54:36 UTC

CCDTAB   iref$t291659mi_ccd.fits

CCDTAB   PEDIGREE=GROUND

CCDTAB   DESCRIP =UVIS-1 CCD characteristics from TV3 data

CCDTAB   DESCRIP =From TV3 data

DQICORR  PERFORM

DQITAB   iref$3a32019bi_bpx.fits

DQITAB   PEDIGREE=INFLIGHT 23/06/2009 15/10/2009

DQITAB   DESCRIP =Based on SMOV and Cycle 17 data.-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DQICORR  COMPLETE

DARKCORR PERFORM

DARKFILE iref$7bg1956fi_drk.fits

DARKFILE PEDIGREE=INFLIGHT 28/07/2019 31/07/2019

DARKFILE DESCRIP =DARK created from in-flight WFC3/UVIS frames ----------------------

Mean of dark image (MEANDARK) = 0.779632

DARKCORR COMPLETE

FLATCORR PERFORM

PFLTFILE iref$zcv20544i_pfl.fits

PFLTFILE PEDIGREE=INFLIGHT 14/05/2009 01/08/2011

PFLTFILE DESCRIP =------ Chip-dependent LP-flat (TV3 LP-flat * Inflight L-flat)------

FLATCORR COMPLETE

SHADCORR OMIT

PHOTCORR PERFORM

FLUXCORR PERFORM

Found parameterized variable 1.

NUMPAR=1, N=1

Allocated 1 parnames

Adding parameter mjd#58693.1816 as parnames[0]

==&gt; Value of PHOTFLAM = 5.1534121e-18

==&gt; Value of PHOTPLAM = 5009.6358

==&gt; Value of PHOTBW = 27.099804

==&gt; Value of PHTFLAM1 = 0

==&gt; Value of PHTFLAM2 = 5.1808651e-18

Found parameterized variable 1.

NUMPAR=1, N=1

Allocated 1 parnames

Adding parameter mjd#58693.1816 as parnames[0]

==&gt; Value of PHOTFLAM = 5.1534121e-18

==&gt; Value of PHOTPLAM = 5009.6379

==&gt; Value of PHOTBW = 26.961257

==&gt; Value of PHTFLAM1 = 5.1534121e-18

==&gt; Value of PHTFLAM2 = 0

IMPHTTAB iref$51c1638pi_imp.fits

IMPHTTAB PEDIGREE=INFLIGHT 08/05/2009 01/11/2019

IMPHTTAB DESCRIP =2020 Time-dependent Inverse Sensitivity with updated calspec model

PHOTCORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imset 1  End 14:54:36 UTC





Imset 2  Begin 14:54:36 UTC

CCDTAB   iref$t291659mi_ccd.fits

CCDTAB   PEDIGREE=GROUND

CCDTAB   DESCRIP =UVIS-1 CCD characteristics from TV3 data

CCDTAB   DESCRIP =From TV3 data

DQICORR  PERFORM

DQICORR  COMPLETE

DARKCORR PERFORM

Mean of dark image (MEANDARK) = 0.746724

DARKCORR COMPLETE

FLATCORR PERFORM
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FLATCORR COMPLETE

SHADCORR OMIT

PHOTCORR PERFORM

FLUXCORR PERFORM

Found parameterized variable 1.

NUMPAR=1, N=1

Allocated 1 parnames

Adding parameter mjd#58693.1816 as parnames[0]

==&gt; Value of PHOTFLAM = 5.1534121e-18

==&gt; Value of PHOTPLAM = 5009.6379

==&gt; Value of PHOTBW = 26.961257

==&gt; Value of PHTFLAM1 = 5.1534121e-18

==&gt; Value of PHTFLAM2 = 0

Found parameterized variable 1.

NUMPAR=1, N=1

Allocated 1 parnames

Adding parameter mjd#58693.1816 as parnames[0]

==&gt; Value of PHOTFLAM = 5.1534121e-18

==&gt; Value of PHOTPLAM = 5009.6358

==&gt; Value of PHOTBW = 27.099804

==&gt; Value of PHTFLAM1 = 0

==&gt; Value of PHTFLAM2 = 5.1808651e-18

IMPHTTAB iref$51c1638pi_imp.fits

IMPHTTAB PEDIGREE=INFLIGHT 08/05/2009 01/11/2019

IMPHTTAB DESCRIP =2020 Time-dependent Inverse Sensitivity with updated calspec model

PHOTCORR COMPLETE

Imset 2  End 14:54:37 UTC
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025072145437-I--------------- Image statistics recomputed: IDV404AXQ ----------

FLUXCORR PERFORM

FLUXCORR COMPLETE





End      13-Mar-2025 14:54:37 UTC

*** WF32D complete ***





CALBEG*** WF32D -- Version 3.7.2 (Apr-15-2024) ***

Begin    13-Mar-2025 14:54:37 UTC

Input    idv404axq_blc_tmp.fits

Output   idv404axq_flc.fits

Trying to open idv404axq_blc_tmp.fits...

Read in Primary header from idv404axq_blc_tmp.fits...

APERTURE UVIS

FILTER   F502N

DETECTOR UVIS





Imset 1  Begin 14:54:37 UTC

CCDTAB   iref$t291659mi_ccd.fits

CCDTAB   PEDIGREE=GROUND

CCDTAB   DESCRIP =UVIS-1 CCD characteristics from TV3 data

CCDTAB   DESCRIP =From TV3 data

DQICORR  PERFORM

DQITAB   iref$3a32019bi_bpx.fits

DQITAB   PEDIGREE=INFLIGHT 23/06/2009 15/10/2009

DQITAB   DESCRIP =Based on SMOV and Cycle 17 data.-----------------------------------

DQICORR  COMPLETE

DARKCORR PERFORM

DARKFILE iref$3961719li_dkc.fits

DARKFILE PEDIGREE=INFLIGHT 28/07/2019 31/07/2019

DARKFILE DESCRIP =DARK created from in-flight WFC3/UVIS frames ----------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean of dark image (MEANDARK) = 0.56183

DARKCORR COMPLETE

FLATCORR PERFORM

PFLTFILE iref$zcv20544i_pfl.fits

PFLTFILE PEDIGREE=INFLIGHT 14/05/2009 01/08/2011

PFLTFILE DESCRIP =------ Chip-dependent LP-flat (TV3 LP-flat * Inflight L-flat)------

FLATCORR COMPLETE

SHADCORR OMIT

PHOTCORR PERFORM

FLUXCORR PERFORM

Found parameterized variable 1.

NUMPAR=1, N=1

Allocated 1 parnames

Adding parameter mjd#58693.1816 as parnames[0]

==&gt; Value of PHOTFLAM = 5.1534121e-18

==&gt; Value of PHOTPLAM = 5009.6358

==&gt; Value of PHOTBW = 27.099804

==&gt; Value of PHTFLAM1 = 0

==&gt; Value of PHTFLAM2 = 5.1808651e-18

Found parameterized variable 1.

NUMPAR=1, N=1

Allocated 1 parnames

Adding parameter mjd#58693.1816 as parnames[0]

==&gt; Value of PHOTFLAM = 5.1534121e-18

==&gt; Value of PHOTPLAM = 5009.6379

==&gt; Value of PHOTBW = 26.961257

==&gt; Value of PHTFLAM1 = 5.1534121e-18

==&gt; Value of PHTFLAM2 = 0

IMPHTTAB iref$51c1638pi_imp.fits

IMPHTTAB PEDIGREE=INFLIGHT 08/05/2009 01/11/2019

IMPHTTAB DESCRIP =2020 Time-dependent Inverse Sensitivity with updated calspec model

PHOTCORR COMPLETE

Imset 1  End 14:54:38 UTC





Imset 2  Begin 14:54:38 UTC
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CCDTAB   iref$t291659mi_ccd.fits

CCDTAB   PEDIGREE=GROUND

CCDTAB   DESCRIP =UVIS-1 CCD characteristics from TV3 data

CCDTAB   DESCRIP =From TV3 data

DQICORR  PERFORM

DQICORR  COMPLETE

DARKCORR PERFORM

Mean of dark image (MEANDARK) = 0.558847

DARKCORR COMPLETE

FLATCORR PERFORM
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FLATCORR COMPLETE

SHADCORR OMIT

PHOTCORR PERFORM

FLUXCORR PERFORM

Found parameterized variable 1.

NUMPAR=1, N=1

Allocated 1 parnames

Adding parameter mjd#58693.1816 as parnames[0]

==&gt; Value of PHOTFLAM = 5.1534121e-18

==&gt; Value of PHOTPLAM = 5009.6379

==&gt; Value of PHOTBW = 26.961257

==&gt; Value of PHTFLAM1 = 5.1534121e-18

==&gt; Value of PHTFLAM2 = 0

Found parameterized variable 1.

NUMPAR=1, N=1

Allocated 1 parnames

Adding parameter mjd#58693.1816 as parnames[0]

==&gt; Value of PHOTFLAM = 5.1534121e-18

==&gt; Value of PHOTPLAM = 5009.6358

==&gt; Value of PHOTBW = 27.099804

==&gt; Value of PHTFLAM1 = 0

==&gt; Value of PHTFLAM2 = 5.1808651e-18

IMPHTTAB iref$51c1638pi_imp.fits

IMPHTTAB PEDIGREE=INFLIGHT 08/05/2009 01/11/2019

IMPHTTAB DESCRIP =2020 Time-dependent Inverse Sensitivity with updated calspec model

PHOTCORR COMPLETE

Imset 2  End 14:54:38 UTC
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025072145438-I--------------- Image statistics recomputed: IDV404AXQ ----------

FLUXCORR PERFORM

FLUXCORR COMPLETE





End      13-Mar-2025 14:54:38 UTC

*** WF32D complete ***





End      13-Mar-2025 14:54:38 UTC

*** CALWF3 complete ***

CALWF3 completion for idv404axq_raw.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show list of cwd to verify calibrated files were made</span>
<span class="o">!</span>ls<span class="w"> </span>-ltr<span class="w"> </span>*.fits
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-rw-r--r-- 1 runner docker  34891200 Mar 13 14:48 idv404axq_raw.fits
-rw-r--r-- 1 runner docker 168079680 Mar 13 14:54 idv404axq_flt.fits
-rw-r--r-- 1 runner docker 168079680 Mar 13 14:54 idv404axq_flc.fits
</pre></div>
</div>
</div>
</div>
<p><a id="inspectflc"></a></p>
</section>
<section id="inspect-flc-image-header">
<h2>10. Inspect FLC Image Header<a class="headerlink" href="#inspect-flc-image-header" title="Permalink to this heading">#</a></h2>
<p>To verify that the data was calibrated with the v1.0 pixel-based CTE-correction, header keyword <code class="docutils literal notranslate"><span class="pre">CAL_VER</span></code> should be <code class="docutils literal notranslate"><span class="pre">3.5.2</span></code>,<br> <code class="docutils literal notranslate"><span class="pre">CTE_VER</span></code> should be <code class="docutils literal notranslate"><span class="pre">1.0</span></code>, and <code class="docutils literal notranslate"><span class="pre">CTE_NAME</span></code> should be <code class="docutils literal notranslate"><span class="pre">pixelCTE</span> <span class="pre">2012</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recollect and display FLC header keywords</span>
<span class="n">file</span><span class="p">,</span> <span class="n">pctetab</span><span class="p">,</span> <span class="n">drkcfile</span><span class="p">,</span> <span class="n">pctecorr</span><span class="p">,</span> <span class="n">calver</span><span class="p">,</span> <span class="n">ctename</span><span class="p">,</span> <span class="n">ctever</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*flc.fits&#39;</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">file</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span>
    <span class="n">pctetab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;pctetab&#39;</span><span class="p">])</span>
    <span class="n">drkcfile</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;drkcfile&#39;</span><span class="p">])</span>
    <span class="n">pctecorr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;pctecorr&#39;</span><span class="p">])</span>
    <span class="n">calver</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;cal_ver&#39;</span><span class="p">])</span>
    <span class="n">ctename</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;cte_name&#39;</span><span class="p">])</span>
    <span class="n">ctever</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;cte_ver&#39;</span><span class="p">])</span>

<span class="n">final_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">file</span><span class="p">,</span> <span class="n">pctetab</span><span class="p">,</span> <span class="n">drkcfile</span><span class="p">,</span> <span class="n">pctecorr</span><span class="p">,</span> <span class="n">calver</span><span class="p">,</span> <span class="n">ctename</span><span class="p">,</span> <span class="n">ctever</span><span class="p">],</span>
                    <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;pctetab&#39;</span><span class="p">,</span> <span class="s1">&#39;drkcfile&#39;</span><span class="p">,</span> <span class="s1">&#39;pctecorr&#39;</span><span class="p">,</span> <span class="s1">&#39;cal_ver&#39;</span><span class="p">,</span> <span class="s1">&#39;cte_name&#39;</span><span class="p">,</span> <span class="s1">&#39;cte_ver&#39;</span><span class="p">))</span>

<span class="n">final_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=1</i>
<table id="table140359360556176" class="table-striped table-bordered table-condensed">
<thead><tr><th>file</th><th>pctetab</th><th>drkcfile</th><th>pctecorr</th><th>cal_ver</th><th>cte_name</th><th>cte_ver</th></tr></thead>
<thead><tr><th>str18</th><th>str23</th><th>str23</th><th>str8</th><th>str19</th><th>str13</th><th>str3</th></tr></thead>
<tr><td>idv404axq_flc.fits</td><td>iref$zcv2057mi_cte.fits</td><td>iref$3961719li_dkc.fits</td><td>COMPLETE</td><td>3.7.2 (Apr-15-2024)</td><td>pixelCTE 2012</td><td>1.0</td></tr>
</table></div></div></div>
</div>
<p><a id="verdiffs"></a></p>
</section>
<section id="investigate-v1-0-and-v2-0-differences">
<h2>11. Investigate v1.0 and v2.0 Differences<a class="headerlink" href="#investigate-v1-0-and-v2-0-differences" title="Permalink to this heading">#</a></h2>
<p>Now that we have created a v1.0 CTE corrected image, lets compare it to the same image calibrated with the v2.0 correction.<br></p>
<p><a id="downloadv2.0"></a></p>
</section>
<section id="download-the-v2-0-flc-file">
<h2>11.1 Download the v2.0 FLC File<a class="headerlink" href="#download-the-v2-0-flc-file" title="Permalink to this heading">#</a></h2>
<p>First, we need to download the same FLC file from MAST that is corrected with the v2.0 pixel-based CTE correction so that we can <br> compare it to the v1.0 FLC file we just created in the notebook. In this step we rename the downloaded FLC to <code class="docutils literal notranslate"><span class="pre">idv404axq_v2.0_flc.fits</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the observation records</span>
<span class="n">obs_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;idv404axq*&#39;</span><span class="p">,</span> <span class="n">proposal_id</span><span class="o">=</span><span class="mi">15576</span><span class="p">)</span>

<span class="c1"># Get the listing of data products</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs_table</span><span class="p">)</span>

<span class="c1"># Filter the products for the RAW files</span>
<span class="n">filtered_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="s1">&#39;FLC&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="s1">&#39;CALWF3&#39;</span><span class="p">)</span>

<span class="c1"># Download all the images above</span>
<span class="n">download_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">filtered_products</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># For convenience move raws to cwd and remove empty download dir</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">download_table</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">]:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_v2.0_flc.fits&#39;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;mastDownload/HST/&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span>
        
<span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;mastDownload/HST/&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;mastDownload/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/idv404axq_flc.fits to ./mastDownload/HST/idv404axq/idv404axq_flc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<p><a id="openfiles"></a></p>
</section>
<section id="open-files">
<h2>11.2 Open Files<a class="headerlink" href="#open-files" title="Permalink to this heading">#</a></h2>
<p>In the cell below, we open each of the different files (FLT, v1.0 and v2.0 FLC) and create full-frame ~4Kx4K arrays. Additionally, <br> we multiply the science arrays by the <a class="reference external" href="https://www.stsci.edu/hst/instrumentation/wfc3/data-analysis/pixel-area-maps">pixel area maps</a>. Due to the geometric distortion  present in WFC3 images, these pixel <br> area maps are necessary to achieve uniformity in the measured counts of an object across the field. The pixel map simply <br> reflects the area of the pixels at the location of the source, and by multiplying the images by this field-dependent correction <br> factor, we will improve the accuracy of the photometry.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open data and set variables</span>
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;idv404axq_v2.0_flc.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
    <span class="n">v2_uvis1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">v2_uvis2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;idv404axq_flc.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
    <span class="n">v1_uvis1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">v1_uvis2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> 
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;idv404axq_flt.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
    <span class="n">flt_uvis1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">flt_uvis2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> 
    
<span class="c1"># Load pixel area maps </span>
<span class="n">PAM_uvis1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;example/UVIS1wfc3_map.fits&#39;</span><span class="p">)</span>
<span class="n">PAM_uvis2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;example/UVIS2wfc3_map.fits&#39;</span><span class="p">)</span>

<span class="c1"># Stich UVIS1 and 2 together and multiply by pixel area map</span>
<span class="n">v2sci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">v2_uvis2</span><span class="o">*</span><span class="n">PAM_uvis2</span><span class="p">,</span> <span class="n">v2_uvis1</span><span class="o">*</span><span class="n">PAM_uvis1</span><span class="p">])</span>
<span class="n">v1sci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">v1_uvis2</span><span class="o">*</span><span class="n">PAM_uvis2</span><span class="p">,</span> <span class="n">v1_uvis1</span><span class="o">*</span><span class="n">PAM_uvis1</span><span class="p">])</span>
<span class="n">fltsci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">flt_uvis2</span><span class="o">*</span><span class="n">PAM_uvis2</span><span class="p">,</span> <span class="n">flt_uvis1</span><span class="o">*</span><span class="n">PAM_uvis1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><a id="bkgsub"></a></p>
</section>
<section id="display-50x50-pixel-background-subsection">
<h2>11.3 Display 50x50 Pixel Background Subsection<a class="headerlink" href="#display-50x50-pixel-background-subsection" title="Permalink to this heading">#</a></h2>
<p>One of the differences between the v1.0 and v2.0 CTE correction is the background level. Here, we show a square 50x50 pixel <br> subsection that is mostly featureless, i.e. no known sources or cosmic ray hits. The v2.0 correction significantly reduces noise <br> amplification and improves the resulting background. To aid in the visual inspection of the background subsection, an animated <br> GIF is included in the notebook that blinks between the v1.0 and v2.0 FLC files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="c1"># Generate background subsections</span>
<span class="n">flt_bkg</span> <span class="o">=</span> <span class="n">fltsci</span><span class="p">[</span><span class="mi">2070</span><span class="p">:</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2180</span><span class="p">:</span><span class="mi">2230</span><span class="p">]</span>
<span class="n">v1_bkg</span> <span class="o">=</span> <span class="n">v1sci</span><span class="p">[</span><span class="mi">2070</span><span class="p">:</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2180</span><span class="p">:</span><span class="mi">2230</span><span class="p">]</span>
<span class="n">v2_bkg</span> <span class="o">=</span> <span class="n">v2sci</span><span class="p">[</span><span class="mi">2070</span><span class="p">:</span><span class="mi">2120</span><span class="p">,</span> <span class="mi">2180</span><span class="p">:</span><span class="mi">2230</span><span class="p">]</span>

<span class="c1"># Calculate min and max values for image scaling </span>
<span class="n">z</span> <span class="o">=</span> <span class="n">ZScaleInterval</span><span class="p">()</span>
<span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">get_limits</span><span class="p">(</span><span class="n">v1_bkg</span><span class="p">)</span>

<span class="c1"># Display background subsection</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flt_bkg</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">z1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">z2</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v1_bkg</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">z1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">z2</span><span class="p">)</span>
<span class="n">im3</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v2_bkg</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">z1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">z2</span><span class="p">)</span>

<span class="c1"># Formatting</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FLT File BKG Subsection&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;v1.0 PCTE FLC BKG Subsection&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;v2.0 PCTE FLC BKG Subsection&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">),</span> <span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/30926752cf92793191f4ceac775822ef80d13203323ff2a1869641f71ba1b7e9.png" src="../../../_images/30926752cf92793191f4ceac775822ef80d13203323ff2a1869641f71ba1b7e9.png" />
</div>
</div>
<div style="text-align: left"> <strong> <font size ="4">Animated GIF of the v1.0 and v2.0 FLC image subsections: </font> </strong> </div>
<a class="reference internal image-reference" href="../../../_images/v1_v2_bkg.gif"><img alt="An animated gif blinking between a subsection of background sky using the v1.0 and V2.0 pixel-based CTE corrections. The v2.0 background appears smoother with less noise and pixel variations." class="align-left" src="../../../_images/v1_v2_bkg.gif" style="width: 800px; height: 800px;" /></a>
<p><a id="bkgdist"></a></p>
</section>
<section id="pixel-distribution-of-background-subsections">
<h2>11.3.1 Pixel Distribution of Background Subsections<a class="headerlink" href="#pixel-distribution-of-background-subsections" title="Permalink to this heading">#</a></h2>
<p>To gain a more quantitative picture of how the background pixels are changing between the different file versions, we plot <br>the distribution of pixel values from the 50x50 pixel subsection above. The increased noise level in the v1.0 correction is <br> apparent in the blue histogram below. In addition, we have also computed the difference between the file types and have <br> plotted them as histograms. These two plots illustrates how the background in the v2.0 CTE corrected image is less noisy <br> and more in-line with the values seen in the FLT image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>

<span class="c1"># Plot background subsection histograms</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">flt_bkg</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FLT&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">v1_bkg</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v1.0 FLC&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">v2_bkg</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v2.0 FLC&#39;</span><span class="p">)</span>

<span class="c1"># Plot background subsection differential histograms</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">((</span><span class="n">v1_bkg</span><span class="o">-</span><span class="n">flt_bkg</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v1.0 FLC $-$ FLT&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">((</span><span class="n">v2_bkg</span><span class="o">-</span><span class="n">flt_bkg</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;limegreen&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v2.0 FLC $-$ FLT&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">((</span><span class="n">v1_bkg</span><span class="o">-</span><span class="n">v2_bkg</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v1.0 $-$ v2.0 FLC&#39;</span><span class="p">)</span>

<span class="c1"># Formatting</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Background Subsection Histogram&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Background Subsection Differential Histogram&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixel Value [e-]&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixel Value [e-]&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a15dc2c0d3ff0a2952227136e5c69eae52711be47fbc6fd7123a48a40e3358f3.png" src="../../../_images/a15dc2c0d3ff0a2952227136e5c69eae52711be47fbc6fd7123a48a40e3358f3.png" />
</div>
</div>
<p><a id="imgsub"></a></p>
</section>
<section id="display-image-subsection">
<h2>11.4 Display Image Subsection<a class="headerlink" href="#display-image-subsection" title="Permalink to this heading">#</a></h2>
<p>Another difference between the v1.0 and v2.0 pixel-based CTE model is the amount of correction applied to fainter sources. <br> In order to reduce noise amplification, the fluxes of faint sources only receive a limited amount of correction in the v2.0 version. <br> We again provide an animated GIF of the two subsections to aid with the visual comparison.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="c1"># Calculate min and max values for image scaling </span>
<span class="n">z</span> <span class="o">=</span> <span class="n">ZScaleInterval</span><span class="p">()</span>
<span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">get_limits</span><span class="p">(</span><span class="n">v1_uvis1</span><span class="p">)</span>

<span class="c1"># Display subsection</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v1_uvis1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">z1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">z2</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v2_uvis1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">z1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">z2</span><span class="p">)</span>

<span class="c1"># Formatting</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span> <span class="mi">325</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span> <span class="mi">325</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">149</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">149</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;v1.0 PCTE FLC UVIS1 Subsection&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;v2.0 PCTE FLC UVIS1 Subsection&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/3e754bdf33716d8fc275135363cfd798549cf30c176e865e69498de78fc30e2a.png" src="../../../_images/3e754bdf33716d8fc275135363cfd798549cf30c176e865e69498de78fc30e2a.png" />
</div>
</div>
<div style="text-align: left"> <strong> <font size ="4">Animated GIF of the v1.0 and v2.0 FLC image subsections: </font> </strong> </div>
<a class="reference internal image-reference" href="../../../_images/v1_v2_subsection.gif"><img alt="An animated GIF of the v1.0 and v2.0 FLC image subsections" class="align-left" src="../../../_images/v1_v2_subsection.gif" style="width: 975px;" /></a>
<p><a id="apphot"></a></p>
</section>
<section id="aperture-photometry">
<h2>11.5 Aperture Photometry<a class="headerlink" href="#aperture-photometry" title="Permalink to this heading">#</a></h2>
<p>To show the quantitative difference in the observed flux of sources between the v1.0 and v2.0 pixel-based CTE correction,<br> we perform aperture photometry on six stars of varying brightness within the image subsection above. Here, we display the <br> image subsection again with the apertures, annuli, and star labels overplotted. This subsection includes the first ~150 rows <br> of UVIS 1, which means all of these stars suffer the most CTE flux loss as they transfer 1900+ rows to the readout amplifier.</p>
<a class="reference internal image-reference" href="../../../_images/apphot_image.png"><img alt="Aperture photometry illustration" class="align-left" src="../../../_images/apphot_image.png" style="width: 900px;" /></a>
<p>First, we approximate the center x and y positions of the stars in the 4Kx4K science arrays, and create the apertures and <br> annuli using <code class="docutils literal notranslate"><span class="pre">photutils</span></code>. <br></p>
<p>Then, we use <code class="docutils literal notranslate"><span class="pre">photutils</span></code> to measure the signal in each area and subtract the background values in the annuli from the <br>aperture sum values. We define a function named <code class="docutils literal notranslate"><span class="pre">get_flux()</span></code> to do this for us.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_flux</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">aperture</span><span class="p">,</span> <span class="n">annulus_aperture</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to calculate background subtracted aperture sum </span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    data : float array</span>
<span class="sd">        The 2d array of science pixels being measured</span>
<span class="sd">    aperture : photutils obj</span>
<span class="sd">        A photutils aperture object with defined position and radius</span>
<span class="sd">    annulus_aperture : photutils obj</span>
<span class="sd">        A photutils circular annulus aperture object with defined position and radii</span>
<span class="sd">        </span>
<span class="sd">    Return:</span>
<span class="sd">    -------</span>
<span class="sd">    flux : float</span>
<span class="sd">        The measured background subtracted aperture sum </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Generate photutils.aperture_photometry table object</span>
    <span class="n">phot</span> <span class="o">=</span> <span class="n">aperture_photometry</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">aperture</span><span class="p">)</span>
    
    <span class="c1"># Measure background around sources. aperture_stats_tbl() comes from background_median.py</span>
    <span class="n">bkg_phot</span> <span class="o">=</span> <span class="n">aperture_stats_tbl</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">annulus_aperture</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">sigma_clip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Calculate background subtracted aperture sum</span>
    <span class="n">flux</span> <span class="o">=</span> <span class="n">phot</span><span class="p">[</span><span class="s1">&#39;aperture_sum&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">bkg_phot</span><span class="p">[</span><span class="s1">&#39;aperture_median&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">aperture</span><span class="o">.</span><span class="n">area</span>
    
    <span class="k">return</span> <span class="n">flux</span>


<span class="c1"># Approximate x,y pixel locations of each star in the 4Kx4K array</span>
<span class="n">positions</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">299.4</span><span class="p">,</span> <span class="mf">2135.6</span><span class="p">),</span>
             <span class="p">(</span><span class="mf">114.7</span><span class="p">,</span> <span class="mf">2093.4</span><span class="p">),</span>
             <span class="p">(</span><span class="mf">171.3</span><span class="p">,</span> <span class="mf">2074.9</span><span class="p">),</span>
             <span class="p">(</span><span class="mf">262.6</span><span class="p">,</span> <span class="mf">2164.9</span><span class="p">),</span>
             <span class="p">(</span><span class="mf">289.1</span><span class="p">,</span> <span class="mf">2085.6</span><span class="p">),</span>
             <span class="p">(</span><span class="mf">204.8</span><span class="p">,</span> <span class="mf">2073.1</span><span class="p">)]</span>

<span class="c1"># Photutils cirular aperture object with small radius</span>
<span class="n">aperture</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Photutils circular annulus aperture object </span>
<span class="n">annulus_aperture</span> <span class="o">=</span> <span class="n">CircularAnnulus</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r_in</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">r_out</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>

<span class="c1"># Call function to calculate flux of stars</span>
<span class="c1"># THE RUNTIME WARNING MAY BE IGNORED</span>
<span class="n">fltflux</span> <span class="o">=</span> <span class="n">get_flux</span><span class="p">(</span><span class="n">fltsci</span><span class="p">,</span> <span class="n">aperture</span><span class="p">,</span> <span class="n">annulus_aperture</span><span class="p">)</span>
<span class="n">v1flux</span> <span class="o">=</span> <span class="n">get_flux</span><span class="p">(</span><span class="n">v1sci</span><span class="p">,</span> <span class="n">aperture</span><span class="p">,</span> <span class="n">annulus_aperture</span><span class="p">)</span>
<span class="n">v2flux</span> <span class="o">=</span> <span class="n">get_flux</span><span class="p">(</span><span class="n">v2sci</span><span class="p">,</span> <span class="n">aperture</span><span class="p">,</span> <span class="n">annulus_aperture</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/hst_notebooks/hst_notebooks/notebooks/WFC3/calwf3_v1.0_cte/example/background_median.py:88: RuntimeWarning: invalid value encountered in divide
  values = cutout * mask.data / mask.data
/home/runner/work/hst_notebooks/hst_notebooks/notebooks/WFC3/calwf3_v1.0_cte/example/background_median.py:88: RuntimeWarning: invalid value encountered in divide
  values = cutout * mask.data / mask.data
/home/runner/work/hst_notebooks/hst_notebooks/notebooks/WFC3/calwf3_v1.0_cte/example/background_median.py:88: RuntimeWarning: invalid value encountered in divide
  values = cutout * mask.data / mask.data
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning" style="color:black" > <b> You can ignore the <code>RuntimeWarning: invalid value encountered in true_divide</code> message.</b> <br> </div>
<p>Finally, we plot our results.<br></p>
<p>The first plot below shows the measured flux of the six stars in each of the different calibrated products. Stars 1-6 are organized <br> by increasing flux, with Star 1 being the faintest and Star 6 being the brightest. The x-axis values correspond to the median flux <br> value measured in each of the three different files (FLT, v1.0, and v2.0) per star. The y-axis values show the individual flux values <br> for each star where the different colors and symbols represent the three file types. For example, the individual flux values (y-axis) <br> of Star 1 for the FLT, v1.0, and v2.0 files are ~2467, 3056, and 2799 e- respectively. The median of the three values is ~2799 e-, <br> which is the value plotted on the x-axis. The second plot illustrates the percent differences between the three different <br> flux values per star, and uses the same x-axis values as the first plot. <br></p>
<p>The FLT files have no CTE correction applied and thus have the lowest measured flux for each star due to the CTE flux loss. <br> Stars 1-4 have noticably different flux values between the v1.0 and v2.0 CTE corrections. In v1.0, the CTE algorithm is actually <br> over-correcting these fainter sources resulting in higher aperture photometry measurements. The flux values for stars 1-4 range <br> from  ~3000 - 10000 e- within a 3-pixel radius aperture. The flux values between the v1.0 and v2.0 CTE corrections for stars <br> 1-4 have percent differences of ~9 - 4%. Sources with more than ~10000 e- within a 3-pixel aperture (stars 5 &amp; 6) have more <br> compareable flux values between the v1.0 and v2.0 CTE corrections, and have percent differences less than 2%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Find median flux values between products</span>
<span class="n">medflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">([</span><span class="n">fltflux</span><span class="p">,</span> <span class="n">v1flux</span><span class="p">,</span> <span class="n">v2flux</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Scatter plot of measured flux</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">medflux</span><span class="p">,</span> <span class="n">fltflux</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FLT&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">medflux</span><span class="p">,</span> <span class="n">v1flux</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v1.0 FLC&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">medflux</span><span class="p">,</span> <span class="n">v2flux</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v2.0 FLC&#39;</span><span class="p">)</span>

<span class="c1"># Scatter plot of percentage difference</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">medflux</span><span class="p">,</span> <span class="nb">abs</span><span class="p">((</span><span class="n">fltflux</span><span class="o">-</span><span class="n">v1flux</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">fltflux</span><span class="o">+</span><span class="n">v1flux</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac{|FLT - v1.0|}{(FLT + v1.0) ÷ 2}$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">medflux</span><span class="p">,</span> <span class="nb">abs</span><span class="p">((</span><span class="n">fltflux</span><span class="o">-</span><span class="n">v2flux</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">fltflux</span><span class="o">+</span><span class="n">v2flux</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;limegreen&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac{|FLT - v2.0|}{(FLT + v2.0) ÷ 2}$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">medflux</span><span class="p">,</span> <span class="nb">abs</span><span class="p">((</span><span class="n">v1flux</span><span class="o">-</span><span class="n">v2flux</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">v1flux</span><span class="o">+</span><span class="n">v2flux</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\frac{|v1.0 - v2.0|}{(v1.0 + v2.0) ÷ 2}$&#39;</span><span class="p">)</span>

<span class="c1"># Formatting </span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Measured Flux Within 3-pix Radius Aperture&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Median Flux [e-]&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Flux [e-]&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Median Flux [e-]&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Percent Difference [%]&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">}),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fb8c31b5ccf2ed833fe4e5b6c4643c73f7850f5b2b4b603e15800a6149fc49e7.png" src="../../../_images/fb8c31b5ccf2ed833fe4e5b6c4643c73f7850f5b2b4b603e15800a6149fc49e7.png" />
</div>
</div>
<p><a id="conclude"></a></p>
</section>
<section id="conclusions">
<h2>12. Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this heading">#</a></h2>
<p>Thank you for walking through this notebook. You now have everything you need to process your own files with the v1.0 CTE <br>correction within <code class="docutils literal notranslate"><span class="pre">calwf3</span></code>. Since completing this notebook you should be more familiar with:</p>
<ul class="simple">
<li><p>Applying the v1.0 pixel-based CTE correction to 2009-2021 UVIS data.</p></li>
<li><p>Which header keywords of the <code class="docutils literal notranslate"><span class="pre">raw</span></code> fits file to edit in order to use the v1.0 correction.</p></li>
<li><p>How to find and download the appropriate <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code> and <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> reference files.</p></li>
<li><p>Verifying your version of <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> and calibrating a <code class="docutils literal notranslate"><span class="pre">raw</span></code> file with the v1.0 CTE correction.</p></li>
<li><p>Investigating the differences between v1.0 and v2.0 CTE corrected files.</p></li>
</ul>
<section id="congratulations-you-have-completed-the-notebook">
<h3>Congratulations, you have completed the notebook!<a class="headerlink" href="#congratulations-you-have-completed-the-notebook" title="Permalink to this heading">#</a></h3>
<p><a id="resources"></a></p>
</section>
</section>
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h2>
<p>Below are some additional resources that may be helpful. Please feel free to contact the <a class="reference external" href="https://stsci.service-now.com/hst">WFC3 Helpdesk</a> for any questions.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.stsci.edu/hst/instrumentation/wfc3/performance/cte">WFC3 CTE Website</a></p></li>
<li><p><a class="reference external" href="https://github.com/spacetelescope/hstcal">HSTCAL GitHub</a></p></li>
<li><p><a class="reference external" href="https://wfc3tools.readthedocs.io/en/latest/wfc3tools/calwf3.html">Calwf3 Documentation</a></p></li>
<li><p><a class="reference external" href="https://www.stsci.edu/hst/instrumentation/wfc3">WFC3 Website</a></p></li>
<li><p><a class="reference external" href="https://hst-docs.stsci.edu/wfc3ihb">WFC3 Instrument Handbook</a></p></li>
<li><p><a class="reference external" href="https://hst-docs.stsci.edu/wfc3dhb">WFC3 Data Handbook</a></p></li>
<li><p><a class="reference external" href="https://github.com/spacetelescope/hst_notebooks">STScI Jupyter-notebooks</a></p></li>
<li><p><a class="reference external" href="http://ssb.stsci.edu/astroconda">STScI Astroconda Channel</a></p></li>
</ul>
<p><a id="about"></a></p>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h2>
<p><strong>Author:</strong> Benjamin Kuhn; WFC3 Instrument Team <br>
<strong>Created:</strong> February 22, 2022 <br>
<strong>Last updated on:</strong> November 15, 2023</p>
<p><a id="cite"></a></p>
</section>
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Permalink to this heading">#</a></h2>
<p>If you use <code class="docutils literal notranslate"><span class="pre">astropy</span></code>, <code class="docutils literal notranslate"><span class="pre">astroquery</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">photutils</span></code>, or <code class="docutils literal notranslate"><span class="pre">scipy</span></code> for published research, please cite the authors.<br>
Follow these links for more information about citing the libraries below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.astropy.org/acknowledging.html">Citing <code class="docutils literal notranslate"><span class="pre">astropy</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/astropy/astroquery/blob/main/astroquery/CITATION">Citing <code class="docutils literal notranslate"><span class="pre">astroquery</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/users/project/citing.html">Citing <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></p></li>
<li><p><a class="reference external" href="https://numpy.org/citing-numpy/">Citing <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></p></li>
<li><p><a class="reference external" href="https://photutils.readthedocs.io/en/stable/getting_started/citation.html">Citing <code class="docutils literal notranslate"><span class="pre">photutils</span></code></a></p></li>
<li><p><a class="reference external" href="https://scipy.org/citing-scipy/">Citing <code class="docutils literal notranslate"><span class="pre">scipy</span></code></a>
<br></p></li>
</ul>
<hr class="docutils" />
<p><span class="xref myst">Top of Page</span>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/WFC3/calwf3_v1.0_cte"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../exception_report/wfc3_exception_report.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exception Report Checklist - WFC3</p>
      </div>
    </a>
    <a class="right-next"
       href="../persistence/wfc3_ir_persistence.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Masking Persistence in WFC3/IR Images</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">1. Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-archived-drkcfiles-txt-is-in-cwd">2. Verify <code class="docutils literal notranslate"><span class="pre">archived_drkcfiles.txt</span></code> is in CWD</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-that-calwf3-version-is-v3-5-2">3. Check that <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Version is <code class="docutils literal notranslate"><span class="pre">v3.5.2</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#query-mast-and-download-a-wfc3-raw-fits-image">4. Query MAST and Download a WFC3 <code class="docutils literal notranslate"><span class="pre">raw.fits</span></code> Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-crds-environment-variable-and-download-reference-files">5. Set CRDS Environment Variable and Download Reference Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-crds-bestrefs">5.1 Run <code class="docutils literal notranslate"><span class="pre">crds</span> <span class="pre">bestrefs</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-image-header">5.2 Inspect Image Header</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-correct-v1-0-drkcfile">6. Find the Correct v1.0 <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-correct-drkcfile-from-crds">6.1 Download the Correct <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code> from CRDS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modify-the-image-header-keyword-drkcfile">6.2 Modify the Image Header Keyword, <code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-v1-0-pctetab">7. Download the v1.0 <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modify-the-image-header-keyword-pctetab">7.1 Modify the Image Header Keyword, <code class="docutils literal notranslate"><span class="pre">PCTETAB</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#re-inspect-image-header">8. Re-Inspect Image Header</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-calwf3">9. Run <code class="docutils literal notranslate"><span class="pre">calwf3</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-flc-image-header">10. Inspect FLC Image Header</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#investigate-v1-0-and-v2-0-differences">11. Investigate v1.0 and v2.0 Differences</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-v2-0-flc-file">11.1 Download the v2.0 FLC File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-files">11.2 Open Files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-50x50-pixel-background-subsection">11.3 Display 50x50 Pixel Background Subsection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-distribution-of-background-subsections">11.3.1 Pixel Distribution of Background Subsections</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-image-subsection">11.4 Display Image Subsection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aperture-photometry">11.5 Aperture Photometry</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">12. Conclusions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#congratulations-you-have-completed-the-notebook">Congratulations, you have completed the notebook!</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>