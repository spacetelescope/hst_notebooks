
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sky Matching for HST Mosaics &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css?v=cd6c26fb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"0e069df617fd4536b5f818551715ba9b": {"model_module": "ipydatagrid", "model_module_version": "^1.4.0", "model_name": "VegaExprModel", "state": {"_model_module": "ipydatagrid", "_model_module_version": "^1.4.0", "_model_name": "VegaExprModel", "_view_count": null, "_view_module": "ipydatagrid", "_view_module_version": "^1.4.0", "_view_name": "VegaExprView", "value": "default_value"}}, "1f71034b17724676af94ef2246d59fd1": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3292bd0ccb724eb2b1f38df1bc281f50": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "36cdc7b958014693896d7f311a2505a1": {"model_module": "ipydatagrid", "model_module_version": "^1.4.0", "model_name": "TextRendererModel", "state": {"_model_module": "ipydatagrid", "_model_module_version": "^1.4.0", "_model_name": "TextRendererModel", "_view_count": null, "_view_module": "ipydatagrid", "_view_module_version": "^1.4.0", "_view_name": "TextRendererView", "background_color": "IPY_MODEL_976c391c0ba24addba2e7b266127acd3", "font": "12px sans-serif", "format": null, "format_type": "number", "horizontal_alignment": "left", "missing": "", "text_color": "IPY_MODEL_a240d0e46f804d339f0547a14f11ae2e", "text_elide_direction": "right", "text_value": null, "text_wrap": false, "vertical_alignment": "center"}}, "3c9fa176385d47edbd2491d552f1a85b": {"buffers": [{"data": "AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAAAARAAAA", "encoding": "base64", "path": ["_data", "data", "key", "value"]}, {"data": "chjMX4H3hUByGMxfgfeFQHIYzF+B94VAchjMX4H3hUByGMxfgfeFQHIYzF+B94VAchjMX4H3hUByGMxfgfeFQHIYzF+B94VAchjMX4H3hUByGMxfgfeFQHIYzF+B94VAchjMX4H3hUByGMxfgfeFQHIYzF+B94VAchjMX4H3hUByGMxfgfeFQHIYzF+B94VA", "encoding": "base64", "path": ["_data", "data", "EXPTIME", "value"]}, {"data": "MmadBElQVUAyZp0ESVBVQDJmnQRJUFVAMmadBElQVUAyZp0ESVBVQDJmnQRJUFVAMmadBElQVUAyZp0ESVBVQDJmnQRJUFVAMmadBElQVUAyZp0ESVBVQDJmnQRJUFVAMmadBElQVUAyZp0ESVBVQDJmnQRJUFVAMmadBElQVUAyZp0ESVBVQDJmnQRJUFVA", "encoding": "base64", "path": ["_data", "data", "RA_TARG", "value"]}, {"data": "ivr0Ab2fA8CK+vQBvZ8DwIr69AG9nwPAivr0Ab2fA8CK+vQBvZ8DwIr69AG9nwPAivr0Ab2fA8CK+vQBvZ8DwIr69AG9nwPAivr0Ab2fA8CK+vQBvZ8DwIr69AG9nwPAivr0Ab2fA8CK+vQBvZ8DwIr69AG9nwPAivr0Ab2fA8CK+vQBvZ8DwIr69AG9nwPA", "encoding": "base64", "path": ["_data", "data", "DEC_TARG", "value"]}, {"data": "IuF7f4PvXsAi4Xt/g+9ewAAAAAAAAAAAAAAAAAAAAAAi4Xt/g+9eQCLhe3+D715AIuF7f4PvXsAi4Xt/g+9ewAAAAAAAAAAAAAAAAAAAAAAi4Xt/g+9eQCLhe3+D715AIuF7f4PvXsAi4Xt/g+9ewAAAAAAAAAAAAAAAAAAAAAAi4Xt/g+9eQCLhe3+D715A", "encoding": "base64", "path": ["_data", "data", "POSTARG1", "value"]}, {"data": "hLpIoSxHXMBwJxHhX3pawIS6SKEsR1zAcCcR4V96WsCEukihLEdcwHAnEeFfelrAzczMzMzMDMDNzMzMzMwMQM3MzMzMzAzAzczMzMzMDEDNzMzMzMwMwM3MzMzMzAxAcCcR4V96WkCEukihLEdcQHAnEeFfelpAhLpIoSxHXEBwJxHhX3paQIS6SKEsR1xA", "encoding": "base64", "path": ["_data", "data", "POSTARG2", "value"]}, {"data": "jWE9ZtVTZUDR/wef31NlQGKtBxc11WRAx8WQxiHVZEDPdjiiodRkQH9Ci42d1GRA7WXAg8u0ZEDiGjlA/rRkQAbUB5ab1WRAZ8v+SJPVZEDiBdr11tRkQGYgFAPT1GRA1MygoqZUZEAmdfp1qVRkQCPjo3uY1GRAT694DYvUZEAFgVVquNRkQHQIFBuq1GRA", "encoding": "base64", "path": ["_data", "data", "ORIENTAT", "value"]}, {"data": "AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAAAARAAAA", "encoding": "base64", "path": ["_data", "data", "ipydguuid", "value"]}], "model_module": "ipydatagrid", "model_module_version": "^1.4.0", "model_name": "DataGridModel", "state": {"_data": {"data": {"ASN_ID": ["IBXL50030", "IBXL50030", "IBXL51030", "IBXL51030", "IBXL52030", "IBXL52030", "IBXL53030", "IBXL53030", "IBXL54030", "IBXL54030", "IBXL55030", "IBXL55030", "IBXL56030", "IBXL56030", "IBXL57030", "IBXL57030", "IBXL58030", "IBXL58030"], "DATE-OBS": ["2012-11-03", "2012-11-03", "2012-10-22", "2012-10-22", "2012-10-23", "2012-10-23", "2012-10-23", "2012-10-24", "2012-10-26", "2012-10-26", "2012-10-27", "2012-10-27", "2012-10-27", "2012-10-28", "2012-11-05", "2012-11-05", "2012-11-07", "2012-11-07"], "DEC_TARG": {"dtype": "float64", "shape": [18], "type": null}, "DETECTOR": ["IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR"], "EXPTIME": {"dtype": "float64", "shape": [18], "type": null}, "FILTER": ["F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W", "F160W"], "ORIENTAT": {"dtype": "float64", "shape": [18], "type": null}, "POSTARG1": {"dtype": "float64", "shape": [18], "type": null}, "POSTARG2": {"dtype": "float64", "shape": [18], "type": null}, "RA_TARG": {"dtype": "float64", "shape": [18], "type": null}, "ROOTNAME": ["ibxl50clq", "ibxl50cqq", "ibxl51eoq", "ibxl51etq", "ibxl52k0q", "ibxl52k5q", "ibxl53kxq", "ibxl53l9q", "ibxl54bgq", "ibxl54blq", "ibxl55f0q", "ibxl55f5q", "ibxl56huq", "ibxl56i2q", "ibxl57adq", "ibxl57aiq", "ibxl58sqq", "ibxl58svq"], "TARGNAME": ["HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY", "HORSEHEAD-COPY"], "ipydguuid": {"dtype": "int32", "shape": [18], "type": null}, "key": {"dtype": "int32", "shape": [18], "type": null}}, "fields": [{"key": "$NaN$"}, {"ROOTNAME": "$NaN$"}, {"ASN_ID": "$NaN$"}, {"TARGNAME": "$NaN$"}, {"DETECTOR": "$NaN$"}, {"FILTER": "$NaN$"}, {"EXPTIME": "$NaN$"}, {"RA_TARG": "$NaN$"}, {"DEC_TARG": "$NaN$"}, {"POSTARG1": "$NaN$"}, {"POSTARG2": "$NaN$"}, {"DATE-OBS": "$NaN$"}, {"ORIENTAT": "$NaN$"}, {"ipydguuid": "$NaN$"}], "schema": {"fields": [{"name": "key", "type": "integer"}, {"name": "ROOTNAME", "type": "string"}, {"name": "ASN_ID", "type": "string"}, {"name": "TARGNAME", "type": "string"}, {"name": "DETECTOR", "type": "string"}, {"name": "FILTER", "type": "string"}, {"name": "EXPTIME", "type": "number"}, {"name": "RA_TARG", "type": "number"}, {"name": "DEC_TARG", "type": "number"}, {"name": "POSTARG1", "type": "number"}, {"name": "POSTARG2", "type": "number"}, {"name": "DATE-OBS", "type": "string"}, {"name": "ORIENTAT", "type": "number"}, {"name": "ipydguuid", "type": "integer"}], "pandas_version": "1.4.0", "primaryKey": ["key", "ipydguuid"], "primaryKeyUuid": "ipydguuid"}}, "_dom_classes": [], "_model_module": "ipydatagrid", "_model_module_version": "^1.4.0", "_model_name": "DataGridModel", "_transforms": [], "_view_count": null, "_view_module": "ipydatagrid", "_view_module_version": "^1.4.0", "_view_name": "DataGridView", "_visible_rows": [], "auto_fit_columns": false, "auto_fit_params": {"area": "all", "numCols": null, "padding": 30}, "base_column_header_size": 20, "base_column_size": 64, "base_row_header_size": 64, "base_row_size": 20, "column_widths": {}, "corner_renderer": null, "default_renderer": "IPY_MODEL_36cdc7b958014693896d7f311a2505a1", "editable": false, "grid_style": {}, "header_renderer": null, "header_visibility": "all", "horizontal_stripes": false, "layout": "IPY_MODEL_1f71034b17724676af94ef2246d59fd1", "renderers": {}, "selection_mode": "none", "selections": [], "tabbable": null, "tooltip": null, "vertical_stripes": false}}, "7df980d463d5435388ea4af52e8ce2f5": {"buffers": [{"data": "AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAA", "encoding": "base64", "path": ["_data", "data", "key", "value"]}, {"data": "EgAAAB8AAAAUAAAADAAAAA4AAAATAAAAEgAAAAwAAAAPAAAA", "encoding": "base64", "path": ["_data", "data", "NMATCHES", "value"]}, {"data": "ZmZmZmamUEDNzMzMzGxSQAAAAAAAQE1AzczMzMzMS0AzMzMzMzNSQAAAAAAAwE9AMzMzMzPzTkAzMzMzMzMXQAAAAAAAACdA", "encoding": "base64", "path": ["_data", "data", "RMS_RA", "value"]}, {"data": "AAAAAABASkAzMzMzM5NVQGZmZmZmhlBAMzMzMzPzUkAAAAAAAABWQJqZmZmZuVVAmpmZmZlZV0AAAAAAAAAaQDMzMzMzMxtA", "encoding": "base64", "path": ["_data", "data", "RMS_DEC", "value"]}, {"data": "pHA9Ctej4D89CtejcD3iP3E9CtejcN0/hetRuB6F2z89CtejcD3iP1yPwvUoXN8/uB6F61G43j+amZmZmZmpPwrXo3A9Crc/", "encoding": "base64", "path": ["_data", "data", "RMS_RA_pix", "value"]}, {"data": "PQrXo3A92j9xPQrXo3DlP1K4HoXrUeA/4XoUrkfh4j8UrkfhehTmP8P1KFyPwuU/XI/C9Shc5z+amZmZmZmpP5qZmZmZmak/", "encoding": "base64", "path": ["_data", "data", "RMS_DEC_pix", "value"]}, {"data": "AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAA", "encoding": "base64", "path": ["_data", "data", "ipydguuid", "value"]}], "model_module": "ipydatagrid", "model_module_version": "^1.4.0", "model_name": "DataGridModel", "state": {"_data": {"data": {"DETECTOR": ["IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR", "IR"], "FILENAME": ["ibxl50030_drz.fits", "ibxl51030_drz.fits", "ibxl52030_drz.fits", "ibxl53030_drz.fits", "ibxl54030_drz.fits", "ibxl55030_drz.fits", "ibxl56030_drz.fits", "ibxl57030_drz.fits", "ibxl58030_drz.fits"], "NMATCHES": {"dtype": "int32", "shape": [9], "type": null}, "RMS_DEC": {"dtype": "float64", "shape": [9], "type": null}, "RMS_DEC_pix": {"dtype": "float64", "shape": [9], "type": null}, "RMS_RA": {"dtype": "float64", "shape": [9], "type": null}, "RMS_RA_pix": {"dtype": "float64", "shape": [9], "type": null}, "WCSNAME": ["IDC_w3m18525i-FIT_REL_GSC242", "IDC_w3m18525i-FIT_REL_GSC242", "IDC_w3m18525i-FIT_IMG_GSC242", "IDC_w3m18525i-FIT_REL_GSC242", "IDC_w3m18525i-FIT_REL_GSC242", "IDC_w3m18525i-FIT_REL_GSC242", "IDC_w3m18525i-FIT_REL_GSC242", "IDC_w3m18525i-FIT_REL_GAIAeDR3", "IDC_w3m18525i-FIT_REL_GAIAeDR3"], "ipydguuid": {"dtype": "int32", "shape": [9], "type": null}, "key": {"dtype": "int32", "shape": [9], "type": null}}, "fields": [{"key": "$NaN$"}, {"FILENAME": "$NaN$"}, {"DETECTOR": "$NaN$"}, {"WCSNAME": "$NaN$"}, {"NMATCHES": "$NaN$"}, {"RMS_RA": "$NaN$"}, {"RMS_DEC": "$NaN$"}, {"RMS_RA_pix": "$NaN$"}, {"RMS_DEC_pix": "$NaN$"}, {"ipydguuid": "$NaN$"}], "schema": {"fields": [{"name": "key", "type": "integer"}, {"name": "FILENAME", "type": "string"}, {"name": "DETECTOR", "type": "string"}, {"name": "WCSNAME", "type": "string"}, {"name": "NMATCHES", "type": "integer"}, {"name": "RMS_RA", "type": "number"}, {"name": "RMS_DEC", "type": "number"}, {"name": "RMS_RA_pix", "type": "number"}, {"name": "RMS_DEC_pix", "type": "number"}, {"name": "ipydguuid", "type": "integer"}], "pandas_version": "1.4.0", "primaryKey": ["key", "ipydguuid"], "primaryKeyUuid": "ipydguuid"}}, "_dom_classes": [], "_model_module": "ipydatagrid", "_model_module_version": "^1.4.0", "_model_name": "DataGridModel", "_transforms": [], "_view_count": null, "_view_module": "ipydatagrid", "_view_module_version": "^1.4.0", "_view_name": "DataGridView", "_visible_rows": [], "auto_fit_columns": false, "auto_fit_params": {"area": "all", "numCols": null, "padding": 30}, "base_column_header_size": 20, "base_column_size": 64, "base_row_header_size": 64, "base_row_size": 20, "column_widths": {}, "corner_renderer": null, "default_renderer": "IPY_MODEL_ee3bc352b74f4c8caf85280864e497ed", "editable": false, "grid_style": {}, "header_renderer": null, "header_visibility": "all", "horizontal_stripes": false, "layout": "IPY_MODEL_3292bd0ccb724eb2b1f38df1bc281f50", "renderers": {}, "selection_mode": "none", "selections": [], "tabbable": null, "tooltip": null, "vertical_stripes": false}}, "976c391c0ba24addba2e7b266127acd3": {"model_module": "ipydatagrid", "model_module_version": "^1.4.0", "model_name": "VegaExprModel", "state": {"_model_module": "ipydatagrid", "_model_module_version": "^1.4.0", "_model_name": "VegaExprModel", "_view_count": null, "_view_module": "ipydatagrid", "_view_module_version": "^1.4.0", "_view_name": "VegaExprView", "value": "default_value"}}, "a240d0e46f804d339f0547a14f11ae2e": {"model_module": "ipydatagrid", "model_module_version": "^1.4.0", "model_name": "VegaExprModel", "state": {"_model_module": "ipydatagrid", "_model_module_version": "^1.4.0", "_model_name": "VegaExprModel", "_view_count": null, "_view_module": "ipydatagrid", "_view_module_version": "^1.4.0", "_view_name": "VegaExprView", "value": "default_value"}}, "d20f768a776d48f087d1cd3584278c3e": {"model_module": "ipydatagrid", "model_module_version": "^1.4.0", "model_name": "VegaExprModel", "state": {"_model_module": "ipydatagrid", "_model_module_version": "^1.4.0", "_model_name": "VegaExprModel", "_view_count": null, "_view_module": "ipydatagrid", "_view_module_version": "^1.4.0", "_view_name": "VegaExprView", "value": "default_value"}}, "ee3bc352b74f4c8caf85280864e497ed": {"model_module": "ipydatagrid", "model_module_version": "^1.4.0", "model_name": "TextRendererModel", "state": {"_model_module": "ipydatagrid", "_model_module_version": "^1.4.0", "_model_name": "TextRendererModel", "_view_count": null, "_view_module": "ipydatagrid", "_view_module_version": "^1.4.0", "_view_name": "TextRendererView", "background_color": "IPY_MODEL_0e069df617fd4536b5f818551715ba9b", "font": "12px sans-serif", "format": null, "format_type": "number", "horizontal_alignment": "left", "missing": "", "text_color": "IPY_MODEL_d20f768a776d48f087d1cd3584278c3e", "text_elide_direction": "right", "text_value": null, "text_wrap": false, "vertical_alignment": "center"}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/DrizzlePac/sky_matching/sky_matching';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Satellite Trail Masking Techniques" href="../mask_satellite/mask_satellite.html" />
    <link rel="prev" title="Aligning HST Mosaics" href="../align_mosaics/align_mosaics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="HST Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="HST Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI HST Notebook Repository HQ
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ACS/README.html">ACS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_cte_forward_model/acs_cte_forward_model_example.html">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_pixel_area_maps/acs_pixel_area_maps.html">ACS Pixel Area Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_focus_diverse_epsfs/acs_focus_diverse_epsfs.html">Focus Diverse ePSFs for ACS/WFC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_exception_report/exception_report_checks.html">HST Exception Report - Investigate your ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/hst_orbits_ephem/hst_orbits_ephem.html">Getting HST Ephemeris and Related Data for an Observation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/ExceptionReport/ExceptionReport.html">What to do when you get an Exception Report for COS</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">DrizzlePac Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Improving Astrometry Using Alternate WCS Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../align_to_catalogs/align_to_catalogs.html">Aligning HST images to an Absolute Reference Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use_ds9_regions_in_tweakreg/use_ds9_regions_in_tweakreg.html">TWEAKREG Tips - Using DS9 Regions for Source Inclusion/Exclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimize_image_sampling/optimize_image_sampling.html">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../align_mosaics/align_mosaics.html">Aligning HST Mosaics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Sky Matching for HST Mosaics <a id="top"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drizzle_wfpc2/drizzle_wfpc2.html">Drizzling new WFPC2 FLT data products with chip-normalization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HASP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../HASP/Setup/Setup.html">Installing the Hubble Advanced Spectral Products Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HASP/CoaddTutorial/CoaddTutorial.html">Inputting User Data using the Hubble Advanced Spectral Products Script</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../HASP/FluxScaleTutorial/FluxScaleTutorial.html">Scaling Flux while using the Hubble Advanced Spectral Products Script</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../HASP/DataDiagnostic/DataDiagnostics.html">HASP Data Diagnostic Notebook</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../HASP/WavelengthAdjustment/WavelengthAdjustment.html">Wavelength Adjustments for Running the Hubble Advanced Spectral Products (HASP) Script</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../HASP/COSLifetimePositions/COSLifetimePositions.html">Combining COS Data from Multiple Lifetime Positions and Central Wavelengths</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../STIS/README.html">STIS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/cross-correlation/cross-correlation.html">Correcting for Missing Wavecals with Cross-Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/custom_ccd_darks/custom_ccd_darks.html">Custom CCD Darks <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/drizpac_notebook/STIS_DrizzlePac_Tutorial.html">STIS DrizzlePac Tutorial <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.html">STIS Coronagraphy Visualization Tool (v2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/calstis/calstis_2d_ccd.html">Calstis 2-D CCD Data Reduction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/target_acquisition/target_acquisition.html">Evaluating STIS Target Acquisitions <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/view_data/view_data.html">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/low_count_uncertainties/Low_Count_Uncertainties.html">Low Count Uncertainties in STIS <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/contrast_sensitivity/STIS_Coronagraphic_Observation_Feasibility.html">STIS Coronagraphic Observation Feasibility</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">WFC3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/README.html">WFC3 Notebooks</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../WFC3/general_tools.html">General Tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/image_displayer_analyzer/wfc3_image_displayer_analyzer.html">WFC3 Image Displayer &amp; Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/exception_report/wfc3_exception_report.html">Exception Report Checklist - WFC3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.html">Processing WFC3/UVIS Data with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Using the v1.0 CTE-Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/persistence/wfc3_ir_persistence.html">Masking Persistence in WFC3/IR Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/uvis_g280_transit/G280_Exoplanet_Transits.html">Analyzing WFC3/UVIS G280 Exoplanet Transit Observations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../WFC3/ir_tvb.html">WFC3/IR Time Variable Background (TVB)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/ir_ima_visualization/IR_IMA_Visualization_with_an_Example_of_Time_Variable_Background.html">WFC3/IR IMA Visualization Tools with An Example of Time Variable Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/calwf3_recalibration/calwf3_recal_tvb.html">Manual Recalibration with calwf3: Turning off the IR Linear Ramp Fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/tvb_flattenramp/TVB_flattenramp_notebook.html">Correcting for Helium Line Emission Background in IR Exposures using the “Flatten-Ramp” Technique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/ir_scattered_light_calwf3_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_Using_calwf3_to_Mask_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Using <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> to Mask Bad Reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/ir_scattered_light_manual_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_by_Manually_Subtracting_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Manually Subtracting Bad Reads</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../WFC3/photometry.html">Photometry</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/filter_transformations/filter_transformations.html">WFC3/UVIS Filter Transformations with stsynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/flux_conversion_tool/flux_conversion_tool.html">Flux Unit Conversions with synphot and stsynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/photometry_examples/phot_examples.html">Synthetic Photometry Examples for WFC3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/uvis_time_dependent_photometry/uvis_timedep_phot.html">WFC3/UVIS Time-dependent Photometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/zeropoints/zeropoints.html">Calculating WFC3 Zeropoints with STSynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/uvis_pam_corrections/WFC3_UVIS_Pixel_Area_Map_Corrections_for_Subarrays.html">WFC3/UVIS Pixel Area Map Corrections for Subarrays</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../WFC3/point_spread_function.html">Point Spread Function (PSF)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/point_spread_function/hst_point_spread_function.html">HST WFC3 Point Spread Function Modeling   </a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/mast_api_psf/download_psf_cutouts.html">Downloading WFC3 and WFPC2 PSF Cutouts from MAST</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/DrizzlePac/sky_matching/sky_matching.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/DrizzlePac/sky_matching/sky_matching.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/DrizzlePac/sky_matching/sky_matching.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sky Matching for HST Mosaics <a id="top"></a></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction <a id="intro"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-observations-with-astroquery">1. Download the Observations with <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> <a id="download"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-image-header-data">1.1 Check image header data <a id="check_keywords"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-alignment">1.2 Inspect the Alignment <a id="check_wcs"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#align-the-visit-level-drizzled-data-with-tweakreg">2. Align the visit-level drizzled data with <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> <a id="align"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-catalog-of-gaia-dr3-sources">2.1 Create a catalog of Gaia DR3 sources  <a id="cat"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-catalog-of-gaia-dr3-sources-with-proper-motion-data">2.2 Create a catalog of Gaia DR3 sources with Proper Motion Data  <a id="cat_pm"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-tweakreg">2.3 Run <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> <a id="tweak"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-shift-file-and-fit-quality">2.4 Inspect the shift file and fit quality <a id="fit_quality"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overplot-matched-sources-and-inspect-fit-residuals">2.5 Overplot matched sources and inspect fit residuals <a id="overplot"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rerun-tweakreg-and-update-the-header-wcs">2.6 Rerun <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> and update the header WCS <a id="updatehdr"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-tweakback-to-propogate-the-wcs-to-the-flt-files">2.7 Run <code class="docutils literal notranslate"><span class="pre">TweakBack</span></code> to propogate the WCS to the FLT files <a id="tweakback"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-skymethod-options-in-astrodrizzle">3. Compare  <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> options in AstroDrizzle <a id="compare"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skymethod-localmin">3.1 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'localmin'</span></code> <a id="localmin"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skymethod-match">3.2 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'match'</span></code> <a id="match"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skymethod-globalmin-match">3.3 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'globalmin+match'</span></code> <a id="globalminmatch"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skymethod-globalmin">3.4 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'globalmin'</span></code> <a id="globalmin"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-mdrizsky-values-for-each-method">4. Compare the MDRIZSKY values for each method <a id="mdrizsky"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-sky-matched-science-mosaic-and-weight-image">5. Display the ‘sky matched’ science mosaic and weight image <a id="display"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">6. Conclusion <a id="conclusion"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources <a id="resources"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook <a id="about"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations <a id="citations"></a></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="STScI Logo" src="../../../_images/stsci_header.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="sky-matching-for-hst-mosaics">
<h1>Sky Matching for HST Mosaics <a id="top"></a><a class="headerlink" href="#sky-matching-for-hst-mosaics" title="Link to this heading">#</a></h1>
<hr>
<div class="alert alert-block alert-warning" style="color:black" > <b> This notebook assumes you have created and activated a virtual environment using the requirements file in this notebook's repository. Please make sure you have read the contents of the README file before continuing the notebook. Note that the GIF file "sky_matching_comparison.gif" is one of the downloads needed for this notebook: </b>  </div><section id="learning-goals">
<h2>Learning Goals:<a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<p>In this tutorial we explore different options for handling the background sky with <a class="reference external" href="https://drizzlepac.readthedocs.io/en/latest/drizzlepac_api/astrodrizzle.html"><code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code></a>. <br>
By the end of this notebook you will:<br>
    • Download data with <a class="reference external" href="https://astroquery.readthedocs.io/en/latest/index.html"><code class="docutils literal notranslate"><span class="pre">astroquery</span></code></a><br>
    • Align data with <a class="reference external" href="https://drizzlepac.readthedocs.io/en/latest/user_reprocessing/tweakreg_api.html"><code class="docutils literal notranslate"><span class="pre">TweakReg</span></code></a><br>
    • Compare background sky options using the <a class="reference external" href="https://drizzlepac.readthedocs.io/en/latest/drizzlepac_api/astrodrizzle.html"><code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code></a> parameter <code class="docutils literal notranslate"><span class="pre">skymethod</span></code></p>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="#intro"><span class="xref myst">Introduction</span></a> <br></p>
<p><a class="reference internal" href="#download"><span class="xref myst">1. Download the Observations with <code class="docutils literal notranslate"><span class="pre">astroquery</span></code></span></a> <br>
    <a class="reference internal" href="#check_keywords"><span class="xref myst">1.1 Check image header data</span></a> <br>
    <a class="reference internal" href="#check_wcs"><span class="xref myst">1.2 Inspect the alignment</span></a> <br>
<a class="reference internal" href="#align"><span class="xref myst">2. Align the visit-level drizzled data with <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code></span></a> <br>
    <a class="reference internal" href="#cat"><span class="xref myst">2.1 Create a catalog of Gaia DR3 sources</span></a> <br>
    <a class="reference internal" href="#cat_pm"><span class="xref myst">2.2 Create a catalog of Gaia DR3 sources with Proper Motion Data</span></a> <br>
    <a class="reference internal" href="#tweak"><span class="xref myst">2.3 Run <code class="docutils literal notranslate"><span class="pre">Tweakreg</span></code></span></a> <br>
    <a class="reference internal" href="#fit_quality"><span class="xref myst">2.4 Inspect the shift file and fit quality</span></a> <br>
    <a class="reference internal" href="#overplot"><span class="xref myst">2.5 Overplot matched sources and inspect fit residuals</span></a> <br>
    <a class="reference internal" href="#updatehdr"><span class="xref myst">2.6 Rerun <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> and update the header WCS</span></a> <br>
    <a class="reference internal" href="#tweakback"><span class="xref myst">2.7 Run <code class="docutils literal notranslate"><span class="pre">TweakBack</span></code> to propogate the WCS to the FLT files</span></a> <br>
<a class="reference internal" href="#compare"><span class="xref myst">3. Compare <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> options in <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code></span></a> <br>
    <a class="reference internal" href="#localmin"><span class="xref myst">3.1 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'localmin'</span></code></span></a> <br>
    <a class="reference internal" href="#match"><span class="xref myst">3.2 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'match'</span></code></span></a> <br>
    <a class="reference internal" href="#globalminmatch"><span class="xref myst">3.3 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'globalmin+match'</span></code></span></a> <br>
    <a class="reference internal" href="#globalmin"><span class="xref myst">3.4 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'globalmin'</span></code></span></a> <br>
<a class="reference internal" href="#mdrizsky"><span class="xref myst">4. Compare the MDRIZSKY values for each method</span></a> <br>
<a class="reference internal" href="#display"><span class="xref myst">5. Display the ‘sky matched’ science mosaic and weight image</span></a> <br>
<a class="reference internal" href="#conclusion"><span class="xref myst">6. Conclusion</span></a> <br></p>
<p><a class="reference internal" href="#resources"><span class="xref myst">Additional Resources</span></a> <br>
<a class="reference internal" href="#about"><span class="xref myst">About this notebook</span></a> <br>
<a class="reference internal" href="#citations"><span class="xref myst">Citations</span></a></p>
</section>
<section id="introduction">
<h2>Introduction <a id="intro"></a><a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>When creating an image mosaic, <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> has the ability to compute the sky and then either subtract or equalize the background in input images. Users may select the algorithm used for the sky subtraction via the <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> parameter.</p>
<p>There are four methods available in sky matching: <code class="docutils literal notranslate"><span class="pre">localmin</span></code>, <code class="docutils literal notranslate"><span class="pre">match</span></code>, <code class="docutils literal notranslate"><span class="pre">globalmin</span></code>, and <code class="docutils literal notranslate"><span class="pre">globalmin+match</span></code>.</p>
<p>By applying <code class="docutils literal notranslate"><span class="pre">drizzlepac.sky.sky()</span></code>, or using the <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> parameter in the call to <code class="docutils literal notranslate"><span class="pre">drizzlepac.astrodrizzle.AstroDrizzle()</span></code>, AstroDrizzle will update the keyword <code class="docutils literal notranslate"><span class="pre">MDRIZSKY</span></code> in the headers of the input files but it will not change the science data.</p>
<p>For images of sparse fields with few astronomical sources, the default <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'localmin'</span></code> may be used, although this method can slightly oversubtract the background.  For images with complicated backgrounds, such as nebulae and large host galaxies, <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'match'</span></code> is recommended.</p>
<p>For more information on the specifics of this function, please refer to the documentation <a class="reference external" href="https://drizzlepac.readthedocs.io/en/latest/drizzlepac_api/sky.html#drizzlepac.sky.sky">here</a></p>
<p>Below, each of the four methods is demonstrated using a single example dataset, and differences between the methods is highlighted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># All imports needed through out this notebook are included at the beginning. </span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;

<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.image</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpimg</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">ascii</span><span class="p">,</span> <span class="n">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="kn">import</span> <span class="n">Quantity</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.gaia</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gaia</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">drizzlepac</span><span class="w"> </span><span class="kn">import</span> <span class="n">astrodrizzle</span><span class="p">,</span> <span class="n">tweakback</span><span class="p">,</span> <span class="n">tweakreg</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">drizzlepac.haputils.astrometric_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_astrometric_catalog</span>


<span class="n">Gaia</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE</span> <span class="o">=</span> <span class="s1">&#39;gaiadr3.gaia_source&#39;</span>   <span class="c1"># Change if different data release is desired</span>
<span class="n">Gaia</span><span class="o">.</span><span class="n">ROW_LIMIT</span> <span class="o">=</span> <span class="mi">100000</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-the-observations-with-astroquery">
<h2>1. Download the Observations with <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> <a id="download"></a><a class="headerlink" href="#download-the-observations-with-astroquery" title="Link to this heading">#</a></h2>
<p>MAST queries may be done using <a href="https://astroquery.readthedocs.io/en/latest/mast/mast_obsquery.html#observation-criteria-queries"> <code class="docutils literal notranslate"><span class="pre">query_criteria</span></code></a>, where we specify: <br></p>
<p>    –&gt; obs_id, proposal_id, and filters</p>
<p>MAST data products may be downloaded by using <a href="https://astroquery.readthedocs.io/en/latest/mast/mast_obsquery.html#downloading-data"> <code class="docutils literal notranslate"><span class="pre">download_products</span></code></a>, where we specify:<br></p>
<p>    –&gt; products = calibrated (FLT, FLC) or drizzled (DRZ, DRC) files</p>
<p>    –&gt; type = standard products (CALxxx) or advanced products (HAP-SVM)</p>
<br>
<p>WFC3/IR observations of the Horsehead Nebula in the F160W filter obtained in HST proposal
program <a class="reference external" href="https://www.stsci.edu/hst-program-info/program/?program=12812">12812</a>
will be used for this demonstration.</p>
<p>Nine visits were acquired in a 3x3 mosaic pattern on the sky, with two dither positions per visit in two IR filters. <a class="reference external" href="https://archive.stsci.edu/prepds/heritage/horsehead/readme_HLSP_v3.txt">High level science products</a> for these datasets were delivered to MAST in 2013, and this notebook is based on that user tutorial but has been updated to align these data to Gaia.</p>
<p>The 18 FLT images <b>ibxl5*_flt.fits</b> have been processed by the HST WFC3 pipeline (calwf3), which includes bias subtraction, dark current correction, cosmic-ray rejection, and flatfielding. The 9 DRZ files <b>ibxl5*_drz.fits</b> have been processed with <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> to remove distortion and to combine the 2 dithered FLT frames by filter for each vist.</p>
<div class="alert alert-block alert-warning" style="color:black" >  THIS IS A LARGE DOWNLOAD (~400 MB). Depending on your connection speed, the next cell may take a few minutes to execute. </div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ibxl5*&#39;</span><span class="p">]</span>
<span class="n">props</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;12812&#39;</span><span class="p">]</span>
<span class="n">filts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;F160W&#39;</span><span class="p">]</span>

<span class="n">obsTable</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="n">obs_ids</span><span class="p">,</span> <span class="n">proposal_id</span><span class="o">=</span><span class="n">props</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filts</span><span class="p">)</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obsTable</span><span class="p">)</span>

<span class="n">data_prod</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FLT&#39;</span><span class="p">,</span> <span class="s1">&#39;DRZ&#39;</span><span class="p">]</span>     <span class="c1"># [&#39;FLC&#39;,&#39;FLT&#39;,&#39;DRC&#39;,&#39;DRZ&#39;]                  </span>
<span class="n">data_type</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CALWF3&#39;</span><span class="p">]</span>         <span class="c1"># [&#39;CALACS&#39;,&#39;CALWF3&#39;,&#39;CALWP2&#39;,&#39;HAP-SVM&#39;]    </span>

<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">=</span><span class="s1">&#39;./science&#39;</span><span class="p">,</span>
                               <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="n">data_prod</span><span class="p">,</span> 
                               <span class="n">project</span><span class="o">=</span><span class="n">data_type</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl50clq_flt.fits to ./science/mastDownload/HST/ibxl50clq/ibxl50clq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl50cqq_flt.fits to ./science/mastDownload/HST/ibxl50cqq/ibxl50cqq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl51eoq_flt.fits to ./science/mastDownload/HST/ibxl51eoq/ibxl51eoq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl51etq_flt.fits to ./science/mastDownload/HST/ibxl51etq/ibxl51etq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl52k0q_flt.fits to ./science/mastDownload/HST/ibxl52k0q/ibxl52k0q_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl52k5q_flt.fits to ./science/mastDownload/HST/ibxl52k5q/ibxl52k5q_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl53kxq_flt.fits to ./science/mastDownload/HST/ibxl53kxq/ibxl53kxq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl53l9q_flt.fits to ./science/mastDownload/HST/ibxl53l9q/ibxl53l9q_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl54bgq_flt.fits to ./science/mastDownload/HST/ibxl54bgq/ibxl54bgq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl54blq_flt.fits to ./science/mastDownload/HST/ibxl54blq/ibxl54blq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl55f0q_flt.fits to ./science/mastDownload/HST/ibxl55f0q/ibxl55f0q_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl55f5q_flt.fits to ./science/mastDownload/HST/ibxl55f5q/ibxl55f5q_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl56huq_flt.fits to ./science/mastDownload/HST/ibxl56huq/ibxl56huq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl56i2q_flt.fits to ./science/mastDownload/HST/ibxl56i2q/ibxl56i2q_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl57adq_flt.fits to ./science/mastDownload/HST/ibxl57adq/ibxl57adq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl57aiq_flt.fits to ./science/mastDownload/HST/ibxl57aiq/ibxl57aiq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl58sqq_flt.fits to ./science/mastDownload/HST/ibxl58sqq/ibxl58sqq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl58svq_flt.fits to ./science/mastDownload/HST/ibxl58svq/ibxl58svq_flt.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl50030_drz.fits to ./science/mastDownload/HST/ibxl50030/ibxl50030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl51030_drz.fits to ./science/mastDownload/HST/ibxl51030/ibxl51030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl52030_drz.fits to ./science/mastDownload/HST/ibxl52030/ibxl52030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl53030_drz.fits to ./science/mastDownload/HST/ibxl53030/ibxl53030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl54030_drz.fits to ./science/mastDownload/HST/ibxl54030/ibxl54030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl55030_drz.fits to ./science/mastDownload/HST/ibxl55030/ibxl55030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl56030_drz.fits to ./science/mastDownload/HST/ibxl56030/ibxl56030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl57030_drz.fits to ./science/mastDownload/HST/ibxl57030/ibxl57030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ibxl58030_drz.fits to ./science/mastDownload/HST/ibxl58030/ibxl58030_drz.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=27</i>
<table id="table139654329269584" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str55</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>./science/mastDownload/HST/ibxl50clq/ibxl50clq_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl50cqq/ibxl50cqq_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl51eoq/ibxl51eoq_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl51etq/ibxl51etq_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl52k0q/ibxl52k0q_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl52k5q/ibxl52k5q_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl53kxq/ibxl53kxq_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl53l9q/ibxl53l9q_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl54bgq/ibxl54bgq_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>./science/mastDownload/HST/ibxl58svq/ibxl58svq_flt.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl50030/ibxl50030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl51030/ibxl51030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl52030/ibxl52030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl53030/ibxl53030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl54030/ibxl54030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl55030/ibxl55030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl56030/ibxl56030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl57030/ibxl57030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>./science/mastDownload/HST/ibxl58030/ibxl58030_drz.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p>Move the files to the local working directory</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span> <span class="s1">&#39;science&#39;</span><span class="p">,</span> <span class="s1">&#39;mastDownload&#39;</span><span class="p">,</span> <span class="s1">&#39;HST&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;*fits&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="s1">&#39;./&#39;</span> <span class="o">+</span> <span class="n">root</span><span class="p">)</span>
    
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;./science&#39;</span><span class="p">):</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s1">&#39;science/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="check-image-header-data">
<h3>1.1 Check image header data <a id="check_keywords"></a><a class="headerlink" href="#check-image-header-data" title="Link to this heading">#</a></h3>
<p>Here we will look at important keywords in the image headers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*fl?.fits&#39;</span><span class="p">))</span>
<span class="n">keywords_ext0</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ROOTNAME&quot;</span><span class="p">,</span> <span class="s2">&quot;ASN_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;TARGNAME&quot;</span><span class="p">,</span> <span class="s2">&quot;DETECTOR&quot;</span><span class="p">,</span> <span class="s2">&quot;FILTER&quot;</span><span class="p">,</span> <span class="s2">&quot;EXPTIME&quot;</span><span class="p">,</span> 
                 <span class="s2">&quot;RA_TARG&quot;</span><span class="p">,</span> <span class="s2">&quot;DEC_TARG&quot;</span><span class="p">,</span> <span class="s2">&quot;POSTARG1&quot;</span><span class="p">,</span> <span class="s2">&quot;POSTARG2&quot;</span><span class="p">,</span> <span class="s2">&quot;DATE-OBS&quot;</span><span class="p">]</span>
<span class="n">keywords_ext1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ORIENTAT&quot;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">path_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">keywords_ext0</span><span class="p">:</span>
        <span class="n">path_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getval</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">keywords_ext1</span><span class="p">:</span>
        <span class="n">path_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">getval</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path_data</span><span class="p">)</span>
    
<span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords_ext0</span> <span class="o">+</span> <span class="n">keywords_ext1</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">,</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">])</span>
<span class="n">table</span><span class="p">[</span><span class="s1">&#39;EXPTIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;7.1f&#39;</span> 
<span class="n">table</span><span class="p">[</span><span class="s1">&#39;RA_TARG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;DEC_TARG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;7.4f&#39;</span>
<span class="n">table</span><span class="p">[</span><span class="s1">&#39;POSTARG1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;POSTARG2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;7.3f&#39;</span> 
<span class="n">table</span><span class="p">[</span><span class="s1">&#39;ORIENTAT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;7.2f&#39;</span>
<span class="n">table</span><span class="o">.</span><span class="n">show_in_notebook</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3c9fa176385d47edbd2491d552f1a85b", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="inspect-the-alignment">
<h3>1.2 Inspect the Alignment <a id="check_wcs"></a><a class="headerlink" href="#inspect-the-alignment" title="Link to this heading">#</a></h3>
<p>Check the active WCS solution in the image header. If the image is aligned to a catalog, list the number of matches and the fit RMS in mas. <br>
Convert the fit RMS values to pixels for comparison with the alignment results performed later in this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ext_0_kws</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DETECTOR&#39;</span><span class="p">]</span>
<span class="n">ext_1_kws</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;WCSNAME&#39;</span><span class="p">,</span> <span class="s1">&#39;NMATCHES&#39;</span><span class="p">,</span> <span class="s1">&#39;RMS_RA&#39;</span><span class="p">,</span> <span class="s1">&#39;RMS_DEC&#39;</span><span class="p">]</span>

<span class="n">det_scale</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IR&#39;</span><span class="p">:</span> <span class="mf">0.1283</span><span class="p">,</span> <span class="s1">&#39;UVIS&#39;</span><span class="p">:</span> <span class="mf">0.0396</span><span class="p">,</span> <span class="s1">&#39;WFC&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>                  <span class="c1"># plate scale (arcsec/pixel)</span>

<span class="n">format_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">col_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*dr?.fits&#39;</span><span class="p">)):</span>
    <span class="n">col_dict</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">hdr0</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">hdr1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">ext_0_kws</span><span class="p">:</span>                                                <span class="c1"># extension 0 keywords</span>
        <span class="n">col_dict</span><span class="p">[</span><span class="n">kw</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hdr0</span><span class="p">[</span><span class="n">kw</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">ext_1_kws</span><span class="p">:</span>                                                <span class="c1"># extension 1 keywords</span>
        <span class="k">if</span> <span class="s1">&#39;RMS&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">hdr1</span><span class="p">[</span><span class="n">kw</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">val</span> <span class="o">=</span> <span class="n">hdr1</span><span class="p">[</span><span class="n">kw</span><span class="p">]</span>
        <span class="n">col_dict</span><span class="p">[</span><span class="n">kw</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;RMS_RA&#39;</span><span class="p">,</span> <span class="s1">&#39;RMS_DEC&#39;</span><span class="p">]:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">hdr1</span><span class="p">[</span><span class="n">kw</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span><span class="o">/</span><span class="n">det_scale</span><span class="p">[</span><span class="n">hdr0</span><span class="p">[</span><span class="s1">&#39;DETECTOR&#39;</span><span class="p">]],</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># convert RMS from mas to pixels</span>
        <span class="n">col_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">kw</span><span class="si">}</span><span class="s1">_pix&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

<span class="n">wcstable</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">col_dict</span><span class="p">)</span>
<span class="n">wcstable</span><span class="o">.</span><span class="n">show_in_notebook</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7df980d463d5435388ea4af52e8ce2f5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="alert alert-block alert-warning" style="color:black" > <b> Note that there are different WCS solutions for each visit, with Gaia eDR3 as the reference catalog for all but two which were fit to GSC v2.4.2 and which have a much larger fit rms values (>0.5 pixels). Since the WCS solutions are inconsistent for this target, we wish to realign the data to use a common reference catalog.</b></div></section>
</section>
<section id="align-the-visit-level-drizzled-data-with-tweakreg">
<h2>2. Align the visit-level drizzled data with <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> <a id="align"></a><a class="headerlink" href="#align-the-visit-level-drizzled-data-with-tweakreg" title="Link to this heading">#</a></h2>
<p>Here we will use <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> to align the DRZ files to Gaia DR3 and then use <code class="docutils literal notranslate"><span class="pre">TweakBack</span></code> to propagate those solutions back to the FLT image headers prior to combining with <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code>.</p>
<section id="create-a-catalog-of-gaia-dr3-sources">
<h3>2.1 Create a catalog of Gaia DR3 sources  <a id="cat"></a><a class="headerlink" href="#create-a-catalog-of-gaia-dr3-sources" title="Link to this heading">#</a></h3>
<p>This method uses the RA/Dec of the first image and a radius of 5’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RA</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;RA_TARG&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Dec</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;DEC_TARG&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">RA</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">Dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">)</span>

<span class="n">gaia_query</span> <span class="o">=</span> <span class="n">Gaia</span><span class="o">.</span><span class="n">query_object_async</span><span class="p">(</span><span class="n">coordinate</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
<span class="n">gaia_query</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Query finished. [astroquery.utils.tap.core]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=183</i>
<table id="table139655639029200" class="table-striped table-bordered table-condensed">
<thead><tr><th>solution_id</th><th>designation</th><th>source_id</th><th>random_index</th><th>ref_epoch</th><th>ra</th><th>ra_error</th><th>dec</th><th>dec_error</th><th>parallax</th><th>parallax_error</th><th>parallax_over_error</th><th>pm</th><th>pmra</th><th>pmra_error</th><th>pmdec</th><th>pmdec_error</th><th>ra_dec_corr</th><th>ra_parallax_corr</th><th>ra_pmra_corr</th><th>ra_pmdec_corr</th><th>dec_parallax_corr</th><th>dec_pmra_corr</th><th>dec_pmdec_corr</th><th>parallax_pmra_corr</th><th>parallax_pmdec_corr</th><th>pmra_pmdec_corr</th><th>astrometric_n_obs_al</th><th>astrometric_n_obs_ac</th><th>astrometric_n_good_obs_al</th><th>astrometric_n_bad_obs_al</th><th>astrometric_gof_al</th><th>astrometric_chi2_al</th><th>astrometric_excess_noise</th><th>astrometric_excess_noise_sig</th><th>astrometric_params_solved</th><th>astrometric_primary_flag</th><th>nu_eff_used_in_astrometry</th><th>pseudocolour</th><th>pseudocolour_error</th><th>ra_pseudocolour_corr</th><th>dec_pseudocolour_corr</th><th>parallax_pseudocolour_corr</th><th>pmra_pseudocolour_corr</th><th>pmdec_pseudocolour_corr</th><th>astrometric_matched_transits</th><th>visibility_periods_used</th><th>astrometric_sigma5d_max</th><th>matched_transits</th><th>new_matched_transits</th><th>matched_transits_removed</th><th>ipd_gof_harmonic_amplitude</th><th>ipd_gof_harmonic_phase</th><th>ipd_frac_multi_peak</th><th>ipd_frac_odd_win</th><th>ruwe</th><th>scan_direction_strength_k1</th><th>scan_direction_strength_k2</th><th>scan_direction_strength_k3</th><th>scan_direction_strength_k4</th><th>scan_direction_mean_k1</th><th>scan_direction_mean_k2</th><th>scan_direction_mean_k3</th><th>scan_direction_mean_k4</th><th>duplicated_source</th><th>phot_g_n_obs</th><th>phot_g_mean_flux</th><th>phot_g_mean_flux_error</th><th>phot_g_mean_flux_over_error</th><th>phot_g_mean_mag</th><th>phot_bp_n_obs</th><th>phot_bp_mean_flux</th><th>phot_bp_mean_flux_error</th><th>phot_bp_mean_flux_over_error</th><th>phot_bp_mean_mag</th><th>phot_rp_n_obs</th><th>phot_rp_mean_flux</th><th>phot_rp_mean_flux_error</th><th>phot_rp_mean_flux_over_error</th><th>phot_rp_mean_mag</th><th>phot_bp_rp_excess_factor</th><th>phot_bp_n_contaminated_transits</th><th>phot_bp_n_blended_transits</th><th>phot_rp_n_contaminated_transits</th><th>phot_rp_n_blended_transits</th><th>phot_proc_mode</th><th>bp_rp</th><th>bp_g</th><th>g_rp</th><th>radial_velocity</th><th>radial_velocity_error</th><th>rv_method_used</th><th>rv_nb_transits</th><th>rv_nb_deblended_transits</th><th>rv_visibility_periods_used</th><th>rv_expected_sig_to_noise</th><th>rv_renormalised_gof</th><th>rv_chisq_pvalue</th><th>rv_time_duration</th><th>rv_amplitude_robust</th><th>rv_template_teff</th><th>rv_template_logg</th><th>rv_template_fe_h</th><th>rv_atm_param_origin</th><th>vbroad</th><th>vbroad_error</th><th>vbroad_nb_transits</th><th>grvs_mag</th><th>grvs_mag_error</th><th>grvs_mag_nb_transits</th><th>rvs_spec_sig_to_noise</th><th>phot_variable_flag</th><th>l</th><th>b</th><th>ecl_lon</th><th>ecl_lat</th><th>in_qso_candidates</th><th>in_galaxy_candidates</th><th>non_single_star</th><th>has_xp_continuous</th><th>has_xp_sampled</th><th>has_rvs</th><th>has_epoch_photometry</th><th>has_epoch_rv</th><th>has_mcmc_gspphot</th><th>has_mcmc_msc</th><th>in_andromeda_survey</th><th>classprob_dsc_combmod_quasar</th><th>classprob_dsc_combmod_galaxy</th><th>classprob_dsc_combmod_star</th><th>teff_gspphot</th><th>teff_gspphot_lower</th><th>teff_gspphot_upper</th><th>logg_gspphot</th><th>logg_gspphot_lower</th><th>logg_gspphot_upper</th><th>mh_gspphot</th><th>mh_gspphot_lower</th><th>mh_gspphot_upper</th><th>distance_gspphot</th><th>distance_gspphot_lower</th><th>distance_gspphot_upper</th><th>azero_gspphot</th><th>azero_gspphot_lower</th><th>azero_gspphot_upper</th><th>ag_gspphot</th><th>ag_gspphot_lower</th><th>ag_gspphot_upper</th><th>ebpminrp_gspphot</th><th>ebpminrp_gspphot_lower</th><th>ebpminrp_gspphot_upper</th><th>libname_gspphot</th><th>dist</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th></th><th>yr</th><th>deg</th><th>mas</th><th>deg</th><th>mas</th><th>mas</th><th>mas</th><th></th><th>mas / yr</th><th>mas / yr</th><th>mas / yr</th><th>mas / yr</th><th>mas / yr</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>mas</th><th></th><th></th><th></th><th>1 / um</th><th>1 / um</th><th>1 / um</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>mas</th><th></th><th></th><th></th><th></th><th>deg</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th></th><th></th><th>electron / s</th><th>electron / s</th><th></th><th>mag</th><th></th><th>electron / s</th><th>electron / s</th><th></th><th>mag</th><th></th><th>electron / s</th><th>electron / s</th><th></th><th>mag</th><th></th><th></th><th></th><th></th><th></th><th></th><th>mag</th><th>mag</th><th>mag</th><th>km / s</th><th>km / s</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>d</th><th>km / s</th><th>K</th><th>log(cm.s**-2)</th><th>dex</th><th></th><th>km / s</th><th>km / s</th><th></th><th>mag</th><th>mag</th><th></th><th></th><th></th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>K</th><th>K</th><th>K</th><th>log(cm.s**-2)</th><th>log(cm.s**-2)</th><th>log(cm.s**-2)</th><th>dex</th><th>dex</th><th>dex</th><th>pc</th><th>pc</th><th>pc</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th></th><th></th></tr></thead>
<thead><tr><th>int64</th><th>object</th><th>int64</th><th>int64</th><th>float64</th><th>float64</th><th>float32</th><th>float64</th><th>float32</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>float64</th><th>float32</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>int16</th><th>int16</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>bool</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>int16</th><th>float32</th><th>int16</th><th>int16</th><th>int16</th><th>float32</th><th>float32</th><th>int16</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>bool</th><th>int16</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>int16</th><th>int16</th><th>int16</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>int16</th><th>int16</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int16</th><th>float32</th><th>float32</th><th>int16</th><th>float32</th><th>float32</th><th>int16</th><th>float32</th><th>object</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>bool</th><th>bool</th><th>int16</th><th>bool</th><th>bool</th><th>bool</th><th>bool</th><th>bool</th><th>bool</th><th>bool</th><th>bool</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>object</th><th>float64</th></tr></thead>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216469053418858496</td><td>3216469053418858496</td><td>368024805</td><td>2016.0</td><td>85.25078206874738</td><td>0.34748474</td><td>-2.444257621037541</td><td>0.31849745</td><td>0.9495336814954154</td><td>0.41641867</td><td>2.2802382</td><td>7.7956214</td><td>-0.8302380599609497</td><td>0.43142426</td><td>7.751285021389771</td><td>0.36127582</td><td>-0.072362915</td><td>0.0020754219</td><td>-0.35186028</td><td>0.1278402</td><td>-0.26970458</td><td>0.15042841</td><td>-0.6164755</td><td>0.10007274</td><td>0.19517034</td><td>-0.149899</td><td>357</td><td>0</td><td>357</td><td>0</td><td>1.8443948</td><td>436.133</td><td>1.3849133</td><td>2.208717</td><td>95</td><td>False</td><td>--</td><td>1.233876</td><td>0.08958775</td><td>-0.17215662</td><td>-0.06320628</td><td>-0.05079003</td><td>-0.1254937</td><td>0.08907318</td><td>41</td><td>21</td><td>0.63760585</td><td>42</td><td>26</td><td>0</td><td>0.015478957</td><td>5.244358</td><td>0</td><td>0</td><td>1.0694424</td><td>0.20129156</td><td>0.24663325</td><td>0.2671826</td><td>0.5048746</td><td>-80.303276</td><td>-2.1296542</td><td>-22.792238</td><td>-43.76734</td><td>False</td><td>354</td><td>218.89926651301704</td><td>0.7818137</td><td>279.98904</td><td>19.836756</td><td>28</td><td>44.18486946908339</td><td>5.24969</td><td>8.416662</td><td>21.225359</td><td>36</td><td>308.8952727851156</td><td>11.356452</td><td>27.19998</td><td>18.523367</td><td>1.61298</td><td>0</td><td>2</td><td>0</td><td>3</td><td>0</td><td>2.701992</td><td>1.3886032</td><td>1.3133888</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.94547931488657</td><td>-16.76434187915805</td><td>84.72852258013162</td><td>-25.79667536635267</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>1.7621454e-13</td><td>5.111382e-13</td><td>0.99999774</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.009486679186673242</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216469057714526080</td><td>3216469057714526080</td><td>160562994</td><td>2016.0</td><td>85.24865858921503</td><td>0.0807162</td><td>-2.441354584616136</td><td>0.07413533</td><td>0.24702429233455972</td><td>0.09551564</td><td>2.5862184</td><td>1.38756</td><td>0.7312738742365584</td><td>0.09950856</td><td>1.1792206068277042</td><td>0.08531875</td><td>-0.09268238</td><td>-0.016587587</td><td>-0.35330772</td><td>0.15432145</td><td>-0.25057435</td><td>0.17109188</td><td>-0.649208</td><td>0.11624458</td><td>0.24781711</td><td>-0.1273712</td><td>389</td><td>0</td><td>387</td><td>2</td><td>-1.0886481</td><td>412.40457</td><td>0.0</td><td>0.0</td><td>95</td><td>False</td><td>--</td><td>1.2642988</td><td>0.020441843</td><td>-0.14009616</td><td>-0.07836674</td><td>0.0031425122</td><td>-0.10781701</td><td>0.09727073</td><td>45</td><td>21</td><td>0.1476955</td><td>46</td><td>29</td><td>0</td><td>0.021776078</td><td>2.3582678</td><td>0</td><td>0</td><td>0.9599596</td><td>0.19218576</td><td>0.2656598</td><td>0.22300626</td><td>0.48614076</td><td>-98.501114</td><td>-2.7790413</td><td>-25.351597</td><td>-43.091904</td><td>False</td><td>385</td><td>1533.7964710362219</td><td>1.6690606</td><td>918.95795</td><td>17.722948</td><td>45</td><td>414.8798543565718</td><td>7.5229797</td><td>55.148342</td><td>18.793736</td><td>44</td><td>1747.7167079736257</td><td>11.556245</td><td>151.23569</td><td>16.641718</td><td>1.4099631</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>2.1520176</td><td>1.0707874</td><td>1.0812302</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.94176557869633</td><td>-16.764874991852714</td><td>84.72628577778967</td><td>-25.793696653062412</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>True</td><td>True</td><td>False</td><td>1.2362927e-13</td><td>6.260371e-13</td><td>0.9999927</td><td>6097.917</td><td>5930.6045</td><td>6142.094</td><td>4.5226</td><td>4.5009</td><td>4.5768</td><td>-3.9361</td><td>-4.0965</td><td>-3.6061</td><td>919.4193</td><td>833.37</td><td>948.0848</td><td>3.6223</td><td>3.5315</td><td>3.6515</td><td>2.7407</td><td>2.6619</td><td>2.7644</td><td>1.5455</td><td>1.5014</td><td>1.5587</td><td>MARCS</td><td>0.013011650487557274</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216467855123686016</td><td>3216467855123686016</td><td>668710222</td><td>2016.0</td><td>85.25474417063919</td><td>0.07255654</td><td>-2.470084090608095</td><td>0.06763807</td><td>1.705994308777196</td><td>0.09274939</td><td>18.39359</td><td>13.672125</td><td>-3.181681654139363</td><td>0.08841129</td><td>-13.296762516546895</td><td>0.07709159</td><td>-0.12809613</td><td>0.08502215</td><td>-0.3073343</td><td>0.19231312</td><td>-0.37712017</td><td>0.17119895</td><td>-0.66374385</td><td>0.03020479</td><td>0.40648898</td><td>-0.117953785</td><td>376</td><td>0</td><td>376</td><td>0</td><td>4.4143248</td><td>528.08984</td><td>0.39314708</td><td>4.8827662</td><td>31</td><td>False</td><td>1.3003229</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>43</td><td>21</td><td>0.13255168</td><td>45</td><td>26</td><td>0</td><td>0.027088897</td><td>14.045337</td><td>0</td><td>2</td><td>1.1654105</td><td>0.22388098</td><td>0.3077812</td><td>0.25345388</td><td>0.42603984</td><td>-72.65342</td><td>-1.7500962</td><td>-25.84865</td><td>-41.594986</td><td>False</td><td>368</td><td>2476.027650243042</td><td>4.3828444</td><td>564.9362</td><td>17.202978</td><td>40</td><td>585.7780381608451</td><td>11.731945</td><td>49.930172</td><td>18.41921</td><td>36</td><td>2981.23630414607</td><td>24.774414</td><td>120.33529</td><td>16.061905</td><td>1.4406197</td><td>0</td><td>4</td><td>0</td><td>3</td><td>0</td><td>2.3573055</td><td>1.2162323</td><td>1.1410732</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.9712942044114</td><td>-16.772811629675818</td><td>84.73186766212942</td><td>-25.822629314586116</td><td>False</td><td>False</td><td>0</td><td>True</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>True</td><td>False</td><td>1.1540595e-13</td><td>1.3798553e-09</td><td>0.9999877</td><td>5968.2295</td><td>5923.5728</td><td>5995.96</td><td>4.6275</td><td>4.589</td><td>4.6636</td><td>-4.0538</td><td>-4.1164</td><td>-3.7235</td><td>542.7187</td><td>531.214</td><td>555.837</td><td>4.0502</td><td>4.0231</td><td>4.069</td><td>3.0096</td><td>2.9875</td><td>3.0238</td><td>1.7022</td><td>1.6897</td><td>1.7104</td><td>MARCS</td><td>0.017083879996516314</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216469019060675328</td><td>3216469019060675328</td><td>755626735</td><td>2016.0</td><td>85.26833524857398</td><td>0.45910412</td><td>-2.4416029853336667</td><td>0.40957135</td><td>-1.0905664099598757</td><td>0.530555</td><td>-2.0555198</td><td>1.1219171</td><td>0.8643062489270098</td><td>0.5828771</td><td>0.715313093573643</td><td>0.47160438</td><td>-0.054446124</td><td>-0.015339496</td><td>-0.33468443</td><td>0.13777287</td><td>-0.2609537</td><td>0.1763433</td><td>-0.5611049</td><td>0.031097142</td><td>0.2177652</td><td>-0.11443702</td><td>330</td><td>0</td><td>329</td><td>1</td><td>1.0299137</td><td>382.76816</td><td>0.68933684</td><td>0.29942906</td><td>95</td><td>False</td><td>--</td><td>1.2502365</td><td>0.123004876</td><td>-0.19324453</td><td>-0.12574936</td><td>0.032932058</td><td>-0.14361922</td><td>0.064552374</td><td>39</td><td>19</td><td>0.84676933</td><td>41</td><td>25</td><td>0</td><td>0.06055019</td><td>12.78158</td><td>0</td><td>0</td><td>1.0397482</td><td>0.20912738</td><td>0.2604514</td><td>0.24491833</td><td>0.5289087</td><td>-85.225365</td><td>-3.2899575</td><td>-29.32366</td><td>-42.54999</td><td>False</td><td>328</td><td>147.74586838835364</td><td>0.72871625</td><td>202.74814</td><td>20.263578</td><td>29</td><td>36.02716968454987</td><td>3.8942373</td><td>9.251406</td><td>21.446966</td><td>37</td><td>190.87637950900836</td><td>7.5462556</td><td>25.294184</td><td>19.046015</td><td>1.5357692</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>2.4009514</td><td>1.1833878</td><td>1.2175636</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.9515174309682</td><td>-16.74757367009055</td><td>84.74809544110592</td><td>-25.794662806626693</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>7.747473e-13</td><td>5.229698e-13</td><td>0.99999446</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.017945489552972947</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216468611037930624</td><td>3216468611037930624</td><td>935473409</td><td>2016.0</td><td>85.2386085747217</td><td>0.46767473</td><td>-2.462292300986681</td><td>0.4031481</td><td>0.7770076972461502</td><td>0.59839076</td><td>1.2984954</td><td>5.413292</td><td>0.5531465058042339</td><td>0.6129275</td><td>-5.384956673257242</td><td>0.49430868</td><td>0.014938566</td><td>0.06448122</td><td>-0.21245089</td><td>0.0711942</td><td>-0.2614386</td><td>0.1208418</td><td>-0.5615382</td><td>-0.026767768</td><td>0.38506997</td><td>-0.09344254</td><td>342</td><td>0</td><td>342</td><td>0</td><td>0.9642493</td><td>406.29196</td><td>1.4710811</td><td>1.2780555</td><td>95</td><td>False</td><td>--</td><td>1.1623133</td><td>0.12403801</td><td>-0.19795567</td><td>-0.079425685</td><td>0.06298836</td><td>-0.106788404</td><td>0.1012403</td><td>39</td><td>17</td><td>0.8698572</td><td>40</td><td>24</td><td>0</td><td>0.036293596</td><td>90.33434</td><td>0</td><td>0</td><td>1.0364223</td><td>0.1608992</td><td>0.30992013</td><td>0.18475303</td><td>0.44911218</td><td>-82.79225</td><td>-4.6845818</td><td>-28.746756</td><td>-41.727596</td><td>False</td><td>341</td><td>137.96486675397304</td><td>0.78542095</td><td>175.65723</td><td>20.337946</td><td>21</td><td>59.02707720646006</td><td>6.8534393</td><td>8.612767</td><td>20.910913</td><td>33</td><td>211.43949067561897</td><td>9.650035</td><td>21.91075</td><td>18.93493</td><td>1.9604018</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1.9759827</td><td>0.5729675</td><td>1.4030151</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.95627609646655</td><td>-16.78348111875944</td><td>84.71428834509156</td><td>-25.814252456150466</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>1.2971835e-13</td><td>8.269208e-13</td><td>0.9999991</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.01836293659726027</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216468675465488256</td><td>3216468675465488256</td><td>16647219</td><td>2016.0</td><td>85.23467309871081</td><td>0.51438564</td><td>-2.4498085573057633</td><td>0.43504587</td><td>0.33731643747067025</td><td>0.63177866</td><td>0.5339156</td><td>2.3331635</td><td>2.3330716928916786</td><td>0.65796125</td><td>0.02069617827588948</td><td>0.5042113</td><td>-0.011451531</td><td>-0.19442908</td><td>-0.41642103</td><td>0.03437781</td><td>-0.38334745</td><td>0.10441229</td><td>-0.6943009</td><td>0.1926607</td><td>0.4085249</td><td>-0.12117048</td><td>334</td><td>0</td><td>333</td><td>1</td><td>0.65179557</td><td>368.28964</td><td>1.3423299</td><td>1.2644218</td><td>95</td><td>False</td><td>--</td><td>1.3347516</td><td>0.11629938</td><td>-0.2020829</td><td>-0.07508502</td><td>-0.014079772</td><td>-0.13441803</td><td>0.09302474</td><td>38</td><td>17</td><td>0.95642906</td><td>39</td><td>25</td><td>0</td><td>0.0040856865</td><td>64.82368</td><td>0</td><td>0</td><td>1.0245674</td><td>0.20001507</td><td>0.36711606</td><td>0.26003</td><td>0.40765452</td><td>-98.68751</td><td>4.1797576</td><td>-20.715187</td><td>-39.459377</td><td>False</td><td>327</td><td>151.8625314562344</td><td>0.66563815</td><td>228.14578</td><td>20.23374</td><td>21</td><td>36.17745844357809</td><td>5.4620037</td><td>6.6234775</td><td>21.442448</td><td>29</td><td>204.66180430023923</td><td>8.290443</td><td>24.686472</td><td>18.970303</td><td>1.5859032</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>2.472145</td><td>1.2087078</td><td>1.2634373</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.94281943924076</td><td>-16.781174971492643</td><td>84.71043259626695</td><td>-25.801632853854667</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>4.767196e-13</td><td>5.8040146e-11</td><td>0.99999815</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.020028009828231417</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216469023354785408</td><td>3216469023354785408</td><td>176691911</td><td>2016.0</td><td>85.27075582329469</td><td>0.1961405</td><td>-2.441307234608435</td><td>0.17860357</td><td>0.6636681928453716</td><td>0.2341562</td><td>2.8342967</td><td>6.585025</td><td>6.575404865804311</td><td>0.24365711</td><td>-0.35580991638604564</td><td>0.20158039</td><td>-0.04231842</td><td>0.014788889</td><td>-0.3154728</td><td>0.11617606</td><td>-0.2603726</td><td>0.12642686</td><td>-0.5700941</td><td>0.13072464</td><td>0.23919845</td><td>-0.061890464</td><td>368</td><td>0</td><td>366</td><td>2</td><td>0.43652844</td><td>405.4187</td><td>0.072520114</td><td>0.015899755</td><td>95</td><td>False</td><td>--</td><td>1.2586821</td><td>0.05131671</td><td>-0.1420974</td><td>-0.08405918</td><td>-0.029754888</td><td>-0.114538334</td><td>0.13519505</td><td>43</td><td>20</td><td>0.3494921</td><td>45</td><td>28</td><td>0</td><td>0.018798698</td><td>6.73902</td><td>0</td><td>0</td><td>1.0153817</td><td>0.21722564</td><td>0.24762863</td><td>0.26764935</td><td>0.5151869</td><td>-74.446075</td><td>-3.9929616</td><td>-22.67545</td><td>-43.95803</td><td>False</td><td>363</td><td>409.71337850914114</td><td>1.0203439</td><td>401.5444</td><td>19.156166</td><td>37</td><td>65.82193793586049</td><td>5.4644194</td><td>12.04555</td><td>20.792616</td><td>40</td><td>530.0466563553375</td><td>7.329029</td><td>72.32154</td><td>17.93711</td><td>1.4543548</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>2.855505</td><td>1.6364498</td><td>1.2190552</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.95241508079897</td><td>-16.745293946283045</td><td>84.75079163706141</td><td>-25.7944553638111</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>3.5761834e-13</td><td>5.110677e-13</td><td>0.999994</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.020043830041751424</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216467855122414464</td><td>3216467855122414464</td><td>923936172</td><td>2016.0</td><td>85.25578005166672</td><td>0.50923383</td><td>-2.4765054474694934</td><td>0.45520246</td><td>0.7769168571521851</td><td>0.5960472</td><td>1.3034484</td><td>0.9249258</td><td>0.8018697645542915</td><td>0.6797768</td><td>0.4609692420907058</td><td>0.5313265</td><td>-0.11263442</td><td>0.11976503</td><td>-0.22806385</td><td>0.19673494</td><td>-0.18776836</td><td>0.22860377</td><td>-0.61896616</td><td>0.19363396</td><td>0.23427469</td><td>-0.13258351</td><td>285</td><td>0</td><td>282</td><td>3</td><td>-0.40685338</td><td>300.89392</td><td>0.0</td><td>2.4194166e-15</td><td>95</td><td>False</td><td>--</td><td>1.0979824</td><td>0.14102378</td><td>-0.12671481</td><td>-0.15378633</td><td>-0.059823737</td><td>-0.18096454</td><td>0.24567267</td><td>33</td><td>18</td><td>0.9812631</td><td>34</td><td>19</td><td>0</td><td>0.07628962</td><td>4.733895</td><td>0</td><td>0</td><td>0.98153275</td><td>0.21344621</td><td>0.29472753</td><td>0.19238599</td><td>0.43329495</td><td>-87.93401</td><td>-1.0898006</td><td>-29.688093</td><td>-42.996693</td><td>False</td><td>280</td><td>136.19056298917084</td><td>0.83884525</td><td>162.35481</td><td>20.352</td><td>23</td><td>45.240498301565275</td><td>8.204231</td><td>5.5142884</td><td>21.199724</td><td>31</td><td>151.9858001141609</td><td>8.52438</td><td>17.829544</td><td>19.293388</td><td>1.4481642</td><td>0</td><td>0</td><td>0</td><td>2</td><td>0</td><td>1.9063358</td><td>0.8477249</td><td>1.0586109</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.97773758997462</td><td>-16.774872090351703</td><td>84.73275587575476</td><td>-25.829084209901822</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>1.0344582e-09</td><td>1.8264745e-10</td><td>0.99999684</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.023539736369753695</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216468164360052992</td><td>3216468164360052992</td><td>23546710</td><td>2016.0</td><td>85.27451682697576</td><td>2.2556965</td><td>-2.472305714228985</td><td>1.5849423</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>0.536678</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>80</td><td>0</td><td>80</td><td>0</td><td>1.4301157</td><td>93.14176</td><td>0.0</td><td>0.0</td><td>3</td><td>False</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>10</td><td>7</td><td>4.1676683</td><td>10</td><td>6</td><td>0</td><td>0.09136518</td><td>171.88559</td><td>0</td><td>0</td><td>--</td><td>0.3697472</td><td>0.50056857</td><td>0.41110742</td><td>0.52664024</td><td>-76.56397</td><td>-22.63934</td><td>-33.053043</td><td>-39.32441</td><td>False</td><td>79</td><td>78.44416585717141</td><td>1.3150449</td><td>59.651325</td><td>20.950966</td><td>4</td><td>66.57637510952588</td><td>25.076605</td><td>2.6549199</td><td>20.780241</td><td>5</td><td>135.564179093732</td><td>25.503525</td><td>5.3155074</td><td>19.417534</td><td>2.5768716</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1.3627071</td><td>-0.17072487</td><td>1.533432</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.98291592741373</td><td>-16.75633924939091</td><td>84.75370889485112</td><td>-25.82557011527804</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>2.4502437e-05</td><td>1.4911667e-05</td><td>0.99836755</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.02782140743048771</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216456065439222912</td><td>3216456065439222912</td><td>1421695677</td><td>2016.0</td><td>85.31116982575814</td><td>0.40173137</td><td>-2.5106681948456453</td><td>0.4013123</td><td>1.736133118826882</td><td>0.45418435</td><td>3.8225296</td><td>9.741213</td><td>-5.152917907458617</td><td>0.517365</td><td>-8.266719879098039</td><td>0.443483</td><td>-0.16442835</td><td>-0.076135896</td><td>-0.43010193</td><td>0.24256699</td><td>0.0072904215</td><td>0.35669935</td><td>-0.7236328</td><td>0.12072589</td><td>-0.0053872755</td><td>-0.32701382</td><td>290</td><td>0</td><td>289</td><td>1</td><td>3.1741064</td><td>417.32562</td><td>1.6136845</td><td>3.0210483</td><td>95</td><td>False</td><td>--</td><td>1.1419736</td><td>0.1037138</td><td>-0.102503575</td><td>-0.23006625</td><td>-0.033000063</td><td>-0.16398549</td><td>0.22349931</td><td>34</td><td>20</td><td>0.8391437</td><td>37</td><td>25</td><td>0</td><td>0.02747992</td><td>177.14145</td><td>1</td><td>0</td><td>1.1351129</td><td>0.1884894</td><td>0.27369884</td><td>0.21929786</td><td>0.48222566</td><td>-80.36146</td><td>-4.405813</td><td>-22.027073</td><td>-42.93724</td><td>False</td><td>287</td><td>234.3866961283912</td><td>0.9647052</td><td>242.96199</td><td>19.762535</td><td>24</td><td>75.9456305925942</td><td>9.633069</td><td>7.883846</td><td>20.637285</td><td>29</td><td>334.7660203080705</td><td>11.112565</td><td>30.125</td><td>18.436043</td><td>1.7522823</td><td>0</td><td>2</td><td>0</td><td>1</td><td>0</td><td>2.2012424</td><td>0.87475014</td><td>1.3264923</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>207.0361400496104</td><td>-16.74167521407987</td><td>84.79282428995414</td><td>-25.865235525984968</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>6.410813e-12</td><td>2.0735247e-09</td><td>0.9999794</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.080839193349907</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216472558112887808</td><td>3216472558112887808</td><td>796706940</td><td>2016.0</td><td>85.18852621317357</td><td>0.2259397</td><td>-2.405656267543347</td><td>0.21768318</td><td>-0.11388777731196244</td><td>0.28216147</td><td>-0.40362626</td><td>1.2198783</td><td>1.184294234555146</td><td>0.26978385</td><td>-0.29248995206570705</td><td>0.2340413</td><td>-0.26953048</td><td>0.1911443</td><td>-0.23510878</td><td>0.32237884</td><td>-0.36343005</td><td>0.30793124</td><td>-0.65272945</td><td>0.037301254</td><td>0.33524925</td><td>-0.26868442</td><td>325</td><td>0</td><td>325</td><td>0</td><td>-0.717088</td><td>325.74405</td><td>0.0</td><td>0.0</td><td>95</td><td>False</td><td>--</td><td>1.2839941</td><td>0.056570467</td><td>-0.19961677</td><td>0.015470109</td><td>-0.18636444</td><td>-0.09788927</td><td>0.019295616</td><td>38</td><td>20</td><td>0.43101293</td><td>38</td><td>23</td><td>0</td><td>0.030880287</td><td>8.535898</td><td>0</td><td>0</td><td>0.97071016</td><td>0.22002906</td><td>0.28557843</td><td>0.20794256</td><td>0.4101255</td><td>-65.66478</td><td>0.8588567</td><td>-24.406776</td><td>-43.698612</td><td>False</td><td>320</td><td>364.00507922068095</td><td>0.90043736</td><td>404.25363</td><td>19.284597</td><td>34</td><td>137.15507118818775</td><td>11.79715</td><td>11.62612</td><td>19.995512</td><td>31</td><td>342.4081435440125</td><td>7.838386</td><td>43.683502</td><td>18.411535</td><td>1.3174629</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1.5839767</td><td>0.7109146</td><td>0.87306213</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.87962201372886</td><td>-16.801535222612248</td><td>84.66107447497244</td><td>-25.75581047640869</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>2.1622872e-10</td><td>1.3842859e-10</td><td>0.99999607</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.08112646296289025</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216444937178204160</td><td>3216444937178204160</td><td>1386239099</td><td>2016.0</td><td>85.19030586577739</td><td>0.07698814</td><td>-2.5028819323642013</td><td>0.06952155</td><td>0.49047638721509285</td><td>0.09691278</td><td>5.0610085</td><td>9.442557</td><td>7.014016212995759</td><td>0.09374031</td><td>-6.321825218787011</td><td>0.079626285</td><td>-0.054927044</td><td>0.02979098</td><td>-0.2849793</td><td>0.09145997</td><td>-0.34964725</td><td>0.09440442</td><td>-0.62761176</td><td>0.066617794</td><td>0.35496876</td><td>-0.08418727</td><td>381</td><td>0</td><td>381</td><td>0</td><td>2.634945</td><td>476.3032</td><td>0.30653253</td><td>2.2057276</td><td>95</td><td>False</td><td>--</td><td>1.4101175</td><td>0.020281127</td><td>-0.15829301</td><td>-0.032261044</td><td>-0.025952134</td><td>-0.049249224</td><td>0.06220646</td><td>43</td><td>21</td><td>0.13505712</td><td>43</td><td>25</td><td>0</td><td>0.023879923</td><td>9.0169325</td><td>1</td><td>0</td><td>1.0968245</td><td>0.20904742</td><td>0.29357752</td><td>0.24537306</td><td>0.4592325</td><td>-93.210556</td><td>0.81500864</td><td>-25.391544</td><td>-42.085728</td><td>False</td><td>373</td><td>1818.6555646912966</td><td>1.5091</td><td>1205.126</td><td>17.53799</td><td>38</td><td>663.8714987983407</td><td>11.664461</td><td>56.914032</td><td>18.283333</td><td>38</td><td>1679.6880569559742</td><td>12.2571</td><td>137.03796</td><td>16.684824</td><td>1.288622</td><td>0</td><td>2</td><td>0</td><td>0</td><td>0</td><td>1.5985088</td><td>0.74534225</td><td>0.8531666</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.97046839266432</td><td>-16.845058105618648</td><td>84.65904656064926</td><td>-25.85303525756708</td><td>False</td><td>False</td><td>0</td><td>True</td><td>False</td><td>False</td><td>False</td><td>False</td><td>True</td><td>True</td><td>False</td><td>2.1057866e-11</td><td>5.2152347e-13</td><td>0.9999929</td><td>4720.8716</td><td>4589.9756</td><td>4839.4907</td><td>4.6567</td><td>4.5776</td><td>4.7072</td><td>-2.2392</td><td>-2.4267</td><td>-1.7745</td><td>862.0521</td><td>812.244</td><td>948.8539</td><td>1.0476</td><td>0.9054</td><td>1.2078</td><td>0.7958</td><td>0.685</td><td>0.9228</td><td>0.4362</td><td>0.3746</td><td>0.5038</td><td>PHOENIX</td><td>0.08121814053391099</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216468782835372032</td><td>3216468782835372032</td><td>657511649</td><td>2016.0</td><td>85.17292618358479</td><td>0.19054802</td><td>-2.4623957493034743</td><td>0.17272547</td><td>2.1624020293821835</td><td>0.23938343</td><td>9.0332155</td><td>2.4493213</td><td>-2.037035196031785</td><td>0.2268017</td><td>1.3600228792903124</td><td>0.19178832</td><td>-0.14530747</td><td>0.112551525</td><td>-0.20920323</td><td>0.17061059</td><td>-0.3053354</td><td>0.17149667</td><td>-0.5708101</td><td>0.043384105</td><td>0.30095217</td><td>-0.20159128</td><td>352</td><td>0</td><td>351</td><td>1</td><td>-0.48073354</td><td>416.80234</td><td>0.59515935</td><td>1.1965727</td><td>95</td><td>False</td><td>--</td><td>1.0901086</td><td>0.05042796</td><td>-0.17146336</td><td>-0.0065654744</td><td>-0.110863455</td><td>-0.030477438</td><td>0.0075620045</td><td>40</td><td>20</td><td>0.33940324</td><td>40</td><td>23</td><td>0</td><td>0.030575372</td><td>178.93437</td><td>0</td><td>0</td><td>0.9807946</td><td>0.16747355</td><td>0.28867003</td><td>0.17314363</td><td>0.43588594</td><td>-74.866936</td><td>5.0166435</td><td>-23.469093</td><td>-43.28577</td><td>False</td><td>347</td><td>435.6715921697949</td><td>1.0631166</td><td>409.80606</td><td>19.089468</td><td>26</td><td>44.39955876616971</td><td>6.0446095</td><td>7.3453145</td><td>21.220095</td><td>38</td><td>673.5576808594151</td><td>8.575238</td><td>78.54682</td><td>17.676958</td><td>1.6479322</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>3.5431366</td><td>2.1306267</td><td>1.4125099</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.92457804544165</td><td>-16.841666317801355</td><td>84.64143853749016</td><td>-25.811932421839387</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>2.7495896e-13</td><td>5.0978774e-13</td><td>0.99999624</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.08200148643415694</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216455691775435392</td><td>3216455691775435392</td><td>1079684357</td><td>2016.0</td><td>85.30495708910514</td><td>1.4646537</td><td>-2.5178904392586623</td><td>1.198452</td><td>1.0621429300659084</td><td>1.496934</td><td>0.70954555</td><td>14.06971</td><td>2.362959871277592</td><td>1.4997277</td><td>-13.869864598271748</td><td>1.2972544</td><td>0.41949913</td><td>0.5497209</td><td>-0.122153305</td><td>-0.007439146</td><td>0.36512154</td><td>0.13959806</td><td>-0.49781814</td><td>0.08308936</td><td>-0.12201575</td><td>0.1388765</td><td>113</td><td>0</td><td>112</td><td>1</td><td>-1.8722427</td><td>109.50301</td><td>0.0</td><td>0.0</td><td>95</td><td>False</td><td>--</td><td>1.1160979</td><td>0.38008702</td><td>0.2803165</td><td>0.108602926</td><td>0.3289834</td><td>0.09997459</td><td>0.17758605</td><td>13</td><td>11</td><td>2.1380084</td><td>14</td><td>8</td><td>0</td><td>0.13895129</td><td>172.40553</td><td>0</td><td>0</td><td>0.87120515</td><td>0.36661693</td><td>0.3774008</td><td>0.22178955</td><td>0.376025</td><td>-25.664597</td><td>-18.63486</td><td>-15.046993</td><td>42.01079</td><td>False</td><td>111</td><td>83.73466570505262</td><td>0.9941574</td><td>84.22677</td><td>20.880104</td><td>8</td><td>48.316372981047714</td><td>11.551536</td><td>4.1826797</td><td>21.128307</td><td>11</td><td>143.12426368829165</td><td>13.869087</td><td>10.31966</td><td>19.358612</td><td>2.286277</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1.7696953</td><td>0.24820328</td><td>1.521492</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>207.03981962770035</td><td>-16.750522211440767</td><td>84.7856405966112</td><td>-25.872228605607752</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>1.2387219e-10</td><td>4.4580528e-08</td><td>0.99999696</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.08219069174617054</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216469847988496640</td><td>3216469847988496640</td><td>1750321072</td><td>2016.0</td><td>85.33205874915119</td><td>0.4250795</td><td>-2.425249860759321</td><td>0.37327173</td><td>0.22421272188486763</td><td>0.48120424</td><td>0.46594086</td><td>1.1375393</td><td>0.6146611315465014</td><td>0.53041315</td><td>-0.9571766658995218</td><td>0.43026003</td><td>-0.08336612</td><td>-0.04359924</td><td>-0.3503951</td><td>0.17059404</td><td>-0.22215058</td><td>0.20433807</td><td>-0.63215035</td><td>0.105049506</td><td>0.21047379</td><td>-0.11205828</td><td>395</td><td>0</td><td>393</td><td>2</td><td>3.2212033</td><td>549.23535</td><td>1.7964642</td><td>2.885576</td><td>95</td><td>False</td><td>--</td><td>1.0470759</td><td>0.107746</td><td>-0.16536176</td><td>-0.1214191</td><td>0.04378124</td><td>-0.12220128</td><td>0.12459754</td><td>46</td><td>21</td><td>0.7767407</td><td>50</td><td>31</td><td>0</td><td>0.016963525</td><td>142.54533</td><td>0</td><td>0</td><td>1.1170963</td><td>0.21057051</td><td>0.30917907</td><td>0.26333737</td><td>0.43816993</td><td>-90.41127</td><td>-5.9151006</td><td>-22.575792</td><td>-42.194275</td><td>False</td><td>384</td><td>176.802211701999</td><td>0.77002114</td><td>229.60695</td><td>20.068647</td><td>21</td><td>48.094409264223955</td><td>8.200751</td><td>5.8646345</td><td>21.133307</td><td>41</td><td>300.8747652262563</td><td>8.945304</td><td>33.63494</td><td>18.551931</td><td>1.9737829</td><td>0</td><td>1</td><td>0</td><td>2</td><td>0</td><td>2.5813751</td><td>1.0646591</td><td>1.516716</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.96721911695258</td><td>-16.683584284834694</td><td>84.81941412521121</td><td>-25.78062488637266</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>5.8075224e-13</td><td>6.0352385e-13</td><td>0.99999946</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.08234330900782977</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216470840133093504</td><td>3216470840133093504</td><td>400465001</td><td>2016.0</td><td>85.30747238821475</td><td>0.29184374</td><td>-2.38949359231377</td><td>0.26074883</td><td>0.12019260367543594</td><td>0.33985</td><td>0.35366368</td><td>5.1894574</td><td>1.7876459824526552</td><td>0.36385092</td><td>-4.871836205810002</td><td>0.2897296</td><td>-0.09265526</td><td>-0.0014098006</td><td>-0.31270424</td><td>0.17439121</td><td>-0.19470231</td><td>0.19349204</td><td>-0.57027817</td><td>0.14670835</td><td>0.18696235</td><td>-0.098352544</td><td>363</td><td>0</td><td>360</td><td>3</td><td>0.86954176</td><td>431.9599</td><td>0.8580658</td><td>1.1291534</td><td>95</td><td>False</td><td>--</td><td>1.1637046</td><td>0.07667623</td><td>-0.1388337</td><td>-0.07941982</td><td>-0.006895077</td><td>-0.116873085</td><td>0.1331642</td><td>43</td><td>20</td><td>0.52750075</td><td>45</td><td>28</td><td>0</td><td>0.0151079735</td><td>6.0423245</td><td>0</td><td>0</td><td>1.031905</td><td>0.20595434</td><td>0.25317675</td><td>0.2603947</td><td>0.5014082</td><td>-76.88399</td><td>-3.9765499</td><td>-21.605133</td><td>-43.848877</td><td>False</td><td>357</td><td>265.88909242259996</td><td>0.897993</td><td>296.0926</td><td>19.625616</td><td>34</td><td>51.091312482354034</td><td>6.8466034</td><td>7.462286</td><td>21.067675</td><td>41</td><td>406.2893467231781</td><td>8.791597</td><td>46.21337</td><td>18.225807</td><td>1.7201934</td><td>0</td><td>0</td><td>0</td><td>2</td><td>0</td><td>2.8418674</td><td>1.4420586</td><td>1.3998089</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>206.92225446615564</td><td>-16.6887610547889</td><td>84.7935869203766</td><td>-25.744006573347082</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>8.483602e-13</td><td>5.134769e-13</td><td>0.9999985</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.08269446496314736</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216443872025058816</td><td>3216443872025058816</td><td>925732867</td><td>2016.0</td><td>85.24559042309376</td><td>0.71123976</td><td>-2.535389226550673</td><td>0.73737574</td><td>0.8980238349417092</td><td>0.9670169</td><td>0.9286537</td><td>1.5929452</td><td>-1.4791026414262343</td><td>0.8477286</td><td>-0.5913795705051671</td><td>0.7786666</td><td>-0.2839063</td><td>0.3210551</td><td>-0.23774688</td><td>0.2605932</td><td>-0.51915574</td><td>0.22001855</td><td>-0.61014396</td><td>-0.19906428</td><td>0.4816959</td><td>-0.21136881</td><td>217</td><td>0</td><td>215</td><td>2</td><td>2.8487191</td><td>283.3687</td><td>1.5834634</td><td>1.1608537</td><td>95</td><td>False</td><td>--</td><td>1.6825651</td><td>0.205878</td><td>-0.3583018</td><td>0.26714784</td><td>-0.16991253</td><td>-0.030751199</td><td>-0.10089172</td><td>25</td><td>16</td><td>1.3951224</td><td>26</td><td>13</td><td>0</td><td>0.004611447</td><td>65.27896</td><td>0</td><td>0</td><td>1.1408558</td><td>0.35099515</td><td>0.18764296</td><td>0.354644</td><td>0.6033324</td><td>-63.270237</td><td>8.353648</td><td>-27.99232</td><td>-44.789764</td><td>False</td><td>213</td><td>116.43417552584557</td><td>0.8913834</td><td>130.62187</td><td>20.522165</td><td>16</td><td>50.024253993893815</td><td>9.838917</td><td>5.0843253</td><td>21.090591</td><td>22</td><td>124.74988720000201</td><td>8.939355</td><td>13.955133</td><td>19.507795</td><td>1.5010554</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1.5827961</td><td>0.56842613</td><td>1.01437</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>207.02730810483163</td><td>-16.811187434288154</td><td>84.71905604380503</td><td>-25.88755596761321</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>1.085153e-07</td><td>5.787982e-09</td><td>0.9999933</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.08286217986852269</td></tr>
<tr><td>1636148068921376768</td><td>Gaia DR3 3216455653128695936</td><td>3216455653128695936</td><td>1467422921</td><td>2016.0</td><td>85.29328038861492</td><td>0.2429748</td><td>-2.526244532656098</td><td>0.23323357</td><td>7.187770844565762</td><td>0.2993434</td><td>24.01179</td><td>36.290695</td><td>-33.9237172532513</td><td>0.2799555</td><td>12.891699735107602</td><td>0.25018305</td><td>-0.0739246</td><td>0.051945604</td><td>-0.34340528</td><td>0.11745921</td><td>-0.23482792</td><td>0.14009184</td><td>-0.67943627</td><td>-0.004798767</td><td>0.24896738</td><td>-0.115868084</td><td>302</td><td>0</td><td>300</td><td>2</td><td>0.91878456</td><td>374.8465</td><td>0.9050687</td><td>2.162002</td><td>95</td><td>False</td><td>--</td><td>1.15316</td><td>0.06230389</td><td>-0.1844487</td><td>-0.073425606</td><td>-0.014452084</td><td>-0.012071895</td><td>0.048439857</td><td>35</td><td>20</td><td>0.4237814</td><td>38</td><td>26</td><td>0</td><td>0.018915895</td><td>11.662993</td><td>0</td><td>0</td><td>1.0369805</td><td>0.22564329</td><td>0.2900915</td><td>0.27226767</td><td>0.43290338</td><td>-72.82827</td><td>0.47325253</td><td>-21.18871</td><td>-44.038074</td><td>False</td><td>291</td><td>415.48303554301236</td><td>1.1920303</td><td>348.55072</td><td>19.140984</td><td>26</td><td>54.11411024598962</td><td>8.189754</td><td>6.607538</td><td>21.005266</td><td>35</td><td>627.9098762932185</td><td>13.446248</td><td>46.697777</td><td>17.753153</td><td>1.6415206</td><td>0</td><td>1</td><td>0</td><td>2</td><td>0</td><td>3.2521133</td><td>1.8642826</td><td>1.3878307</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>NOT_AVAILABLE</td><td>207.04190534382894</td><td>-16.76473078701521</td><td>84.77234739467015</td><td>-25.880154554757564</td><td>False</td><td>False</td><td>0</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>False</td><td>8.234745e-13</td><td>1.9977706e-09</td><td>0.9999949</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td></td><td>0.08287548585527736</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reduced_query</span> <span class="o">=</span> <span class="n">gaia_query</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;phot_g_mean_mag&#39;</span><span class="p">]</span>
<span class="n">reduced_query</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;gaia_no_pm.cat&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.commented_header&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">reduced_query</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=183</i>
<table id="table139654321879120" class="table-striped table-bordered table-condensed">
<thead><tr><th>ra</th><th>dec</th><th>phot_g_mean_mag</th></tr></thead>
<thead><tr><th>deg</th><th>deg</th><th>mag</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float32</th></tr></thead>
<tr><td>85.25078206874738</td><td>-2.444257621037541</td><td>19.836756</td></tr>
<tr><td>85.24865858921503</td><td>-2.441354584616136</td><td>17.722948</td></tr>
<tr><td>85.25474417063919</td><td>-2.470084090608095</td><td>17.202978</td></tr>
<tr><td>85.26833524857398</td><td>-2.4416029853336667</td><td>20.263578</td></tr>
<tr><td>85.2386085747217</td><td>-2.462292300986681</td><td>20.337946</td></tr>
<tr><td>85.23467309871081</td><td>-2.4498085573057633</td><td>20.23374</td></tr>
<tr><td>85.27075582329469</td><td>-2.441307234608435</td><td>19.156166</td></tr>
<tr><td>85.25578005166672</td><td>-2.4765054474694934</td><td>20.352</td></tr>
<tr><td>85.27451682697576</td><td>-2.472305714228985</td><td>20.950966</td></tr>
<tr><td>...</td><td>...</td><td>...</td></tr>
<tr><td>85.31116982575814</td><td>-2.5106681948456453</td><td>19.762535</td></tr>
<tr><td>85.18852621317357</td><td>-2.405656267543347</td><td>19.284597</td></tr>
<tr><td>85.19030586577739</td><td>-2.5028819323642013</td><td>17.53799</td></tr>
<tr><td>85.17292618358479</td><td>-2.4623957493034743</td><td>19.089468</td></tr>
<tr><td>85.30495708910514</td><td>-2.5178904392586623</td><td>20.880104</td></tr>
<tr><td>85.33205874915119</td><td>-2.425249860759321</td><td>20.068647</td></tr>
<tr><td>85.30747238821475</td><td>-2.38949359231377</td><td>19.625616</td></tr>
<tr><td>85.24559042309376</td><td>-2.535389226550673</td><td>20.522165</td></tr>
<tr><td>85.29328038861492</td><td>-2.526244532656098</td><td>19.140984</td></tr>
</table></div></div></div>
</div>
</section>
<section id="create-a-catalog-of-gaia-dr3-sources-with-proper-motion-data">
<h3>2.2 Create a catalog of Gaia DR3 sources with Proper Motion Data  <a id="cat_pm"></a><a class="headerlink" href="#create-a-catalog-of-gaia-dr3-sources-with-proper-motion-data" title="Link to this heading">#</a></h3>
<p>This method uses the image FLT footprints and gives 161 sources, compared to 183 with the prior method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pm_cat</span> <span class="o">=</span> <span class="n">create_astrometric_catalog</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">)))</span>
<span class="n">pm_cat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;gaia_pm.cat&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.no_header&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">pm_cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025309190027 INFO src=drizzlepac.haputils.astrometric_utils- Getting catalog using: 
    http://gsss.stsci.edu/webservices/vo/CatalogSearch.aspx?RA=85.25358125611297&amp;DEC=-2.4517874752980333&amp;SR=0.07776447588540084&amp;FORMAT=CSV&amp;CAT=GAIAedr3&amp;MINDET=5&amp;EPOCH=2012.839
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025309190027 INFO src=drizzlepac.haputils.astrometric_utils- Created catalog &#39;ref_cat.ecsv&#39; with 161  sources
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>161
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-tweakreg">
<h3>2.3 Run <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> <a id="tweak"></a><a class="headerlink" href="#run-tweakreg" title="Link to this heading">#</a></h3>
<p>Next we run <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> on the visit-level drizzled (DRZ) images and align to the Gaia catalog with proper motion data.</p>
<p>Because the fit RMS values for the MAST products were large for some visits, we allow for a larger than usual search radius of 1”. We also set the <code class="docutils literal notranslate"><span class="pre">conv_width</span></code> value slightly higher than the recommended value of 2.5 for WFC3/IR data in order to use barely resolved sources for alignment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">refcat</span> <span class="o">=</span> <span class="s1">&#39;gaia_pm.cat&#39;</span>                    <span class="c1"># Use the catalog with proper motion data</span>

<span class="n">drz_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*drz.fits&#39;</span><span class="p">))</span>

<span class="n">tweakreg</span><span class="o">.</span><span class="n">TweakReg</span><span class="p">(</span><span class="n">drz_files</span><span class="p">,</span> 
                  <span class="n">imagefindcfg</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;conv_width&#39;</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">},</span> 
                  <span class="n">minobj</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                  <span class="n">shiftfile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                  <span class="n">outshifts</span><span class="o">=</span><span class="s1">&#39;shift_drz.txt&#39;</span><span class="p">,</span>
                  <span class="n">refcat</span><span class="o">=</span><span class="n">refcat</span><span class="p">,</span>
                  <span class="n">searchrad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">ylimit</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> 
                  <span class="n">nclip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">updatehdr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>       <span class="c1"># change later when you verify the alignment works</span>
                  <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># clear_output()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Setting up logfile :  tweakreg.log
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TweakReg Version 3.10.0 started at: 19:00:27.744 (05/11/2025) 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Version Information
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Python Version 3.11.14 | packaged by conda-forge | (main, Oct 22 2025, 22:46:25) [GCC 14.3.0]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy Version -&gt; 2.3.4 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>astropy Version -&gt; 7.1.1 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>stwcs Version -&gt; 1.7.5 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>photutils Version -&gt; 2.3.0 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finding shifts for: 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl50030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl51030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl52030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl53030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl54030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl55030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl56030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl57030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ibxl58030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl50030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl50030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:27.789 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 75 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl50030_drz.fits&#39;: 75
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl51030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl51030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:27.882 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 83 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl51030_drz.fits&#39;: 83
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl52030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl52030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:27.972 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 87 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl52030_drz.fits&#39;: 87
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl53030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl53030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:28.061 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 51 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl53030_drz.fits&#39;: 51
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl54030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl54030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:28.148 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 54 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl54030_drz.fits&#39;: 54
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl55030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl55030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:28.235 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 99 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl55030_drz.fits&#39;: 99
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl56030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl56030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:28.323 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 73 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl56030_drz.fits&#39;: 73
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl57030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl57030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:28.41 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 93 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl57030_drz.fits&#39;: 93
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  Source finding for image &#39;ibxl58030_drz.fits&#39;:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  #  Source finding for &#39;ibxl58030_drz.fits&#39;, EXT=(&#39;SCI&#39;, 1) started at: 19:00:28.500 (05/11/2025)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     Found 103 objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===  FINAL number of objects in image &#39;ibxl58030_drz.fits&#39;: 103
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===============================================================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing alignment in the projection plane defined by the WCS
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>derived from &#39;ibxl50030_drz.fits&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===============================================================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl50030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl50030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of 0.2027, -0.01949 with significance of 6.702 and 9 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 9 matches for ibxl50030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl50030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: -0.9148  YSH: -0.4434    ROT: 0.022802346    SCALE: 1.000451
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.051      FIT YRMS: 0.082  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.097      FIT MAE: 0.077  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 2.3e-06 (deg)   RMS_DEC: 2.6e-06 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  9  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl50030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 9
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 9
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 9
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 9
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl51030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl51030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of -0.1306, -0.2973 with significance of 3.909 and 12 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 12 matches for ibxl51030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl51030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: -0.0950  YSH: -0.6794    ROT: 359.9831545    SCALE: 1.000220
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.039      FIT YRMS: 0.043  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.058      FIT MAE: 0.056  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 1.6e-06 (deg)   RMS_DEC: 1.3e-06 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  12  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl51030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl52030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl52030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of 0.2027, -0.6723 with significance of 6.702 and 8 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 8 matches for ibxl52030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl52030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: -0.5099  YSH: -0.3491    ROT: 0.001210839284    SCALE: 0.999709
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.038      FIT YRMS: 0.018  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.042      FIT MAE: 0.037  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 1.4e-06 (deg)   RMS_DEC: 4.3e-07 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  8  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl52030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl53030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl53030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of 0.2027, -0.7973 with significance of 5 and 5 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 5 matches for ibxl53030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl53030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: -0.2544  YSH: -0.8531    ROT: 359.9968781    SCALE: 1.000185
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.052      FIT YRMS: 0.053  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.074      FIT MAE: 0.062  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 2.1e-06 (deg)   RMS_DEC: 1.6e-06 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  5  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl53030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl54030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl54030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of 0.2027, -0.7973 with significance of 7 and 7 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 7 matches for ibxl54030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl54030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: -0.1959  YSH: -0.9179    ROT: 359.9732889    SCALE: 0.999206
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.033      FIT YRMS: 0.049  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.059      FIT MAE: 0.049  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 1.4e-06 (deg)   RMS_DEC: 1.5e-06 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  7  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl54030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl55030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl55030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of 0.02091, -0.4336 with significance of 5.326 and 11 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 10 matches for ibxl55030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl55030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: -0.0106  YSH: -0.4748    ROT: 359.9953351    SCALE: 1.000175
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.054      FIT YRMS: 0.039  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.066      FIT MAE: 0.06   
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 2.1e-06 (deg)   RMS_DEC: 1.1e-06 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  10  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl55030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl56030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl56030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of 0.2027, -0.7973 with significance of 5 and 5 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 5 matches for ibxl56030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl56030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: -0.1540  YSH: -0.5500    ROT: 359.9989578    SCALE: 1.000177
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.14       FIT YRMS: 0.065  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.15       FIT MAE: 0.12   
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 5.1e-06 (deg)   RMS_DEC: 1.5e-06 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  5  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl56030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl57030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl57030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of 0.2027, 0.2027 with significance of 12 and 12 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 12 matches for ibxl57030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl57030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: 0.0105  YSH: 0.0838    ROT: 0.001620903605    SCALE: 1.000051
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.038      FIT YRMS: 0.052  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.064      FIT MAE: 0.055  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 1.6e-06 (deg)   RMS_DEC: 1.6e-06 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  12  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl57030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing fit for: ibxl58030_drz.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matching sources from &#39;ibxl58030_drz.fits&#39; with sources from reference catalog &#39;gaia_pm.cat&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found initial X and Y shifts of 0.0694, 0.2027 with significance of 12.52 and 15 matches
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 14 matches for ibxl58030_drz.fits...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed  rscale  fit for  ibxl58030_drz.fits : 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>XSH: 0.0134  YSH: 0.0520    ROT: 359.998648    SCALE: 0.999998
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT XRMS: 0.073      FIT YRMS: 0.051  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIT RMSE: 0.089      FIT MAE: 0.072  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS_RA: 2.8e-06 (deg)   RMS_DEC: 1.4e-06 (deg)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final solution based on  14  objects.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wrote XY data to:  ibxl58030_drz_catalog_fit.match
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total # points: 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># of points after clipping: 14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing out shiftfile : shift_drz.txt
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trailer file written to:  tweakreg.log
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/44fab8877b23b8cb21e4bb49c57752a2915c1e2c9cf4ac2c9dffd1c0a4be33eb.png"><img alt="../../../_images/44fab8877b23b8cb21e4bb49c57752a2915c1e2c9cf4ac2c9dffd1c0a4be33eb.png" src="../../../_images/44fab8877b23b8cb21e4bb49c57752a2915c1e2c9cf4ac2c9dffd1c0a4be33eb.png" style="width: 546px; height: 454px;" />
</a>
<a class="reference internal image-reference" href="../../../_images/06f040261fe1b880be3ee8aeda639805f4ddbfee987a0f4ae00ef5f9ffac4b4c.png"><img alt="../../../_images/06f040261fe1b880be3ee8aeda639805f4ddbfee987a0f4ae00ef5f9ffac4b4c.png" src="../../../_images/06f040261fe1b880be3ee8aeda639805f4ddbfee987a0f4ae00ef5f9ffac4b4c.png" style="width: 698px; height: 455px;" />
</a>
<a class="reference internal image-reference" href="../../../_images/bda46119d668a5495d73d3fe9155361f82206b9a7033fd061a78c8e197d4a24c.png"><img alt="../../../_images/bda46119d668a5495d73d3fe9155361f82206b9a7033fd061a78c8e197d4a24c.png" src="../../../_images/bda46119d668a5495d73d3fe9155361f82206b9a7033fd061a78c8e197d4a24c.png" style="width: 572px; height: 476px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If the alignment is unsuccessful, stop the notebook</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;shift_drz.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">shift</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line_number</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shift</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;nan&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;nan found in line </span><span class="si">{</span><span class="n">line_number</span><span class="si">}</span><span class="s1"> in shift file&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="inspect-the-shift-file-and-fit-quality">
<h3>2.4 Inspect the shift file and fit quality <a id="fit_quality"></a><a class="headerlink" href="#inspect-the-shift-file-and-fit-quality" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the shift file just created by tweakreg</span>
<span class="c1"># There are 7 columns including: filename, x-shift, y-shift, rotation, scale, x-RMS, and y-RMS</span>
<span class="n">shift_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;shift_drz.txt&#39;</span><span class="p">,</span>
                         <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.no_header&#39;</span><span class="p">,</span> 
                         <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="s1">&#39;dx&#39;</span><span class="p">,</span> <span class="s1">&#39;dy&#39;</span><span class="p">,</span> <span class="s1">&#39;rot&#39;</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;xrms&#39;</span><span class="p">,</span> <span class="s1">&#39;yrms&#39;</span><span class="p">])</span>

<span class="c1"># Define the format for each column (excluding &#39;file&#39;).</span>
<span class="n">formats</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.2f&#39;</span><span class="p">,</span> <span class="s1">&#39;.2f&#39;</span><span class="p">,</span> <span class="s1">&#39;.3f&#39;</span><span class="p">,</span> <span class="s1">&#39;.5f&#39;</span><span class="p">,</span> <span class="s1">&#39;.2f&#39;</span><span class="p">,</span> <span class="s1">&#39;.2f&#39;</span><span class="p">]</span>

<span class="c1"># Iterate over the columns &#39;dx&#39;, &#39;dy&#39;, &#39;rot&#39;, &#39;scale&#39;, &#39;xrms&#39;, &#39;yrms&#39;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shift_table</span><span class="o">.</span><span class="n">colnames</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="c1"># Apply the format to the current column </span>
    <span class="n">shift_table</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">formats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
<span class="c1"># Display the table in the notebook</span>
<span class="n">shift_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=9</i>
<table id="table139654309056016" class="table-striped table-bordered table-condensed">
<thead><tr><th>file</th><th>dx</th><th>dy</th><th>rot</th><th>scale</th><th>xrms</th><th>yrms</th></tr></thead>
<thead><tr><th>str18</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>ibxl50030_drz.fits</td><td>-0.91</td><td>-0.44</td><td>0.023</td><td>1.00045</td><td>0.05</td><td>0.08</td></tr>
<tr><td>ibxl51030_drz.fits</td><td>-0.10</td><td>-0.68</td><td>359.983</td><td>1.00022</td><td>0.04</td><td>0.04</td></tr>
<tr><td>ibxl52030_drz.fits</td><td>-0.51</td><td>-0.35</td><td>0.001</td><td>0.99971</td><td>0.04</td><td>0.02</td></tr>
<tr><td>ibxl53030_drz.fits</td><td>-0.25</td><td>-0.85</td><td>359.997</td><td>1.00019</td><td>0.05</td><td>0.05</td></tr>
<tr><td>ibxl54030_drz.fits</td><td>-0.20</td><td>-0.92</td><td>359.973</td><td>0.99921</td><td>0.03</td><td>0.05</td></tr>
<tr><td>ibxl55030_drz.fits</td><td>-0.01</td><td>-0.47</td><td>359.995</td><td>1.00018</td><td>0.05</td><td>0.04</td></tr>
<tr><td>ibxl56030_drz.fits</td><td>-0.15</td><td>-0.55</td><td>359.999</td><td>1.00018</td><td>0.14</td><td>0.06</td></tr>
<tr><td>ibxl57030_drz.fits</td><td>0.01</td><td>0.08</td><td>0.002</td><td>1.00005</td><td>0.04</td><td>0.05</td></tr>
<tr><td>ibxl58030_drz.fits</td><td>0.01</td><td>0.05</td><td>359.999</td><td>1.00000</td><td>0.07</td><td>0.05</td></tr>
</table></div></div></div>
</div>
<p>Note that there are large residual rotation and scale terms in the shift file for several visits in the MAST data products.  These will be corrected when we run <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> an additional time and update the WCS in Section 2.6 below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">match_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*_drz_catalog_fit.match&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">match_files</span><span class="p">:</span>
    <span class="nb">input</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of matches for </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of matches for ibxl50030_drz_catalog_fit.match 9
Number of matches for ibxl51030_drz_catalog_fit.match 12
Number of matches for ibxl52030_drz_catalog_fit.match 8
Number of matches for ibxl53030_drz_catalog_fit.match 5
Number of matches for ibxl54030_drz_catalog_fit.match 7
Number of matches for ibxl55030_drz_catalog_fit.match 10
Number of matches for ibxl56030_drz_catalog_fit.match 5
Number of matches for ibxl57030_drz_catalog_fit.match 12
Number of matches for ibxl58030_drz_catalog_fit.match 14
</pre></div>
</div>
</div>
</div>
<p>Next we compare with the MAST WCS solutions, number of matches and fit RMS values. Since there are only 5 Gaia sources in Visits 53 and 56, these did not have a successful Gaia fit during MAST processing and instead were aligned to the next catalog in the priority list, GSC v2.4.2. (Currently the minimum number of matches for a successful fit is 6, but this will updated to 10 in summer 2024.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcstable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=9</i>
<table id="table139654334914320" class="table-striped table-bordered table-condensed">
<thead><tr><th>FILENAME</th><th>DETECTOR</th><th>WCSNAME</th><th>NMATCHES</th><th>RMS_RA</th><th>RMS_DEC</th><th>RMS_RA_pix</th><th>RMS_DEC_pix</th></tr></thead>
<thead><tr><th>str18</th><th>str2</th><th>str30</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>ibxl50030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_REL_GSC242</td><td>18</td><td>66.6</td><td>52.5</td><td>0.52</td><td>0.41</td></tr>
<tr><td>ibxl51030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_REL_GSC242</td><td>31</td><td>73.7</td><td>86.3</td><td>0.57</td><td>0.67</td></tr>
<tr><td>ibxl52030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_IMG_GSC242</td><td>20</td><td>58.5</td><td>66.1</td><td>0.46</td><td>0.51</td></tr>
<tr><td>ibxl53030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_REL_GSC242</td><td>12</td><td>55.6</td><td>75.8</td><td>0.43</td><td>0.59</td></tr>
<tr><td>ibxl54030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_REL_GSC242</td><td>14</td><td>72.8</td><td>88.0</td><td>0.57</td><td>0.69</td></tr>
<tr><td>ibxl55030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_REL_GSC242</td><td>19</td><td>63.5</td><td>86.9</td><td>0.49</td><td>0.68</td></tr>
<tr><td>ibxl56030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_REL_GSC242</td><td>18</td><td>61.9</td><td>93.4</td><td>0.48</td><td>0.73</td></tr>
<tr><td>ibxl57030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_REL_GAIAeDR3</td><td>12</td><td>5.8</td><td>6.5</td><td>0.05</td><td>0.05</td></tr>
<tr><td>ibxl58030_drz.fits</td><td>IR</td><td>IDC_w3m18525i-FIT_REL_GAIAeDR3</td><td>15</td><td>11.5</td><td>6.8</td><td>0.09</td><td>0.05</td></tr>
</table></div></div></div>
</div>
</section>
<section id="overplot-matched-sources-and-inspect-fit-residuals">
<h3>2.5 Overplot matched sources and inspect fit residuals <a id="overplot"></a><a class="headerlink" href="#overplot-matched-sources-and-inspect-fit-residuals" title="Link to this heading">#</a></h3>
<p>Here we overplot the HST sources which were successfully matched with Gaia eDR3 and we look at the astrometric fit residual PNG plots.</p>
<p>While we inspect only two visits (52 and 53) at a time, and additional visits may be uncommented in the cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the rootnames for the two FITS files to be compared</span>
<span class="c1"># Uncomment the pairs you want to use</span>

<span class="c1"># rootname_A = &#39;ibxl50030&#39;</span>
<span class="c1"># rootname_B = &#39;ibxl51030&#39;</span>
<span class="n">rootname_A</span> <span class="o">=</span> <span class="s1">&#39;ibxl52030&#39;</span>
<span class="n">rootname_B</span> <span class="o">=</span> <span class="s1">&#39;ibxl53030&#39;</span>
<span class="c1"># rootname_A = &#39;ibxl54030&#39;</span>
<span class="c1"># rootname_B = &#39;ibxl55030&#39;</span>
<span class="c1"># rootname_A = &#39;ibxl56030&#39;</span>
<span class="c1"># rootname_B = &#39;ibxl57030&#39;</span>
<span class="c1"># rootname_A = &#39;ibxl57030&#39;</span>
<span class="c1"># rootname_B = &#39;ibxl58030&#39;</span>

<span class="c1"># Create subplots with 1 row and 2 columns</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Open the FITS files and extract the data from the &#39;SCI&#39; extension</span>
<span class="n">data_a</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">rootname_A</span><span class="o">+</span><span class="s1">&#39;_drz.fits&#39;</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">data_b</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">rootname_B</span><span class="o">+</span><span class="s1">&#39;_drz.fits&#39;</span><span class="p">)[</span><span class="s1">&#39;SCI&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Display the images in grayscale with a stretch from 0 to 2 </span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_a</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_b</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Read the matching catalog files for both rootnames</span>
<span class="n">match_tab_a</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">rootname_A</span><span class="o">+</span><span class="s1">&#39;_drz_catalog_fit.match&#39;</span><span class="p">)</span>
<span class="n">match_tab_b</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">rootname_B</span><span class="o">+</span><span class="s1">&#39;_drz_catalog_fit.match&#39;</span><span class="p">)</span>

<span class="c1"># Extract x and y coordinates from the matching catalogs</span>
<span class="n">x_coord_a</span><span class="p">,</span> <span class="n">y_coord_a</span> <span class="o">=</span> <span class="n">match_tab_a</span><span class="p">[</span><span class="s1">&#39;col11&#39;</span><span class="p">],</span> <span class="n">match_tab_a</span><span class="p">[</span><span class="s1">&#39;col12&#39;</span><span class="p">]</span>
<span class="n">x_coord_b</span><span class="p">,</span> <span class="n">y_coord_b</span> <span class="o">=</span> <span class="n">match_tab_b</span><span class="p">[</span><span class="s1">&#39;col11&#39;</span><span class="p">],</span> <span class="n">match_tab_b</span><span class="p">[</span><span class="s1">&#39;col12&#39;</span><span class="p">]</span>

<span class="c1"># Plot the coordinates on the images with red circles</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_coord_a</span><span class="p">,</span> <span class="n">y_coord_a</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_coord_b</span><span class="p">,</span> <span class="n">y_coord_b</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>

<span class="c1"># Set the titles for the subplots, including the number of matches</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">rootname_A</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;  N = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">match_tab_a</span><span class="p">)</span><span class="si">}</span><span class="s1">  Gaia Matches&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">rootname_B</span><span class="o">+</span><span class="sa">f</span><span class="s1">&#39;  N = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">match_tab_b</span><span class="p">)</span><span class="si">}</span><span class="s1">  Gaia Matches&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Load, display, and inspect fit residual PNG files</span>
<span class="n">img_A</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;residuals_</span><span class="si">{</span><span class="n">rootname_A</span><span class="si">}</span><span class="s1">_drz.png&#39;</span><span class="p">)</span>
<span class="n">img_B</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;residuals_</span><span class="si">{</span><span class="n">rootname_B</span><span class="si">}</span><span class="s1">_drz.png&#39;</span><span class="p">)</span>

<span class="c1"># Create subplots for the residual images</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_A</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_B</span><span class="p">)</span>

<span class="c1"># Remove unnecessary axis from the residual images</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span> 
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Adjust layout to minimize margins and display plots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../../_images/ea2bb2b697ef234ee29a9b4fb3463697058daf2eceb663e2c0367169b33746ef.png"><img alt="../../../_images/ea2bb2b697ef234ee29a9b4fb3463697058daf2eceb663e2c0367169b33746ef.png" src="../../../_images/ea2bb2b697ef234ee29a9b4fb3463697058daf2eceb663e2c0367169b33746ef.png" style="width: 1290px; height: 619px;" />
</a>
<a class="reference internal image-reference" href="../../../_images/e5b2d48ac96d33e253972619ec0d0c596cabfe38e2f8e46545e856c26874b915.png"><img alt="../../../_images/e5b2d48ac96d33e253972619ec0d0c596cabfe38e2f8e46545e856c26874b915.png" src="../../../_images/e5b2d48ac96d33e253972619ec0d0c596cabfe38e2f8e46545e856c26874b915.png" style="width: 3980px; height: 1506px;" />
</a>
</div>
</div>
</section>
<section id="rerun-tweakreg-and-update-the-header-wcs">
<h3>2.6 Rerun <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> and update the header WCS <a id="updatehdr"></a><a class="headerlink" href="#rerun-tweakreg-and-update-the-header-wcs" title="Link to this heading">#</a></h3>
<p>Once we are happy with the alignment, we run <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> again with the same parameters but with the <code class="docutils literal notranslate"><span class="pre">updatehdr=True</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">refcat</span> <span class="o">=</span> <span class="s1">&#39;gaia_pm.cat&#39;</span>    <span class="c1"># Use the catalog with proper motion data</span>

<span class="n">tweakreg</span><span class="o">.</span><span class="n">TweakReg</span><span class="p">(</span><span class="n">drz_files</span><span class="p">,</span> 
                  <span class="n">imagefindcfg</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;conv_width&#39;</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">},</span> 
                  <span class="n">minobj</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                  <span class="n">shiftfile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                  <span class="n">refcat</span><span class="o">=</span><span class="n">refcat</span><span class="p">,</span>
                  <span class="n">searchrad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">ylimit</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> 
                  <span class="n">nclip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">updatehdr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>       <span class="c1"># update header</span>
                  <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-tweakback-to-propogate-the-wcs-to-the-flt-files">
<h3>2.7 Run <code class="docutils literal notranslate"><span class="pre">TweakBack</span></code> to propogate the WCS to the FLT files <a id="tweakback"></a><a class="headerlink" href="#run-tweakback-to-propogate-the-wcs-to-the-flt-files" title="Link to this heading">#</a></h3>
<p>Finally, we run <code class="docutils literal notranslate"><span class="pre">Tweakback</span></code> on the aligned DRZ files to propogate the updated WCS information back to the FLT files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">drz_files</span><span class="p">:</span>
    <span class="n">tb_input</span> <span class="o">=</span> <span class="n">f</span><span class="o">+</span><span class="s1">&#39;[sci,1]&#39;</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
        <span class="n">tweakback</span><span class="o">.</span><span class="n">apply_tweak</span><span class="p">(</span><span class="n">tb_input</span><span class="p">,</span> <span class="n">orig_wcs_name</span><span class="o">=</span><span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;WCSNAME&#39;</span><span class="p">])</span>
    
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="compare-skymethod-options-in-astrodrizzle">
<h2>3. Compare  <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> options in AstroDrizzle <a id="compare"></a><a class="headerlink" href="#compare-skymethod-options-in-astrodrizzle" title="Link to this heading">#</a></h2>
<p>Now that the FLT files contain the updated WCS solutions, we explore different algorithms for estimating the sky.</p>
<section id="skymethod-localmin">
<h3>3.1 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'localmin'</span></code> <a id="localmin"></a><a class="headerlink" href="#skymethod-localmin" title="Link to this heading">#</a></h3>
<p>When using <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> to compute the sky in each frame, ‘localmin’ will compute a common sky value for all chips of a given exposure, using the minimum sky value from all chips. This process is repeated for each input image. This algorithm is recommended when images are dominated by blank sky instead of extended, diffuse sources.</p>
<p>See <a class="reference external" href="https://drizzlepac.readthedocs.io/en/deployment/sky.html#drizzlepac.sky.sky">readthedocs</a> for more details on sky subtraction options.</p>
<p>In the command below, the aligned FLT frames are sky subtracted and drizzled together.</p>
<p>Because the WFC3/IR data products are already cleaned of cosmic rays during calwf3 processing, cosmic-ray rejection is turned off in AstroDrizzle by setting the parameters <code class="docutils literal notranslate"><span class="pre">driz_separate</span></code>, <code class="docutils literal notranslate"><span class="pre">median</span></code>, <code class="docutils literal notranslate"><span class="pre">blot</span></code>, and <code class="docutils literal notranslate"><span class="pre">driz_cr</span></code> to ‘False’. Note that <code class="docutils literal notranslate"><span class="pre">final_bits=16</span></code> means only the stable hot pixels are treated as good.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sky</span> <span class="o">=</span> <span class="s1">&#39;localmin&#39;</span>
<span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span> 
                          <span class="n">output</span><span class="o">=</span><span class="s1">&#39;f160w_localmin&#39;</span><span class="p">,</span>
                          <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                          <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">skymethod</span><span class="o">=</span><span class="n">sky</span><span class="p">,</span> 
                          <span class="n">driz_separate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">driz_cr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># CR-rej turned off</span>
                          <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">,</span>
                          <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                          <span class="n">final_rot</span><span class="o">=</span><span class="mf">257.</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="skymethod-match">
<h3>3.2 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'match'</span></code> <a id="match"></a><a class="headerlink" href="#skymethod-match" title="Link to this heading">#</a></h3>
<p>When <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> is set to ‘match’, differences in sky values between images in common sky regions will be computed. Thus, sky values will be relative (delta) to the sky computed in one of the input images whose sky value will be set to and reported as 0. This setting “equalizes” sky values between the images in large mosaics.</p>
<p>This is the <strong>recommended</strong> setting for images containing diffuse sources (e.g., galaxies, nebulae) covering significant parts of the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sky</span> <span class="o">=</span> <span class="s1">&#39;match&#39;</span>
<span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span> 
                          <span class="n">output</span><span class="o">=</span><span class="s1">&#39;f160w_match&#39;</span><span class="p">,</span>
                          <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                          <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">skymethod</span><span class="o">=</span><span class="n">sky</span><span class="p">,</span> 
                          <span class="n">driz_separate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">driz_cr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># CRREJ=None</span>
                          <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">,</span>
                          <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                          <span class="n">final_rot</span><span class="o">=</span><span class="mf">257.</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="skymethod-globalmin-match">
<h3>3.3 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'globalmin+match'</span></code> <a id="globalminmatch"></a><a class="headerlink" href="#skymethod-globalmin-match" title="Link to this heading">#</a></h3>
<p>When <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> is set to ‘globalmin+match’, AstroDrizzle will first find a minimum “global” sky value in all input images and then use the ‘match’ method to equalize sky values between images.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sky</span> <span class="o">=</span> <span class="s1">&#39;globalmin+match&#39;</span>
<span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span> 
                          <span class="n">output</span><span class="o">=</span><span class="s1">&#39;f160w_globalmin_match&#39;</span><span class="p">,</span>
                          <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                          <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">skymethod</span><span class="o">=</span><span class="n">sky</span><span class="p">,</span> 
                          <span class="n">driz_separate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">driz_cr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># CRREJ=None</span>
                          <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">,</span>
                          <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                          <span class="n">final_rot</span><span class="o">=</span><span class="mf">257.</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="skymethod-globalmin">
<h3>3.4 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'globalmin'</span></code> <a id="globalmin"></a><a class="headerlink" href="#skymethod-globalmin" title="Link to this heading">#</a></h3>
<p>When <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> is set to ‘globalmin’, a common sky value will be computed for all exposures. AstroDrizzle will compute sky values for each chip/image extension, find the minimum sky value from all the exposures, and then subtract that minimum sky value from all chips in all images.</p>
<p>This method may be useful when input images already have matched background values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sky</span> <span class="o">=</span> <span class="s1">&#39;globalmin&#39;</span>
<span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span> 
                          <span class="n">output</span><span class="o">=</span><span class="s1">&#39;f160w_globalmin&#39;</span><span class="p">,</span>
                          <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                          <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">skymethod</span><span class="o">=</span><span class="n">sky</span><span class="p">,</span> 
                          <span class="n">driz_separate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">driz_cr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># CRREJ=None</span>
                          <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">,</span>
                          <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                          <span class="n">final_rot</span><span class="o">=</span><span class="mf">257.</span><span class="p">)</span>
<span class="n">clear_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="compare-the-mdrizsky-values-for-each-method">
<h2>4. Compare the MDRIZSKY values for each method <a id="mdrizsky"></a><a class="headerlink" href="#compare-the-mdrizsky-values-for-each-method" title="Link to this heading">#</a></h2>
<p>Below we provide a gif comparing the upper portion of the final drizzled image. We cycle through three drizzled images produced using different <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> algorithms:</p>
<p><img alt="The top of the horsehead nebula is shown in grayscale with a stretch of about -0.4 to 2 and the animated gif transitions between displaying the &quot;localmin&quot;, &quot;match&quot;, and &quot;globalmin+match&quot; sky methods from astrodrizzle. Localmin looks the worst with unmatched backgrounds in the top left and right corners where the outline of separate pointings (dithers) are apparent." src="../../../_images/labeled_local_globalmatch_match.gif" /></p>
<p>Next we print the sky values computed for each image using the four different methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mdrizsky_val</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;rootname&#39;</span><span class="p">:</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;f160w_globalmin_drz_sci.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;rootname&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;local&#39;</span><span class="p">:</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;f160w_localmin_drz_sci.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;mdrizsky&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;globalmin&#39;</span><span class="p">:</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;f160w_globalmin_drz_sci.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;mdrizsky&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;globalmin_match&#39;</span><span class="p">:</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;f160w_globalmin_match_drz_sci.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;mdrizsky&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;match&#39;</span><span class="p">:</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;f160w_match_drz_sci.fits&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;mdrizsky&#39;</span><span class="p">]})</span>
<span class="n">mdrizsky_val</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rootname</th>
      <th>local</th>
      <th>globalmin</th>
      <th>globalmin_match</th>
      <th>match</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ibxl50clq</td>
      <td>1.150338</td>
      <td>0.795985</td>
      <td>0.799595</td>
      <td>0.032796</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ibxl50cqq</td>
      <td>1.162587</td>
      <td>0.795985</td>
      <td>0.795926</td>
      <td>0.029128</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ibxl51eoq</td>
      <td>1.173177</td>
      <td>0.795985</td>
      <td>0.810412</td>
      <td>0.043613</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ibxl51etq</td>
      <td>1.170005</td>
      <td>0.795985</td>
      <td>0.799362</td>
      <td>0.032563</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ibxl52k0q</td>
      <td>0.801102</td>
      <td>0.795985</td>
      <td>0.801102</td>
      <td>0.034303</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ibxl52k5q</td>
      <td>0.795985</td>
      <td>0.795985</td>
      <td>0.789244</td>
      <td>0.022445</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ibxl53kxq</td>
      <td>1.202108</td>
      <td>0.795985</td>
      <td>0.813771</td>
      <td>0.046972</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ibxl53l9q</td>
      <td>1.183192</td>
      <td>0.795985</td>
      <td>0.793237</td>
      <td>0.026439</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ibxl54bgq</td>
      <td>1.169292</td>
      <td>0.795985</td>
      <td>0.792419</td>
      <td>0.025620</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ibxl54blq</td>
      <td>1.162808</td>
      <td>0.795985</td>
      <td>0.787202</td>
      <td>0.020403</td>
    </tr>
    <tr>
      <th>10</th>
      <td>ibxl55f0q</td>
      <td>1.005760</td>
      <td>0.795985</td>
      <td>0.784272</td>
      <td>0.017473</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ibxl55f5q</td>
      <td>1.008806</td>
      <td>0.795985</td>
      <td>0.784592</td>
      <td>0.017793</td>
    </tr>
    <tr>
      <th>12</th>
      <td>ibxl56huq</td>
      <td>1.362592</td>
      <td>0.795985</td>
      <td>0.796189</td>
      <td>0.029390</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ibxl56i2q</td>
      <td>1.361517</td>
      <td>0.795985</td>
      <td>0.791313</td>
      <td>0.024514</td>
    </tr>
    <tr>
      <th>14</th>
      <td>ibxl57adq</td>
      <td>1.132586</td>
      <td>0.795985</td>
      <td>0.774923</td>
      <td>0.008124</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ibxl57aiq</td>
      <td>1.119377</td>
      <td>0.795985</td>
      <td>0.774029</td>
      <td>0.007230</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ibxl58sqq</td>
      <td>0.804761</td>
      <td>0.795985</td>
      <td>0.768317</td>
      <td>0.001518</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ibxl58svq</td>
      <td>0.799282</td>
      <td>0.795985</td>
      <td>0.766799</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These computed sky values can be visualized in the plot below. To reiterate, the MDRIZSKY keyword reports the value subtracted from each FLC image prior to drizzling, and not the sky level itself. Thus the values for <code class="docutils literal notranslate"><span class="pre">skymethod='match'</span></code> are close to zero.</p>
<p>We also note that varying background levels across the individual tiles result in inaccurate sky background determination when <code class="docutils literal notranslate"><span class="pre">skymethod='localmin'</span></code> and thus a mismatched sky in the final mosaic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">mdrizsky_val</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">globalmin</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mdrizsky_val</span><span class="p">[</span><span class="s1">&#39;globalmin&#39;</span><span class="p">])</span>
<span class="n">globalmin_match</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mdrizsky_val</span><span class="p">[</span><span class="s1">&#39;globalmin_match&#39;</span><span class="p">])</span>
<span class="n">match</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mdrizsky_val</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">])</span>
<span class="n">local</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mdrizsky_val</span><span class="p">[</span><span class="s1">&#39;local&#39;</span><span class="p">])</span>

<span class="c1"># Plotting code: </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">globalmin_match</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Globalmin + Match&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">match</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Match&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Local&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">globalmin</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Globalmin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Individual Images&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MDRIZSKY Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../../_images/44fab8877b23b8cb21e4bb49c57752a2915c1e2c9cf4ac2c9dffd1c0a4be33eb.png"><img alt="../../../_images/44fab8877b23b8cb21e4bb49c57752a2915c1e2c9cf4ac2c9dffd1c0a4be33eb.png" src="../../../_images/44fab8877b23b8cb21e4bb49c57752a2915c1e2c9cf4ac2c9dffd1c0a4be33eb.png" style="width: 546px; height: 454px;" />
</a>
<a class="reference internal image-reference" href="../../../_images/06f040261fe1b880be3ee8aeda639805f4ddbfee987a0f4ae00ef5f9ffac4b4c.png"><img alt="../../../_images/06f040261fe1b880be3ee8aeda639805f4ddbfee987a0f4ae00ef5f9ffac4b4c.png" src="../../../_images/06f040261fe1b880be3ee8aeda639805f4ddbfee987a0f4ae00ef5f9ffac4b4c.png" style="width: 698px; height: 455px;" />
</a>
<a class="reference internal image-reference" href="../../../_images/bda46119d668a5495d73d3fe9155361f82206b9a7033fd061a78c8e197d4a24c.png"><img alt="../../../_images/bda46119d668a5495d73d3fe9155361f82206b9a7033fd061a78c8e197d4a24c.png" src="../../../_images/bda46119d668a5495d73d3fe9155361f82206b9a7033fd061a78c8e197d4a24c.png" style="width: 572px; height: 476px;" />
</a>
<a class="reference internal image-reference" href="../../../_images/162e1cff9d07f09b28ce185b429c7f027f57d0a0a38f9296446d47ae1465e7b2.png"><img alt="../../../_images/162e1cff9d07f09b28ce185b429c7f027f57d0a0a38f9296446d47ae1465e7b2.png" src="../../../_images/162e1cff9d07f09b28ce185b429c7f027f57d0a0a38f9296446d47ae1465e7b2.png" style="width: 690px; height: 690px;" />
</a>
</div>
</div>
</section>
<section id="display-the-sky-matched-science-mosaic-and-weight-image">
<h2>5. Display the ‘sky matched’ science mosaic and weight image <a id="display"></a><a class="headerlink" href="#display-the-sky-matched-science-mosaic-and-weight-image" title="Link to this heading">#</a></h2>
<p>Finally, we display the science and weight images for the combined mosaic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sci</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;f160w_match_drz_sci.fits&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">130</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../../_images/11f27996952dda66c8a373e0604cb8f9ea719d3541963183f005ef4c6d0f7817.png"><img alt="../../../_images/11f27996952dda66c8a373e0604cb8f9ea719d3541963183f005ef4c6d0f7817.png" src="../../../_images/11f27996952dda66c8a373e0604cb8f9ea719d3541963183f005ef4c6d0f7817.png" style="width: 1024px; height: 929px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sci</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;f160w_match_drz_wht.fits&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">130</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../../_images/9b82006840d7510f23696815674b0188f2e082ff0c3040fb63f39a3661f87e9e.png"><img alt="../../../_images/9b82006840d7510f23696815674b0188f2e082ff0c3040fb63f39a3661f87e9e.png" src="../../../_images/9b82006840d7510f23696815674b0188f2e082ff0c3040fb63f39a3661f87e9e.png" style="width: 1042px; height: 929px;" />
</a>
</div>
</div>
</section>
<section id="conclusion">
<h2>6. Conclusion <a id="conclusion"></a><a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>Thank you for going through this notebook. You should now have all the necessary tools for assessing the <br>
appropriate <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> parameter to use when combining images. After completing this notebook you <br>
should be more familiar with:<br>
    • How to effectively use <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> to download FLT and DRZ files. <br>
    • Checking the WCS of images and aligning them to a reference catalog with <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code>. <br>
    • Combining data with <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> taking into account the <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> <br>
<br>
<strong>Congratulations, you have completed the notebook!</strong></p>
</section>
<section id="additional-resources">
<h2>Additional Resources <a id="resources"></a><a class="headerlink" href="#additional-resources" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://hst-docs.stsci.edu/drizzpac">DrizzlePac Handbook</a></p></li>
<li><p><a class="reference external" href="https://stsci.service-now.com/hst">HST Help Desk</a></p></li>
<li><p><a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/tree/main/notebooks/DrizzlePac">Other DrizzlePac Notebooks</a></p></li>
</ul>
</section>
<section id="about-this-notebook">
<h2>About this Notebook <a id="about"></a><a class="headerlink" href="#about-this-notebook" title="Link to this heading">#</a></h2>
<p>Created:  14 Dec 2018; C. Martlin &amp; J. Mack <br>
Updated:  16 Nov 2023; K. Huynh &amp; J. Mack       <br>
Updated:  23 Jul 2024; J. Mack &amp; B. Kuhn   <br></p>
<p><strong>Source:</strong> https://github.com/spacetelescope/hst_notebooks <br></p>
</section>
<section id="citations">
<h2>Citations <a id="citations"></a><a class="headerlink" href="#citations" title="Link to this heading">#</a></h2>
<p>If you use Python packages for published research, please cite the authors. Follow these links for more <br>
information about citing packages such as <code class="docutils literal notranslate"><span class="pre">astropy</span></code>, <code class="docutils literal notranslate"><span class="pre">astroquery</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, etc.: <br></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.astropy.org/acknowledging.html">Citing <code class="docutils literal notranslate"><span class="pre">astropy</span></code></a> <br></p></li>
<li><p><a class="reference external" href="https://github.com/astropy/astroquery/blob/main/astroquery/CITATION">Citing <code class="docutils literal notranslate"><span class="pre">astroquery</span></code></a> <br></p></li>
<li><p><a class="reference external" href="https://zenodo.org/records/6325653">Citing <code class="docutils literal notranslate"><span class="pre">drizzlepac</span></code></a><br></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/users/project/citing.html">Citing <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a> <br></p></li>
<li><p><a class="reference external" href="https://numpy.org/citing-numpy/">Citing <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a> <br></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/about/citing.html">Citing <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a><br></p></li>
</ul>
<p><a class="reference internal" href="#top"><span class="xref myst">Top of Page</span></a>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/DrizzlePac/sky_matching"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../align_mosaics/align_mosaics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Aligning HST Mosaics</p>
      </div>
    </a>
    <a class="right-next"
       href="../mask_satellite/mask_satellite.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Satellite Trail Masking Techniques</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction <a id="intro"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-observations-with-astroquery">1. Download the Observations with <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> <a id="download"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-image-header-data">1.1 Check image header data <a id="check_keywords"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-alignment">1.2 Inspect the Alignment <a id="check_wcs"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#align-the-visit-level-drizzled-data-with-tweakreg">2. Align the visit-level drizzled data with <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> <a id="align"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-catalog-of-gaia-dr3-sources">2.1 Create a catalog of Gaia DR3 sources  <a id="cat"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-catalog-of-gaia-dr3-sources-with-proper-motion-data">2.2 Create a catalog of Gaia DR3 sources with Proper Motion Data  <a id="cat_pm"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-tweakreg">2.3 Run <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> <a id="tweak"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-shift-file-and-fit-quality">2.4 Inspect the shift file and fit quality <a id="fit_quality"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overplot-matched-sources-and-inspect-fit-residuals">2.5 Overplot matched sources and inspect fit residuals <a id="overplot"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rerun-tweakreg-and-update-the-header-wcs">2.6 Rerun <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> and update the header WCS <a id="updatehdr"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-tweakback-to-propogate-the-wcs-to-the-flt-files">2.7 Run <code class="docutils literal notranslate"><span class="pre">TweakBack</span></code> to propogate the WCS to the FLT files <a id="tweakback"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-skymethod-options-in-astrodrizzle">3. Compare  <code class="docutils literal notranslate"><span class="pre">skymethod</span></code> options in AstroDrizzle <a id="compare"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skymethod-localmin">3.1 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'localmin'</span></code> <a id="localmin"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skymethod-match">3.2 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'match'</span></code> <a id="match"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skymethod-globalmin-match">3.3 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'globalmin+match'</span></code> <a id="globalminmatch"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skymethod-globalmin">3.4 <code class="docutils literal notranslate"><span class="pre">skymethod</span> <span class="pre">=</span> <span class="pre">'globalmin'</span></code> <a id="globalmin"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-mdrizsky-values-for-each-method">4. Compare the MDRIZSKY values for each method <a id="mdrizsky"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-sky-matched-science-mosaic-and-weight-image">5. Display the ‘sky matched’ science mosaic and weight image <a id="display"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">6. Conclusion <a id="conclusion"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources <a id="resources"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook <a id="about"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations <a id="citations"></a></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>