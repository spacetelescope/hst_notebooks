

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Drizzling WFPC2 Images to use a Single Zeropoint &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/DrizzlePac/drizzle_wfpc2/drizzle_wfpc2';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Satellite Trail Masking Techniques" href="../mask_satellite/mask_satellite.html" />
    <link rel="prev" title="Aligning Deep Exposures of Sparse Fields" href="../align_sparse_fields/align_sparse_fields.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="HST Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="HST Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI HST Notebook Repository HQ
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ACS/README.html">ACS Notebooks</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_cte_forward_model/acs_cte_forward_model_example.html">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_pixel_area_maps/acs_pixel_area_maps.html">Obtaining Pixel Area Maps for ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">DrizzlePac Jupyter Notebook Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Initialization/Initialization.html">DrizzlePac Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../align_to_catalogs/align_to_catalogs.html">Aligning HST images to an absolute reference catalog</a></li>



<li class="toctree-l1"><a class="reference internal" href="../align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>

<li class="toctree-l1"><a class="reference internal" href="../align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>








<li class="toctree-l1 current active"><a class="current reference internal" href="#">Drizzling WFPC2 Images to use a Single Zeropoint</a></li>

<li class="toctree-l1"><a class="reference internal" href="../mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimize_image_sampling/optimize_image_sampling.html">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sky_matching/sky_matching.html">Sky Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Using updated astrometry solutions</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HASP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../HASP/Setup/Setup.html">Inputting User Data using the Hubble Advanced Spectral Products Script</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../STIS/README.html">STIS-Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/cross-correlation/cross-correlation.html">Correcting for Missing Wavecals with Cross-Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/custom_ccd_darks/custom_ccd_darks.html">Custom CCD Darks <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/drizpac_notebook/STIS_DrizzlePac_Tutorial.html">STIS DrizzlePac Tutorial <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.html">STIS Coronagraphy Visualization Tool (v2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/calstis/calstis_2d_ccd.html">Calstis 2-D CCD Data Reduction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/target_acquisition/target_acquisition.html">Evaluating STIS Target Acquisitions <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/view_data/view_data.html">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">WFC3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/README.html">WFC3 Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/calwf3_recalibration/calwf3_recal_tvb.html">Manual Recalibration with calwf3: Turning off the IR Linear Ramp Fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.html">Processing WFC3/UVIS Data with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Using the v1.0 CTE-Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/exception_report/wfc3_exception_report.html">Exception Report Checklist - WFC3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/image_displayer_analyzer/wfc3_image_displayer_analyzer.html">WFC3 Image Displayer &amp; Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_ima_visualization/IR_IMA_Visualization_with_an_Example_of_Time_Variable_Background.html">WFC3/IR IMA Visualization Tools with An Example of Time Variable Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_scattered_light_calwf3_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_Using_calwf3_to_Mask_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Using <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> to Mask Bad Reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_scattered_light_manual_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_by_Manually_Subtracting_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Manually Subtracting Bad Reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/persistence/wfc3_ir_persistence.html">Masking Persistence in WFC3/IR Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/tvb_flattenramp/TVB_flattenramp_notebook.html">Correcting for Helium Line Emission Background in IR Exposures using the “Flatten-Ramp” Technique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/photometry_examples/phot_examples.html">Synthetic Photometry Examples for WFC3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/uvis_pam_corrections/WFC3_UVIS_Pixel_Area_Map_Corrections_for_Subarrays.html">WFC3/UVIS Pixel Area Map Corrections for Subarrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/uvis_time_dependent_photometry/uvis_timedep_phot.html">WFC3/UVIS Time-dependent Photometry</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/DrizzlePac/drizzle_wfpc2/drizzle_wfpc2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/DrizzlePac/drizzle_wfpc2/drizzle_wfpc2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/DrizzlePac/drizzle_wfpc2/drizzle_wfpc2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Drizzling WFPC2 Images to use a Single Zeropoint</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Drizzling WFPC2 Images to use a Single Zeropoint</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-data">1. Download the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-the-wcs">2. Update the WCS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-an-image">Backup an Image</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#align-the-images">3. Align the Images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equalize-the-chip-sensitivities">4. Equalize the chip sensitivities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drizzle-combine-the-images">5. Drizzle-combine the images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-the-effects-of-sensitivity-variation-on-drizzling">6. Illustration of the Effects of Sensitivity Variation on Drizzling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-an-image-of-constant-blank-sky-background">Simulate an Image of Constant “Blank Sky” Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drizzle-the-original-simulated-image-and-the-equalized-image">Drizzle the Original Simulated Image and the Equalized Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-results-of-the-simulation-side-by-side">Display The Results of the Simulation Side-by-Side</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="drizzling-wfpc2-images-to-use-a-single-zeropoint">
<h1>Drizzling WFPC2 Images to use a Single Zeropoint<a class="headerlink" href="#drizzling-wfpc2-images-to-use-a-single-zeropoint" title="Permalink to this heading">#</a></h1>
<p><font color="red">This notebook currently fails to execute, use as reference only</font></p>
<div class="alert-danger">Note: The notebook in this repository 'Initialization.ipynb' goes over many of the basic concepts such as the setup of the environment/package installation and should be read first if you are new to HST images, DrizzlePac, or Astroquery.</div><section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>Extra care must be taken when using <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> to combine observations from detectors comprised of multiple chips of varying sensitivity. <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> works with calibrated images in units of counts (electrons or Data Numbers) or count rates and not in units of flux. It assumes that all input frames can be converted to physical flux units using a single inverse-sensitivity factor, recorded in the FITS image headers as <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code>, and the output drizzled product simply copies the <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code> keyword value from the first input image. When this occurs, the inverse-sensitivity will vary across the final drizzled product, and users will need to keep track of which sources fell on which chip when doing photometry. Moreover, varying detector sensitivities will affect the cosmic-ray rejection algorithm used by <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code>, and this may result in the misidentification of some good pixels as cosmic rays.</p>
<p>This is a typical situation when drizzle-combining images from HST instruments with different chip sensitivities, e.g. Wide Field and Planetary Camera 2 (WFPC2). For more detail, see the section on <a class="reference external" href="http://www.stsci.edu/instruments/wfpc2/Wfpc2_dhb/wfpc2_ch53.html">Gain Variation</a> under ‘Position-Dependent Photometric Corrections’ in the WFPC2 Data Handbook. As a result, each of the four chips requires a <a class="reference external" href="http://www.stsci.edu/instruments/wfpc2/Wfpc2_dhb/wfpc2_ch52.html#1933986">unique PHOTFLAM</a> header keyword value. A similar situation may occur when drizzle-combining observations taken over a span of several years as detector’s sensitivity declines over time, see e.g. <a class="reference external" href="https://doi.org/10.3847/0004-6256/152/3/60">ACS ISR 2016-03</a>.</p>
<p>One approach is to rescale the input data so that <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> can properly assume the images/chips have the same sensitivity; that is, a single <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code> value can be used to convert re-scaled image counts (or count-rates) to physical <em>integrated</em> flux units. The <code class="docutils literal notranslate"><span class="pre">photeq</span></code> task in <code class="docutils literal notranslate"><span class="pre">Drizzlepac</span></code> automates this image intensity rescaling to a single inverse-sensitivity factor <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code>.</p>
<p>In this example notebook, archival WFPC2 images are used to demonstrate advanced reprocessing using <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> and <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> for alignment and image combination. The notebook is based on a prior WFPC2 <a class="reference external" href="http://www.stsci.edu/hst/HST_overview/drizzlepac/examples/example7">example</a> but includes additional information about equalizing the chip sensitivities prior to combining.</p>
<p><strong>NOTE:</strong> It is important to note that <code class="docutils literal notranslate"><span class="pre">photeq</span></code> only adjusts image counts so that <em>integrated</em> physical fluxes can be obtained using a single <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code>. It does nothing to account for different throughtputs at different wavelengths.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>

<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span> <span class="nn">stwcs.updatewcs</span> <span class="kn">import</span> <span class="n">updatewcs</span>
<span class="kn">from</span> <span class="nn">drizzlepac</span> <span class="kn">import</span> <span class="n">tweakreg</span><span class="p">,</span> <span class="n">astrodrizzle</span><span class="p">,</span> <span class="n">photeq</span>
<span class="kn">from</span> <span class="nn">stsci.skypac</span> <span class="kn">import</span> <span class="n">skymatch</span>

<span class="c1"># ONLY needed for the simulation section:</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">stwcs.wcsutil</span> <span class="kn">import</span> <span class="n">HSTWCS</span>
<span class="kn">from</span> <span class="nn">drizzlepac.wfpc2Data</span> <span class="kn">import</span> <span class="n">WFPC2_GAINS</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-the-data">
<h2>1. Download the Data<a class="headerlink" href="#download-the-data" title="Permalink to this heading">#</a></h2>
<p>This example uses WFPC2 observations of Messier 2 in the F814W filter. The data come from GO proposal <a class="reference external" href="http://www.stsci.edu/cgi-bin/get-proposal-info?id=11100&amp;observatory=HST">11100</a> <em>“Two new ‘bullets’ for MOND: revealing the properties of dark matter in massive merging clusters”</em>. Four images were acquired using a 4-pt dither box pattern, followed by two images offset with a dither-line pattern.</p>
<p>The data are downloaded using the <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> API to access the <a class="reference external" href="http://archive.stsci.edu">MAST</a> archive. The <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code> <a class="reference external" href="http://astroquery.readthedocs.io/en/latest/mast/mast.html">documentation</a> has more examples for how to find and download data from MAST.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve the observation information.</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s1">&#39;mastDownload&#39;</span><span class="p">):</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s1">&#39;mastDownload&#39;</span><span class="p">)</span>
<span class="n">obs_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;ua0605*&#39;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="s1">&#39;F814W&#39;</span><span class="p">,</span> <span class="n">obstype</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">)</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obs_table</span><span class="p">)</span>

<span class="c1"># Download only the ua0605*_c0m.fits and ua0605*_c1m.fits (DQ) images:</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0M&#39;</span><span class="p">,</span> <span class="s1">&#39;C1M&#39;</span><span class="p">],</span> <span class="n">extension</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>

<span class="c1"># Move the files from the mastDownload directory to the current working</span>
<span class="c1"># directory and make a backup of the files.</span>
<span class="n">fits_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;mastDownload/HST/ua*/ua*c?m.fits&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">fil</span> <span class="ow">in</span> <span class="n">fits_files</span><span class="p">:</span>
    <span class="n">base_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fil</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">base_name</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">base_name</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fil</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
    
<span class="c1"># Delete the mastDownload directory and all subdirectories it contains.</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s1">&#39;mastDownload&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="update-the-wcs">
<h2>2. Update the WCS<a class="headerlink" href="#update-the-wcs" title="Permalink to this heading">#</a></h2>
<p>WFPC2 images downloaded from the archive contain World Coordinate System (WCS) information based on an older-style description of image distortions. Before these images can be processed with <code class="docutils literal notranslate"><span class="pre">drizzlepac</span></code>, their WCS must be converted to a new format. This can be achieved using <code class="docutils literal notranslate"><span class="pre">updatewcs()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">stwcs</span></code> package. More details may be found here: <a class="reference external" href="http://documents.stsci.edu/hst/HST_overview/documents/DrizzlePac/ch45.html#601857">‘Making WFPC2 Images Compatible with AstroDrizzle’</a>. Note that <code class="docutils literal notranslate"><span class="pre">updatewcs</span></code> is no longer a parameter in AstroDrizzle or TweakReg and must be run separately before processing the data.</p>
<p>First we download the reference files from the CRDS website. See the initialization notebook in this repository for more information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_SERVER_URL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;https://hst-crds.stsci.edu&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;reference_files&#39;</span><span class="p">))</span>

<span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s1">&#39;crds bestrefs --files ua0605*_c0m.fits --sync-references=1 --update-bestrefs&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;uref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;reference_files&#39;</span><span class="p">,</span> <span class="s1">&#39;references&#39;</span><span class="p">,</span> <span class="s1">&#39;hst&#39;</span><span class="p">,</span> <span class="s1">&#39;wfpc2&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span>
</pre></div>
</div>
</div>
</div>
<p><strong>NOTE:</strong> This next step may raise warnings because the Astrometry database is in progress and currently does not cover the entire sky. Please ignore these warnings. The WCS will still be updated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">updatewcs</span><span class="p">(</span><span class="s1">&#39;ua*c0m.fits&#39;</span><span class="p">,</span> <span class="n">use_db</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="backup-an-image">
<h3>Backup an Image<a class="headerlink" href="#backup-an-image" title="Permalink to this heading">#</a></h3>
<p>In a later section we will generate simulated data to illustrate the effects of drizzling WFPC2 images without sensitivity equalization. For that purpose we will need a copy of an original image that has the original inverse-sensitivity values (<code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code>) in their headers. Here we create a backup copy of the first image.</p>
<p><strong>NOTE:</strong> This step is needed for illustration purpose in this notebook only. It is not needed when processing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">orig_image</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;ua*c0m.fits&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">backup_image</span> <span class="o">=</span> <span class="s1">&#39;simulation.fits&#39;</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">backup_image</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">backup_image</span><span class="p">)</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">orig_image</span><span class="p">,</span> <span class="n">backup_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="align-the-images">
<h2>3. Align the Images<a class="headerlink" href="#align-the-images" title="Permalink to this heading">#</a></h2>
<p>Due to small pointing errors, the image header WCS typically needs to be updated in order to achieve the best drizzle-combined products. The expected pointing accuracy for various observing scenerios is summarized in the DrizzlePac Handbook <a class="reference external" href="http://documents.stsci.edu/hst/HST_overview/documents/DrizzlePac/AppendixB2.html">Appendix B</a>. Input images must first be aligned so that when the coordinates of a given object (in detector space) are converted to sky coordinates (using the WCS), that object’s sky coordinates must be approximately equal in each frame.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DrizzlePac</span></code> task <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> may be used to correct for any errors in the image header WCS. First, <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> finds sources in each image, matches sources in common across images, and finds a separate linear transformation to align each image. <code class="docutils literal notranslate"><span class="pre">TweakReg</span></code> then computes a new WCS for each image based on this linear transformation.</p>
<p>Here we show a basic image alignment procedure. For a more detailed illustration of image alignment, please refer to other example notebooks such as the mosaic example in this repository.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tweakreg</span><span class="o">.</span><span class="n">TweakReg</span><span class="p">(</span><span class="s1">&#39;ua*c0m.fits&#39;</span><span class="p">,</span> <span class="n">updatehdr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reusename</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">conv_width</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span> <span class="n">peakmin</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">peakmax</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="equalize-the-chip-sensitivities">
<h2>4. Equalize the chip sensitivities<a class="headerlink" href="#equalize-the-chip-sensitivities" title="Permalink to this heading">#</a></h2>
<p>This step adjusts image data values so that all images and chips appear (to <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code>) to have a single inverse sensitivity (<code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code>). This can be achieved using the <code class="docutils literal notranslate"><span class="pre">photeq</span></code> task in <code class="docutils literal notranslate"><span class="pre">Drizzlepac</span></code>. This task adjusts image data so that when these data are multiplied by the same single <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code> value, the correct flux is obtained.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">photeq</span><span class="o">.</span><span class="n">photeq</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="s1">&#39;ua*_c0m.fits&#39;</span><span class="p">,</span> <span class="n">ref_phot_ext</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the above command, we instruct <code class="docutils literal notranslate"><span class="pre">photeq</span></code> to “equalize” all chips of all input images using the <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code> for the <code class="docutils literal notranslate"><span class="pre">WF3</span></code> chip (<code class="docutils literal notranslate"><span class="pre">ref_phot_ext=3</span></code>), using the first image as a reference. This reference <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code> value is reported in the log file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">REFERENCE</span> <span class="n">VALUE</span> <span class="n">FROM</span> <span class="n">FILE</span><span class="p">:</span> <span class="s1">&#39;ua060502m_c0m.fits[&#39;</span><span class="n">SCI</span><span class="s1">&#39;,1]&#39;</span>
<span class="n">REFERENCE</span> <span class="s1">&#39;PHOTFLAM&#39;</span> <span class="n">VALUE</span> <span class="n">IS</span><span class="p">:</span> <span class="mf">2.507987e-18</span>
</pre></div>
</div>
<p>Upon the completion, <code class="docutils literal notranslate"><span class="pre">photeq</span></code> will not only adjust image data but also update <code class="docutils literal notranslate"><span class="pre">PHOTFLAM</span></code> values for all chips to this specific reference value.</p>
</section>
<section id="drizzle-combine-the-images">
<h2>5. Drizzle-combine the images<a class="headerlink" href="#drizzle-combine-the-images" title="Permalink to this heading">#</a></h2>
<p>All four chips are now drizzled together with an output pixel scale set to that of the WF chips:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;ua*c0m.fits&#39;</span><span class="p">,</span>
                          <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">driz_sep_bits</span><span class="o">=</span><span class="s1">&#39;8,1024&#39;</span><span class="p">,</span>
                          <span class="n">driz_sep_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">driz_sep_scale</span><span class="o">=</span><span class="mf">0.0996</span><span class="p">,</span>
                          <span class="n">combine_type</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span>
                          <span class="n">driz_cr_snr</span><span class="o">=</span><span class="s1">&#39;5.5 3.5&#39;</span><span class="p">,</span>
                          <span class="n">driz_cr_scale</span><span class="o">=</span><span class="s1">&#39;2.0 1.5&#39;</span><span class="p">,</span>
                          <span class="n">final_fillval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;8,1024&#39;</span><span class="p">,</span>
                          <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">final_scale</span><span class="o">=</span><span class="mf">0.0996</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drz</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;final_drz_sci.fits&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">drz</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="illustration-of-the-effects-of-sensitivity-variation-on-drizzling">
<h2>6. Illustration of the Effects of Sensitivity Variation on Drizzling<a class="headerlink" href="#illustration-of-the-effects-of-sensitivity-variation-on-drizzling" title="Permalink to this heading">#</a></h2>
<p>The effect of drizzling images with different detector sensitivies, while tangible, is sometimes difficult to <em>visualize</em> in noisy data, especially when drizzling multiple dithered images that can blur the borders between chips.</p>
<p>In this section we produce a simple simulation of observing a constant intensity “blank sky”. We then make a copy of this image and apply sensitivity equalization to it. Finally we drizzle both images and compare them side-by-side.</p>
<section id="simulate-an-image-of-constant-blank-sky-background">
<h3>Simulate an Image of Constant “Blank Sky” Background<a class="headerlink" href="#simulate-an-image-of-constant-blank-sky-background" title="Permalink to this heading">#</a></h3>
<p>In this simple simulation we assume only Poisson noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">backup_image</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;update&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h</span><span class="p">:</span>
    <span class="c1"># get chip inverse-sensitivity:</span>
    <span class="n">phot1</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;PHOTFLAM&#39;</span><span class="p">]</span>
    <span class="n">phot2</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;PHOTFLAM&#39;</span><span class="p">]</span>
    <span class="n">phot3</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;PHOTFLAM&#39;</span><span class="p">]</span>
    <span class="n">phot4</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;PHOTFLAM&#39;</span><span class="p">]</span>
    
    <span class="c1"># get chip WCS:</span>
    <span class="n">w1</span> <span class="o">=</span> <span class="n">HSTWCS</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">w2</span> <span class="o">=</span> <span class="n">HSTWCS</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">w3</span> <span class="o">=</span> <span class="n">HSTWCS</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">w4</span> <span class="o">=</span> <span class="n">HSTWCS</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ref_pscale</span> <span class="o">=</span> <span class="n">w4</span><span class="o">.</span><span class="n">idcscale</span>
    
    <span class="c1"># get chip gain:</span>
    <span class="n">cmdgain</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;ATODGAIN&#39;</span><span class="p">]</span>
    <span class="n">gain1</span> <span class="o">=</span> <span class="n">WFPC2_GAINS</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">cmdgain</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">gain2</span> <span class="o">=</span> <span class="n">WFPC2_GAINS</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">cmdgain</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">gain3</span> <span class="o">=</span> <span class="n">WFPC2_GAINS</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">cmdgain</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">gain4</span> <span class="o">=</span> <span class="n">WFPC2_GAINS</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">cmdgain</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># final drizzle scale:</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.0996</span>
    
    <span class="c1"># simulated sky level (&quot;true&quot; sky is constant):</span>
    <span class="n">sky</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">phot3</span>

    <span class="c1"># simulate observed counts assuming only Poisson noise:</span>
    <span class="n">conv1a</span> <span class="o">=</span> <span class="n">gain1</span> <span class="o">*</span> <span class="p">(</span><span class="n">w1</span><span class="o">.</span><span class="n">idcscale</span> <span class="o">/</span> <span class="n">ref_pscale</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">phot1</span>
    <span class="n">conv1b</span> <span class="o">=</span> <span class="p">(</span><span class="n">gain4</span> <span class="o">/</span> <span class="n">gain1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ref_pscale</span> <span class="o">/</span> <span class="n">scale</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">conv2a</span> <span class="o">=</span> <span class="n">gain2</span> <span class="o">*</span> <span class="p">(</span><span class="n">w2</span><span class="o">.</span><span class="n">idcscale</span> <span class="o">/</span> <span class="n">ref_pscale</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">phot2</span>
    <span class="n">conv2b</span> <span class="o">=</span> <span class="p">(</span><span class="n">gain4</span> <span class="o">/</span> <span class="n">gain2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ref_pscale</span> <span class="o">/</span> <span class="n">scale</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">conv3a</span> <span class="o">=</span> <span class="n">gain3</span> <span class="o">*</span> <span class="p">(</span><span class="n">w3</span><span class="o">.</span><span class="n">idcscale</span> <span class="o">/</span> <span class="n">ref_pscale</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">phot3</span>
    <span class="n">conv3b</span> <span class="o">=</span> <span class="p">(</span><span class="n">gain4</span> <span class="o">/</span> <span class="n">gain3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ref_pscale</span> <span class="o">/</span> <span class="n">scale</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">conv4a</span> <span class="o">=</span> <span class="n">gain4</span> <span class="o">*</span> <span class="p">(</span><span class="n">w4</span><span class="o">.</span><span class="n">idcscale</span> <span class="o">/</span> <span class="n">ref_pscale</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">phot4</span>
    <span class="n">conv4b</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">gain4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ref_pscale</span> <span class="o">/</span> <span class="n">scale</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">conv1a</span> <span class="o">*</span> <span class="n">sky</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">conv1b</span>
    <span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">conv2a</span> <span class="o">*</span> <span class="n">sky</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">conv2b</span>
    <span class="n">h</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">conv3a</span> <span class="o">*</span> <span class="n">sky</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">conv3b</span>
    <span class="n">h</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">conv4a</span> <span class="o">*</span> <span class="n">sky</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">conv4b</span>

<span class="c1"># make a copy of this file:</span>
<span class="n">photeq_image</span> <span class="o">=</span> <span class="s1">&#39;simulation_eq.fits&#39;</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">photeq_image</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">photeq_image</span><span class="p">)</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">backup_image</span><span class="p">,</span> <span class="n">photeq_image</span><span class="p">)</span>

<span class="c1"># apply equalization to the image copy:</span>
<span class="n">photeq</span><span class="o">.</span><span class="n">photeq</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">photeq_image</span><span class="p">,</span> <span class="n">ref_phot_ext</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="drizzle-the-original-simulated-image-and-the-equalized-image">
<h3>Drizzle the Original Simulated Image and the Equalized Image<a class="headerlink" href="#drizzle-the-original-simulated-image-and-the-equalized-image" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span>
    <span class="n">backup_image</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="s1">&#39;nonequalized.fits&#39;</span><span class="p">,</span>
    <span class="n">stepsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">restore</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">in_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">build</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">static</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skysub</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">blot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">driz_cr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">final_fillval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">final_scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span>
    <span class="n">photeq_image</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="s1">&#39;equalized.fits&#39;</span><span class="p">,</span>
    <span class="n">stepsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">restore</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">in_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">build</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">static</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skysub</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">median</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">blot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">driz_cr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">final_fillval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">final_scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="display-the-results-of-the-simulation-side-by-side">
<h3>Display The Results of the Simulation Side-by-Side<a class="headerlink" href="#display-the-results-of-the-simulation-side-by-side" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drz_noneq</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;nonequalized_sci.fits&#39;</span><span class="p">)</span>
<span class="n">drz_eq</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;equalized_sci.fits&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">drz_noneq</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.88</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.08</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Simulation (Not equalized)&#39;</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">drz_eq</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.88</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.08</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Equalized Simulated Image&#39;</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span><span class="o">.</span><span class="n">get_points</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span><span class="o">.</span><span class="n">get_points</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span>
<span class="n">ax_cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">ax_cbar</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="about-this-notebook">
<h1>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h1>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Author: M. Cara, STScI Data Analysis Tools Branch
Updated: December 14, 2018
</pre></div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/DrizzlePac/drizzle_wfpc2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../align_sparse_fields/align_sparse_fields.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Aligning Deep Exposures of Sparse Fields</p>
      </div>
    </a>
    <a class="right-next"
       href="../mask_satellite/mask_satellite.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Satellite Trail Masking Techniques</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Drizzling WFPC2 Images to use a Single Zeropoint</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-data">1. Download the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-the-wcs">2. Update the WCS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#backup-an-image">Backup an Image</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#align-the-images">3. Align the Images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equalize-the-chip-sensitivities">4. Equalize the chip sensitivities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drizzle-combine-the-images">5. Drizzle-combine the images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-the-effects-of-sensitivity-variation-on-drizzling">6. Illustration of the Effects of Sensitivity Variation on Drizzling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-an-image-of-constant-blank-sky-background">Simulate an Image of Constant “Blank Sky” Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#drizzle-the-original-simulated-image-and-the-equalized-image">Drizzle the Original Simulated Image and the Equalized Image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-results-of-the-simulation-side-by-side">Display The Results of the Simulation Side-by-Side</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>