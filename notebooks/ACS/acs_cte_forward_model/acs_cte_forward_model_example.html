

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Pixel-based ACS/WFC CTE Forward Model &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/ACS/acs_cte_forward_model/acs_cte_forward_model_example';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ACS Image Reduction for Subarray Data" href="../acs_subarrays/acs_subarrays.html" />
    <link rel="prev" title="ACS Linearity with Saturated Stars" href="../acs_saturation_trails/acs_saturation_trails.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="HST Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="HST Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI HST Notebook Repository HQ
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">ACS Notebooks</a></li>


<li class="toctree-l1"><a class="reference internal" href="../acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acs_pixel_area_maps/acs_pixel_area_maps.html">Obtaining Pixel Area Maps for ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acs_focus_diverse_epsfs/acs_focus_diverse_epsfs.html">Focus Diverse ePSFs for ACS/WFC</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/ExceptionReport/ExceptionReport.html">What to do when you get an Exception Report for COS</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/README.html">DrizzlePac Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Improving Astrometry Using Alternate WCS Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_to_catalogs/align_to_catalogs.html">Aligning HST images to an Absolute Reference Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/use_ds9_regions_in_tweakreg/use_ds9_regions_in_tweakreg.html">TWEAKREG Tips - Using DS9 Regions for Source Inclusion/Exclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/optimize_image_sampling/optimize_image_sampling.html">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_mosaics/align_mosaics.html">Aligning HST Mosaics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/sky_matching/sky_matching.html">Sky Matching for HST Mosaics <a id="top"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/drizzle_wfpc2/drizzle_wfpc2.html">Drizzling new WFPC2 FLT data products with chip-normalization   </a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HASP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../HASP/Setup/Setup.html">Installing the Hubble Advanced Spectral Products Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HASP/CoaddTutorial/CoaddTutorial.html">Inputting User Data using the Hubble Advanced Spectral Products Script</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../HASP/FluxScaleTutorial/FluxScaleTutorial.html">Scaling Flux while using the Hubble Advanced Spectral Products Script</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../HASP/DataDiagnostic/DataDiagnostics.html">HASP Data Diagnostic Notebook</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../HASP/WavelengthAdjustment/WavelengthAdjustment.html">Wavelength Adjustments for Running the Hubble Advanced Spectral Products (HASP) Script</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../STIS/README.html">STIS-Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/cross-correlation/cross-correlation.html">Correcting for Missing Wavecals with Cross-Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/custom_ccd_darks/custom_ccd_darks.html">Custom CCD Darks <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/drizpac_notebook/STIS_DrizzlePac_Tutorial.html">STIS DrizzlePac Tutorial <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.html">STIS Coronagraphy Visualization Tool (v2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/calstis/calstis_2d_ccd.html">Calstis 2-D CCD Data Reduction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/target_acquisition/target_acquisition.html">Evaluating STIS Target Acquisitions <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/view_data/view_data.html">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/low_count_uncertainties/Low_Count_Uncertainties.html">Low Count Uncertainties in STIS <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/contrast_sensitivity/STIS_Coronagraphic_Observation_Feasibility.html">STIS Coronagraphic Observation Feasibility</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">WFC3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/README.html">WFC3 Notebooks</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../WFC3/general_tools.html">General Tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/image_displayer_analyzer/wfc3_image_displayer_analyzer.html">WFC3 Image Displayer &amp; Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/exception_report/wfc3_exception_report.html">Exception Report Checklist - WFC3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.html">Processing WFC3/UVIS Data with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Using the v1.0 CTE-Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/persistence/wfc3_ir_persistence.html">Masking Persistence in WFC3/IR Images</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../WFC3/ir_tvb.html">WFC3/IR Time Variable Background (TVB)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/ir_ima_visualization/IR_IMA_Visualization_with_an_Example_of_Time_Variable_Background.html">WFC3/IR IMA Visualization Tools with An Example of Time Variable Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/calwf3_recalibration/calwf3_recal_tvb.html">Manual Recalibration with calwf3: Turning off the IR Linear Ramp Fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/tvb_flattenramp/TVB_flattenramp_notebook.html">Correcting for Helium Line Emission Background in IR Exposures using the “Flatten-Ramp” Technique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/ir_scattered_light_calwf3_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_Using_calwf3_to_Mask_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Using <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> to Mask Bad Reads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/ir_scattered_light_manual_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_by_Manually_Subtracting_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Manually Subtracting Bad Reads</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../WFC3/photometry.html">Photometry</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/filter_transformations/filter_transformations.html">WFC3/UVIS Filter Transformations with stsynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/flux_conversion_tool/flux_conversion_tool.html">Flux Unit Conversions with synphot and stsynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/photometry_examples/phot_examples.html">Synthetic Photometry Examples for WFC3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/uvis_time_dependent_photometry/uvis_timedep_phot.html">WFC3/UVIS Time-dependent Photometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/zeropoints/zeropoints.html">Calculating WFC3 Zeropoints with STSynphot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/uvis_pam_corrections/WFC3_UVIS_Pixel_Area_Map_Corrections_for_Subarrays.html">WFC3/UVIS Pixel Area Map Corrections for Subarrays</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../WFC3/point_spread_function.html">Point Spread Function (PSF)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/point_spread_function/hst_point_spread_function.html">HST WFC3 Point Spread Function Modeling   </a></li>
<li class="toctree-l2"><a class="reference internal" href="../../WFC3/mast_api_psf/download_psf_cutouts.html">Downloading WFC3 and WFPC2 PSF Cutouts from MAST</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/ACS/acs_cte_forward_model/acs_cte_forward_model_example.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/ACS/acs_cte_forward_model/acs_cte_forward_model_example.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/ACS/acs_cte_forward_model/acs_cte_forward_model_example.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pixel-based ACS/WFC CTE Forward Model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-update-stenv">0. Install/update stenv</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astroconda-is-no-longer-supported-and-is-superseded-by-stenv">*AstroConda is no longer supported and is superseded by stenv.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">1. Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data-and-reference-files">2. Download data and reference files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-image-of-artificial-stars">3. Create image of artificial stars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#option-a-start-with-an-observed-flc-image">Option A: Start with an observed FLC image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-add-artificial-stars">4A. Add artificial stars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-reverse-the-flat-and-dark-correction">5A. Reverse the flat and dark correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-run-cte-forward-model">6A. Run CTE forward model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-7a-run-cte-correction">(Optional) 7A. Run CTE correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-apply-flat-and-dark-correction">8A. Apply flat and dark correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#option-b-start-with-a-synthetic-image">Option B: Start with a synthetic image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-create-a-synthetic-image">4B. Create a synthetic image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-run-cte-forward-model">5B. Run CTE forward model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-optional-run-cte-correction">6B. (Optional) Run CTE correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-apply-flat-and-dark-correction">7B. Apply flat and dark correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-more-help">For more help:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a id="title_ID"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="pixel-based-acs-wfc-cte-forward-model">
<h1>Pixel-based ACS/WFC CTE Forward Model<a class="headerlink" href="#pixel-based-acs-wfc-cte-forward-model" title="Permalink to this heading">#</a></h1>
<p>This notebook demonstrates preparing data for input into the ACS/WFC pixel-based CTE forward model and running the model.</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<p><span class="xref myst">Introduction</span> <br>
<span class="xref myst">0. Install/update stenv</span> <br>
<span class="xref myst">1. Imports</span> <br>
<span class="xref myst">2. Download data and reference files</span> <br>
<span class="xref myst">3. Create an image of artificial stars</span> <br></p>
<p><span class="xref myst">Option A: Start with an observed FLC image</span></p>
<ul class="simple">
<li><p><span class="xref myst">4. Add artificial stars</span></p></li>
<li><p><span class="xref myst">5. Reverse the flat and dark correction</span></p></li>
<li><p><span class="xref myst">6. Run CTE forward model</span></p></li>
<li><p><span class="xref myst">7. (Optional) Run CTE correction</span></p></li>
<li><p><span class="xref myst">8. Apply flat and dark correction</span> <br></p></li>
</ul>
<p><span class="xref myst">Option B: Start with a synthetic image</span></p>
<ul class="simple">
<li><p><span class="xref myst">4. Create your image</span></p></li>
<li><p><span class="xref myst">5. Run CTE forward model</span></p></li>
<li><p><span class="xref myst">6. (Optional) Run CTE correction</span></p></li>
<li><p><span class="xref myst">7. Apply flat and dark correction</span> <br></p></li>
</ul>
<p><span class="xref myst">About this Notebook</span></p>
<p><a id="intro_ID"></a></p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The charge transfer efficiency (CTE) of the Advanced Camera for Surveys (ACS) Wide Field Channel (WFC) has been decreasing over the lifetime of the instrument. Radiation damage from cosmic rays and other sources leads to charge traps within the detector. These traps remove electrons from charge packets as they are transferred between rows of the detector, and release the electrons in subsequent pixels. This causes flux to be removed from bright features and released into pixels behind the features (relative to the row closest to the amplifier), creating bright trails.</p>
<p>A pixel-based CTE correction model for the ACS/WFC detector is fully described in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2010PASP..122.1035A/abstract">Anderson &amp; Bedin (2010)</a>, and a recent update to the model is presented in <a class="reference external" href="http://www.stsci.edu/files/live/sites/www/files/home/hst/instrumentation/acs/documentation/instrument-science-reports-isrs/_documents/isr1804.pdf">ACS ISR 2018-04</a>. The model is based on an empirical determination of the number and depth of charge traps distributed across the detector. It simulates detector readout of an input image, removes the result from the input, and iterates five times. In this way, a reverse model is successively approximated by the forward model. Electrons released in trails are removed and added back to the bright feature in which they originated.</p>
<p>The pixel-based correction was implemented in the calibration pipeline code for ACS (<code class="docutils literal notranslate"><span class="pre">CALACS</span></code>) in 2012 and the algorithm was updated and improved in 2018. The CTE correction step within <code class="docutils literal notranslate"><span class="pre">CALACS</span></code> runs on bias-corrected images, <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code> files, producing <code class="docutils literal notranslate"><span class="pre">blc_tmp</span></code> files, which lack the bright trails due to poor CTE. Further calibration, including dark correction and flat-fielding, produces <code class="docutils literal notranslate"><span class="pre">flt</span></code> and <code class="docutils literal notranslate"><span class="pre">flc</span></code> files from the <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code> and <code class="docutils literal notranslate"><span class="pre">blc_tmps</span></code> files, respectively. For more information on calibration of ACS/WFC data, see the <a class="reference external" href="http://www.stsci.edu/files/live/sites/www/files/home/hst/instrumentation/acs/documentation/other-documents/_documents/acs_dhb.pdf">ACS Data Handbook</a>.</p>
<p>Users desiring to more fully understand the effects of pixel-based CTE correction on their science may wish to run the forward model (i.e., the detector readout simulation) on data containing artificial stars. Here we demonstrate two methods for running the CTE forward model. In <span class="xref myst">Option A</span>, we begin with an observed <code class="docutils literal notranslate"><span class="pre">flc</span></code> image, whereas in <span class="xref myst">Option B</span>, we begin with a <code class="docutils literal notranslate"><span class="pre">raw</span></code> image and generate synthetic data on which to run the forward model.</p>
<p><strong>Note: The forward model, like the CTE correction step in <code class="docutils literal notranslate"><span class="pre">CALACS</span></code>, adds 10% of the difference between the input and output <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions to the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions to account for uncertainty in the CTE model. Below, we provide guidance for properly repopulating the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions of forward-modeled data.</strong></p>
<p><a id="update"></a></p>
<section id="install-update-stenv">
<h3>0. Install/update stenv<a class="headerlink" href="#install-update-stenv" title="Permalink to this heading">#</a></h3>
<section id="astroconda-is-no-longer-supported-and-is-superseded-by-stenv">
<h4>*<a class="reference external" href="https://astroconda.readthedocs.io/en/latest/">AstroConda</a> is no longer supported and is superseded by stenv.<a class="headerlink" href="#astroconda-is-no-longer-supported-and-is-superseded-by-stenv" title="Permalink to this heading">#</a></h4>
<p><a class="reference external" href="https://stenv.readthedocs.io/en/latest/">stenv</a> will include most packages from AstroConda and is recommended to process and analyze data from the Hubble Space Telescope (HST) and James Webb Space Telescope (JWST). To install and activate stenv, please refer to the <a class="reference external" href="https://stenv.readthedocs.io/en/latest/getting_started.html">documentation</a>. NOTE: stenv requires Python 3.8 or greater.</p>
<p>If you already use stenv, make sure the versions of <code class="docutils literal notranslate"><span class="pre">hstcal</span></code> and <a class="reference external" href="https://acstools.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">acstools</span></code></a> are both at least 2.1.0. The version of <code class="docutils literal notranslate"><span class="pre">CALACS</span></code> should be at least 10.1.0. Check the versions of all three on the command line:</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">conda</span> <span class="pre">list</span> <span class="pre">hstcal</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">conda</span> <span class="pre">list</span> <span class="pre">acstools</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">calacs.e</span> <span class="pre">--version</span></code></p>
<p>It is recommended, however, that you use the most up-to-date versions of these packages. To update these packages, run the following via the command line:</p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">conda</span> <span class="pre">update</span> <span class="pre">hstcal</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">conda</span> <span class="pre">update</span> <span class="pre">acstools</span></code></p>
<p><a id="imports"></a></p>
</section>
</section>
<section id="imports">
<h3>1. Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h3>
<p>Start by importing several packages:</p>
<ul class="simple">
<li><p><em>matplotlib notebook</em> for creating interactive plots</p></li>
<li><p><em>os</em> for setting environment variables</p></li>
<li><p><em>shutil</em> for managing directories</p></li>
<li><p><em>numpy</em> for math and array calculations</p></li>
<li><p><em>matplotlib pyplot</em> for plotting</p></li>
<li><p><em>matplotlib.colors LogNorm</em> for scaling images</p></li>
<li><p><em>astropy.io fits</em> for working with FITS files</p></li>
<li><p><em>photutils datasets</em> for creating synthetic stars and images</p></li>
<li><p><em>astroquery.mast Observations</em> for downloading data from MAST</p></li>
<li><p><em>acstools acsccd</em> for performing bias correction</p></li>
<li><p><em>acstools acscte</em> for performing CTE correction (reversing CTE trailing)</p></li>
<li><p><em>acstools acs2d</em> for performing dark correction and flat-fielding</p></li>
<li><p><em>acstools acscteforwardmodel</em> for running CTE forward model (generating CTE trailing)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.modeling.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gaussian2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">photutils.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_noise_image</span><span class="p">,</span> <span class="n">make_model_params</span><span class="p">,</span> <span class="n">make_model_image</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">acstools</span><span class="w"> </span><span class="kn">import</span> <span class="n">acsccd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">acstools</span><span class="w"> </span><span class="kn">import</span> <span class="n">acscte</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">acstools</span><span class="w"> </span><span class="kn">import</span> <span class="n">acs2d</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">acstools</span><span class="w"> </span><span class="kn">import</span> <span class="n">acscteforwardmodel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.11.11/x64/lib/python3.11/site-packages/acstools/utils_findsat_mrt.py:24: UserWarning: skimage not installed. MRT calculation will not work: ModuleNotFoundError(&quot;No module named &#39;skimage&#39;&quot;)
  warnings.warn(f&#39;skimage not installed. MRT calculation will not work: {repr(e)}&#39;)  # noqa
</pre></div>
</div>
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="download"></a></p>
</section>
<section id="download-data-and-reference-files">
<h3>2. Download data and reference files<a class="headerlink" href="#download-data-and-reference-files" title="Permalink to this heading">#</a></h3>
<p>Full-frame, new-mode subarray, and 2K old-mode subarray ACS/WFC images can be run through the CTE forward model. New-mode subarrays were added to the HST flight software at the beginning of Cycle 24. These subarrays have <code class="docutils literal notranslate"><span class="pre">APERTURE</span></code> keywords of the type <code class="docutils literal notranslate"><span class="pre">WFC1A-512,</span> <span class="pre">WFC1A-1K,</span> <span class="pre">WFC1A-2K</span></code>, etc. Old-mode subarrays have <code class="docutils literal notranslate"><span class="pre">APERTURE</span></code> keywords of the type <code class="docutils literal notranslate"><span class="pre">WFC1-512,</span> <span class="pre">WFC1-1K,</span> <span class="pre">WFC1-2K</span></code>, etc. WFC apertures are also listed in <a class="reference external" href="https://hst-docs.stsci.edu/display/ACSIHB/7.7+ACS+Apertures#id-7.7ACSApertures-table7.7">Table 7.7 of the ACS IHB</a>.</p>
<p>We recommend that the CTE forward model be run on data that has been bias-corrected, but not dark-corrected or flat-fielded. The flat and dark should be present in the image input into the CTE forward model because these features are present in the image when it is read out, and are therefore affected by CTE losses. The forward model can be run on <code class="docutils literal notranslate"><span class="pre">flc</span></code> files, but the results will technically be incorrect. Photometric tests of forward modeled data of both types show minor differences. Post-SM4 subarray data must be destriped with <a class="reference external" href="https://acstools.readthedocs.io/en/latest/api/acstools.acs_destripe_plus.destripe_plus.html#acstools.acs_destripe_plus.destripe_plus"><code class="docutils literal notranslate"><span class="pre">acs_destripe_plus</span></code></a>,  which will also perform the other calibration steps. <strong>Note: At this time, <code class="docutils literal notranslate"><span class="pre">acs_destripe_plus</span></code> only produces <code class="docutils literal notranslate"><span class="pre">flt</span></code>/<code class="docutils literal notranslate"><span class="pre">flc</span></code> images.</strong></p>
<p>We download a full-frame 47 Tuc image, <code class="docutils literal notranslate"><span class="pre">jd0q14ctq</span></code>, from the ACS CCD Stability Monitor program (PI: Coe, 14402) from the Mikulski Archive for Space Telescopes (<a class="reference external" href="https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html">MAST</a>) using <a class="reference external" href="https://astroquery.readthedocs.io/en/latest/">astroquery</a>. This image was taken in March 2016, and so it is strongly affected by CTE losses. We download the <code class="docutils literal notranslate"><span class="pre">flc</span></code> image for <span class="xref myst">Option A</span> and the <code class="docutils literal notranslate"><span class="pre">raw</span></code> image for <span class="xref myst">Option B</span> into the current directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="s1">&#39;jd0q14ctq&#39;</span><span class="p">)</span>

<span class="n">dl_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">obs_table</span><span class="p">[</span><span class="s1">&#39;obsid&#39;</span><span class="p">],</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FLC&#39;</span><span class="p">,</span> <span class="s1">&#39;RAW&#39;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dl_table</span><span class="p">:</span>
    <span class="n">oldfname</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">]</span>
    <span class="n">unique_fname</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">oldfname</span><span class="p">)</span>
    <span class="n">newfname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">oldfname</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">oldfname</span><span class="p">,</span> <span class="n">newfname</span><span class="p">)</span>
    
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s1">&#39;mastDownload&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_14402_14_acs_wfc_f775w_jd0q14ct_flc.fits to ./mastDownload/HST/hst_14402_14_acs_wfc_f775w_jd0q14ct/hst_14402_14_acs_wfc_f775w_jd0q14ct_flc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/jd0q14ctq_flc.fits to ./mastDownload/HST/jd0q14ctq/jd0q14ctq_flc.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/jd0q14ctq_raw.fits to ./mastDownload/HST/jd0q14ctq/jd0q14ctq_raw.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                             Local Path                                              Status  Message URL 
--------------------------------------------------------------------------------------------------- -------- ------- ----
./mastDownload/HST/hst_14402_14_acs_wfc_f775w_jd0q14ct/hst_14402_14_acs_wfc_f775w_jd0q14ct_flc.fits COMPLETE    None None
                   Local Path                    Status  Message URL 
----------------------------------------------- -------- ------- ----
./mastDownload/HST/jd0q14ctq/jd0q14ctq_flc.fits COMPLETE    None None
                   Local Path                    Status  Message URL 
----------------------------------------------- -------- ------- ----
./mastDownload/HST/jd0q14ctq/jd0q14ctq_raw.fits COMPLETE    None None
</pre></div>
</div>
</div>
</div>
<p>Next, update and download the correct flat and dark reference files for the <code class="docutils literal notranslate"><span class="pre">jd0q14ctq</span></code> dataset from the <a class="reference external" href="https://hst-crds.stsci.edu/">Calibration Reference Data System</a> (CRDS). We use the <a class="reference external" href="https://hst-crds.stsci.edu/static/users_guide/command_line_tools.html#crds-bestrefs">CRDS command line tools</a> to do this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_SERVER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;https://hst-crds.stsci.edu&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;./crds_cache&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;jref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;./crds_cache/references/hst/acs/&#39;</span>

<span class="o">!</span>crds<span class="w"> </span>bestrefs<span class="w"> </span>--update-bestrefs<span class="w"> </span>--sync-references<span class="o">=</span><span class="m">1</span><span class="w"> </span>--files<span class="w"> </span>jd0q14ctq_flc.fits
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_wf4tfile_0250.rmap       678 bytes  (1 / 142 files) (0 / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_shadfile_0250.rmap       977 bytes  (2 / 142 files) (678 / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_offtab_0250.rmap         642 bytes  (3 / 142 files) (1.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_maskfile_0250.rmap       685 bytes  (4 / 142 files) (2.3 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_idctab_0250.rmap         696 bytes  (5 / 142 files) (3.0 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_flatfile_0250.rmap    30.0 K bytes  (6 / 142 files) (3.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_dgeofile_0250.rmap       801 bytes  (7 / 142 files) (33.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_darkfile_0250.rmap   178.4 K bytes  (8 / 142 files) (34.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_biasfile_0250.rmap     3.3 K bytes  (9 / 142 files) (212.8 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_atodfile_0250.rmap       874 bytes  (10 / 142 files) (216.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfpc2_0250.imap                782 bytes  (11 / 142 files) (217.0 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_snkcfile_0003.rmap        681 bytes  (12 / 142 files) (217.8 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_satufile_0002.rmap      1.0 K bytes  (13 / 142 files) (218.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_pfltfile_0253.rmap     34.2 K bytes  (14 / 142 files) (219.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_pctetab_0004.rmap         698 bytes  (15 / 142 files) (253.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_oscntab_0250.rmap         747 bytes  (16 / 142 files) (254.4 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_npolfile_0254.rmap      4.0 K bytes  (17 / 142 files) (255.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_nlinfile_0250.rmap        726 bytes  (18 / 142 files) (259.2 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_mdriztab_0254.rmap        845 bytes  (19 / 142 files) (259.9 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_imphttab_0257.rmap        683 bytes  (20 / 142 files) (260.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_idctab_0254.rmap          661 bytes  (21 / 142 files) (261.4 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_flshfile_0256.rmap      5.8 K bytes  (22 / 142 files) (262.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_drkcfile_0198.rmap    240.0 K bytes  (23 / 142 files) (267.9 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_dfltfile_0002.rmap     17.1 K bytes  (24 / 142 files) (507.8 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_darkfile_0497.rmap    287.3 K bytes  (25 / 142 files) (524.9 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_d2imfile_0251.rmap        605 bytes  (26 / 142 files) (812.2 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_crrejtab_0250.rmap        803 bytes  (27 / 142 files) (812.9 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_ccdtab_0250.rmap          799 bytes  (28 / 142 files) (813.7 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_bpixtab_0314.rmap      11.9 K bytes  (29 / 142 files) (814.5 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_biasfile_0267.rmap     23.4 K bytes  (30 / 142 files) (826.4 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_biacfile_0003.rmap        692 bytes  (31 / 142 files) (849.8 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_atodtab_0250.rmap         651 bytes  (32 / 142 files) (850.4 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_wfc3_0605.imap               1.3 K bytes  (33 / 142 files) (851.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_synphot_tmttab_0002.rmap       745 bytes  (34 / 142 files) (852.4 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_synphot_tmgtab_0012.rmap       767 bytes  (35 / 142 files) (853.1 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_synphot_tmctab_0055.rmap       743 bytes  (36 / 142 files) (853.9 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_synphot_thruput_0059.rmap  329.6 K bytes  (37 / 142 files) (854.6 K / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_synphot_thermal_0003.rmap   20.4 K bytes  (38 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_synphot_obsmodes_0004.rmap      743 bytes  (39 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_synphot_0070.imap              579 bytes  (40 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_xtractab_0250.rmap        815 bytes  (41 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_wcptab_0251.rmap          578 bytes  (42 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_teltab_0250.rmap          745 bytes  (43 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_tdstab_0254.rmap          921 bytes  (44 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_tdctab_0252.rmap          650 bytes  (45 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_srwtab_0250.rmap          745 bytes  (46 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_sptrctab_0251.rmap        895 bytes  (47 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_sdctab_0251.rmap          889 bytes  (48 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_riptab_0254.rmap          877 bytes  (49 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_phottab_0258.rmap       1.6 K bytes  (50 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_pfltfile_0250.rmap     23.7 K bytes  (51 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_pctab_0250.rmap         3.1 K bytes  (52 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_mofftab_0250.rmap         747 bytes  (53 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_mlintab_0250.rmap         601 bytes  (54 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_lfltfile_0250.rmap     11.8 K bytes  (55 / 142 files) (1.2 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_lamptab_0250.rmap         610 bytes  (56 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_inangtab_0250.rmap        815 bytes  (57 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_imphttab_0252.rmap        616 bytes  (58 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_idctab_0251.rmap          775 bytes  (59 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_halotab_0250.rmap         747 bytes  (60 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_gactab_0250.rmap          651 bytes  (61 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_exstab_0250.rmap          745 bytes  (62 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_echsctab_0250.rmap        749 bytes  (63 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_disptab_0250.rmap         813 bytes  (64 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_darkfile_0357.rmap     60.6 K bytes  (65 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_crrejtab_0250.rmap        711 bytes  (66 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_cdstab_0250.rmap          745 bytes  (67 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_ccdtab_0252.rmap          893 bytes  (68 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_bpixtab_0250.rmap         845 bytes  (69 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_biasfile_0359.rmap    120.9 K bytes  (70 / 142 files) (1.3 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_apertab_0250.rmap         588 bytes  (71 / 142 files) (1.4 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_apdestab_0252.rmap        636 bytes  (72 / 142 files) (1.4 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_stis_0373.imap               1.7 K bytes  (73 / 142 files) (1.4 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_zprattab_0250.rmap      646 bytes  (74 / 142 files) (1.4 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_tempfile_0250.rmap    1.1 K bytes  (75 / 142 files) (1.4 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_tdffile_0250.rmap     8.9 K bytes  (76 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_saadfile_0250.rmap      771 bytes  (77 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_saacntab_0250.rmap      594 bytes  (78 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_rnlcortb_0250.rmap      771 bytes  (79 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_pmskfile_0250.rmap      603 bytes  (80 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_pmodfile_0250.rmap      603 bytes  (81 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_phottab_0250.rmap       862 bytes  (82 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_pedsbtab_0250.rmap      594 bytes  (83 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_noisfile_0250.rmap    2.6 K bytes  (84 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_nlinfile_0250.rmap    1.7 K bytes  (85 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_maskfile_0250.rmap    1.2 K bytes  (86 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_illmfile_0250.rmap    5.8 K bytes  (87 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_idctab_0250.rmap        767 bytes  (88 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_flatfile_0250.rmap   11.0 K bytes  (89 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_darkfile_0250.rmap   14.9 K bytes  (90 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_nicmos_0250.imap             1.1 K bytes  (91 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_ywlkfile_0003.rmap         922 bytes  (92 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_xwlkfile_0002.rmap         922 bytes  (93 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_xtractab_0269.rmap       1.6 K bytes  (94 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_wcptab_0257.rmap         1.3 K bytes  (95 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_twozxtab_0277.rmap         990 bytes  (96 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_tracetab_0276.rmap         998 bytes  (97 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_tdstab_0272.rmap           803 bytes  (98 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_spwcstab_0255.rmap       1.1 K bytes  (99 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_spottab_0006.rmap          766 bytes  (100 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_proftab_0276.rmap        1.0 K bytes  (101 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_phatab_0250.rmap           668 bytes  (102 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_lamptab_0264.rmap        1.4 K bytes  (103 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_hvtab_0259.rmap            567 bytes  (104 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_hvdstab_0002.rmap        1.0 K bytes  (105 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_gsagtab_0261.rmap          712 bytes  (106 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_geofile_0250.rmap          670 bytes  (107 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_fluxtab_0282.rmap        1.7 K bytes  (108 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_flatfile_0264.rmap       1.8 K bytes  (109 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_disptab_0276.rmap        1.7 K bytes  (110 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_dgeofile_0002.rmap         909 bytes  (111 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_deadtab_0250.rmap          711 bytes  (112 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_brsttab_0250.rmap          696 bytes  (113 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_brftab_0250.rmap           614 bytes  (114 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_bpixtab_0260.rmap          773 bytes  (115 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_badttab_0252.rmap          643 bytes  (116 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_cos_0359.imap                1.4 K bytes  (117 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_spottab_0251.rmap          641 bytes  (118 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_snkcfile_0101.rmap       7.5 K bytes  (119 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_shadfile_0251.rmap         531 bytes  (120 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_satufile_0002.rmap       1.2 K bytes  (121 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_pfltfile_0253.rmap      69.2 K bytes  (122 / 142 files) (1.5 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_pctetab_0254.rmap          615 bytes  (123 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_oscntab_0251.rmap          781 bytes  (124 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_npolfile_0253.rmap       3.2 K bytes  (125 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_mlintab_0250.rmap          646 bytes  (126 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_mdriztab_0253.rmap         769 bytes  (127 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_imphttab_0260.rmap         769 bytes  (128 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_idctab_0256.rmap         1.5 K bytes  (129 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_flshfile_0268.rmap       3.4 K bytes  (130 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_drkcfile_0452.rmap      15.1 K bytes  (131 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_dgeofile_0250.rmap       3.2 K bytes  (132 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_darkfile_0443.rmap      87.0 K bytes  (133 / 142 files) (1.6 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_d2imfile_0253.rmap         601 bytes  (134 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_crrejtab_0251.rmap         945 bytes  (135 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_cfltfile_0250.rmap       1.2 K bytes  (136 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_ccdtab_0256.rmap         1.4 K bytes  (137 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_bpixtab_0253.rmap        1.1 K bytes  (138 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_biasfile_0441.rmap      57.1 K bytes  (139 / 142 files) (1.7 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_atodtab_0251.rmap          528 bytes  (140 / 142 files) (1.8 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_acs_0544.imap                1.3 K bytes  (141 / 142 files) (1.8 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/mappings/hst/hst_1202.pmap                      495 bytes  (142 / 142 files) (1.8 M / 1.8 M bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  No comparison context or source comparison requested.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  ===&gt; Processing jd0q14ctq_flc.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/17717071j_osc.fits        17.3 K bytes  (1 / 16 files) (0 / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/25e1534hj_snk.fits        68.6 M bytes  (2 / 16 files) (17.3 K / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/25g1256nj_bpx.fits        23.0 K bytes  (3 / 16 files) (68.6 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/37g1550cj_mdz.fits       247.7 K bytes  (4 / 16 files) (68.6 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/4af1559ij_imp.fits       953.3 K bytes  (5 / 16 files) (68.9 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/4bb1536cj_idc.fits       285.1 K bytes  (6 / 16 files) (69.8 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/4bb15371j_d2i.fits        51.8 K bytes  (7 / 16 files) (70.1 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/4bb15376j_npl.fits        51.8 K bytes  (8 / 16 files) (70.2 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/5331917aj_sat.fits       171.4 M bytes  (9 / 16 files) (70.2 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/66418280j_bia.fits       171.5 M bytes  (10 / 16 files) (241.6 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/72m1821dj_ccd.fits        49.0 K bytes  (11 / 16 files) (413.1 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/78f18443j_drk.fits       268.5 M bytes  (12 / 16 files) (413.2 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/78g0300bj_dkc.fits       268.5 M bytes  (13 / 16 files) (681.6 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/8ch1518tj_cte.fits        43.2 M bytes  (14 / 16 files) (950.1 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/qb12257oj_pfl.fits       167.8 M bytes  (15 / 16 files) (993.3 M / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Fetching  ./crds_cache/references/hst/acs/qbu16428j_dxy.fits       134.3 M bytes  (16 / 16 files) (1.2 G / 1.3 G bytes)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  0 errors
CRDS - INFO -  0 warnings
CRDS - INFO -  160 infos
</pre></div>
</div>
</div>
</div>
<p>Next, we obtain the filenames of the flat (<code class="docutils literal notranslate"><span class="pre">PFLTFILE</span></code>), CTE-corrected dark (<code class="docutils literal notranslate"><span class="pre">DRKCFILE</span></code>), and superbias (<code class="docutils literal notranslate"><span class="pre">BIASFILE</span></code>) reference files from the image header. The flat will be used to add the effects of the flat field back into the image. If the data were post-flashed, then the flash file (<code class="docutils literal notranslate"><span class="pre">FLSHFILE</span></code>) is needed as well. This is shown in the commented line below. The CTE-corrected dark will be used to add dark current to the <code class="docutils literal notranslate"><span class="pre">flc</span></code> file and the synthetic data. The superbias will be used to repopulate the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions of the forward-modeled image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdr</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_flc.fits&#39;</span><span class="p">)</span>

<span class="n">flat</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;PFLTFILE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">dkc</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;DRKCFILE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;BIASFILE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># flash = hdr[&#39;FLSHFILE&#39;].split(&#39;$&#39;)[-1]</span>
</pre></div>
</div>
</div>
</div>
<p>We open the flat and dark images and obtain the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions of both CCDs, which are extension 1 for WFC2 and extension 4 for WFC1. We open the superbias image and obtain the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions of both CCDs, which are extension 2 for WFC2 and extension 5 for WFC2. If the flash file is needed, obtain the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions for both CCDs. This is shown in the commented out lines below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The jref environment variable gives the directory containing the reference files</span>
<span class="n">flat_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;jref&#39;</span><span class="p">],</span> <span class="n">flat</span><span class="p">))</span>

<span class="n">flat_wfc1</span> <span class="o">=</span> <span class="n">flat_hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">flat_wfc2</span> <span class="o">=</span> <span class="n">flat_hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dkc_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;jref&#39;</span><span class="p">],</span> <span class="n">dkc</span><span class="p">))</span>

<span class="n">dkc_wfc1</span> <span class="o">=</span> <span class="n">dkc_hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">dkc_wfc2</span> <span class="o">=</span> <span class="n">dkc_hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Darks can sometimes have negative pixels because they have been flash-corrected </span>
<span class="c1"># and CTE-corrected. Set all negative pixels to zero</span>
<span class="n">dkc_wfc1</span><span class="p">[</span><span class="n">dkc_wfc1</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">dkc_wfc2</span><span class="p">[</span><span class="n">dkc_wfc2</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bias_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;jref&#39;</span><span class="p">],</span> <span class="n">bias</span><span class="p">))</span>

<span class="n">err_bias_wfc1</span> <span class="o">=</span> <span class="n">bias_hdu</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">err_bias_wfc2</span> <span class="o">=</span> <span class="n">bias_hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">dq_bias_wfc1</span> <span class="o">=</span> <span class="n">bias_hdu</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">dq_bias_wfc2</span> <span class="o">=</span> <span class="n">bias_hdu</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># flash_dhu = fits.open(&#39;{}/{}&#39;.format(os.environ[&#39;jref&#39;], flash))</span>

<span class="c1"># flash_wfc1 = flash_hdu[4].data</span>
<span class="c1"># flash_wfc2 = flash_hdu[1].data</span>
</pre></div>
</div>
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="stars"></a></p>
</section>
<section id="create-image-of-artificial-stars">
<h3>3. Create image of artificial stars<a class="headerlink" href="#create-image-of-artificial-stars" title="Permalink to this heading">#</a></h3>
<p>We will need an image containing artificial stars on zero background for both options presented below. Artificial stars are typically generated using models that do not include the flat field, or are produced from data that have been flat-fielded. If this is the case, artificial stars should be added to the image at the <code class="docutils literal notranslate"><span class="pre">flc</span></code> stage.</p>
<p>Users of this notebook may have a preferred method for generating artificial stars and adding them to data, so here we simply add several Gaussians to the image using utilities within <code class="docutils literal notranslate"><span class="pre">photutils.datasets</span></code> in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>. These Gaussians are not representative of the true ACS/WFC PSF, and are added here for illustrative purposes only. Please note that artificial sources with peak values approaching or exceeding the WFC CCD full well value of about 80,000 electrons are not recommended for simulated data. Blooming of charge from saturated pixels is not implemented in this example.</p>
<p>There are many tools for generating artificial stars, including <a class="reference external" href="http://www.stsci.edu/hst/instrumentation/focus-and-pointing/focus/tiny-tim-hst-psf-modeling">Tiny Tim</a>, <a class="reference external" href="http://www.stsci.edu/files/live/sites/www/files/home/hst/instrumentation/acs/documentation/instrument-science-reports-isrs/_documents/isr0601.pdf">effective PSFs</a>, or <a class="reference external" href="https://photutils.readthedocs.io/en/stable/epsf.html"><code class="docutils literal notranslate"><span class="pre">EPSFBuilder</span></code></a> in <code class="docutils literal notranslate"><span class="pre">photutils</span></code>. A recent study of PSF models for ACS/WFC can be found <a class="reference external" href="http://www.stsci.edu/files/live/sites/www/files/home/hst/instrumentation/acs/documentation/instrument-science-reports-isrs/_documents/isr1708.pdf">here</a>.</p>
<p>First, we generate a table of random Gaussian sources of typical brightness for our 47 Tuc field with <span class="math notranslate nohighlight">\(\mathrm{FWHM}\sim2.5\)</span> pixels. Because <span class="math notranslate nohighlight">\(\mathrm{FWHM} = 2.355\sigma\)</span>, we will generate Gaussian sources with <span class="math notranslate nohighlight">\(\sigma \sim 1.06\)</span> pixels in both <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. We get use the shape of one of the flc image SCI extensions for creating the (x, y) coordinates of the sources.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wfc2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_flc.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">shape</span> <span class="o">=</span> <span class="n">wfc2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_sources</span> <span class="o">=</span> <span class="mi">300</span>

<span class="n">sources</span> <span class="o">=</span> <span class="n">make_model_params</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">n_sources</span><span class="p">,</span> <span class="n">x_name</span><span class="o">=</span><span class="s1">&#39;x_mean&#39;</span><span class="p">,</span> <span class="n">y_name</span><span class="o">=</span><span class="s1">&#39;y_mean&#39;</span><span class="p">,</span>
                            <span class="n">amplitude</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">30000</span><span class="p">),</span> <span class="n">x_stddev</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.07</span><span class="p">),</span> 
                            <span class="n">y_stddev</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.07</span><span class="p">),</span> <span class="n">theta</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>

<span class="n">sources</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>QTable length=300</i>
<table id="table140577255106000" class="table-striped table-bordered table-condensed">
<thead><tr><th>id</th><th>x_mean</th><th>y_mean</th><th>amplitude</th><th>x_stddev</th><th>y_stddev</th><th>theta</th></tr></thead>
<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>1</td><td>931.1683480255269</td><td>2034.731927781212</td><td>24273.448018412746</td><td>1.052614567617044</td><td>1.0578600277164938</td><td>2.8992449842520105</td></tr>
<tr><td>2</td><td>1297.4421594511477</td><td>2020.2558629061712</td><td>11822.754625107013</td><td>1.0618173409771416</td><td>1.0602199712414007</td><td>2.1780695595200688</td></tr>
<tr><td>3</td><td>3266.008913234879</td><td>1314.8224557352416</td><td>20899.070304107507</td><td>1.0507665561773338</td><td>1.0571366668824644</td><td>2.383984415966027</td></tr>
<tr><td>4</td><td>2769.939131395992</td><td>1030.403833222326</td><td>15048.61324113437</td><td>1.0517693372066452</td><td>1.0593415182072188</td><td>1.395289071630695</td></tr>
<tr><td>5</td><td>1601.9847192654192</td><td>975.5712053609202</td><td>13782.020382350489</td><td>1.0621928600284587</td><td>1.0641908208884874</td><td>0.5996291996338178</td></tr>
<tr><td>6</td><td>1363.205848540711</td><td>1243.9420055214678</td><td>4826.070921792934</td><td>1.0636999296992307</td><td>1.0581745784783634</td><td>2.5910405690665805</td></tr>
<tr><td>7</td><td>2450.6726546931295</td><td>922.0358345842421</td><td>9115.754462480229</td><td>1.0540239851398874</td><td>1.0546547351550888</td><td>0.9051036409307787</td></tr>
<tr><td>8</td><td>764.8632242328099</td><td>519.3794285853596</td><td>29956.815759113422</td><td>1.066687828209262</td><td>1.060442453559736</td><td>0.46925904081503583</td></tr>
<tr><td>9</td><td>2755.608756283889</td><td>873.1830758388562</td><td>12099.561207905457</td><td>1.0525415974521963</td><td>1.0510926327002308</td><td>1.458293270125343</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>291</td><td>3049.199296016571</td><td>974.3854129537558</td><td>10182.939255592759</td><td>1.0582276669645014</td><td>1.060568620486222</td><td>0.8800304042809031</td></tr>
<tr><td>292</td><td>1068.9294421398708</td><td>185.2889387754592</td><td>29699.704174650862</td><td>1.067041046045279</td><td>1.0592933029553009</td><td>0.6668416749113799</td></tr>
<tr><td>293</td><td>459.72808011782627</td><td>479.4770609052098</td><td>9450.767076933364</td><td>1.0549456781778814</td><td>1.056729610877866</td><td>0.8851592290836784</td></tr>
<tr><td>294</td><td>3864.1154244755094</td><td>492.79078623907435</td><td>28586.58598534217</td><td>1.058411636622201</td><td>1.0555466310084305</td><td>0.4200575104110322</td></tr>
<tr><td>295</td><td>2799.982150530955</td><td>769.4783583080148</td><td>26401.06084867246</td><td>1.0654222515797471</td><td>1.059642783502198</td><td>0.48148852760241173</td></tr>
<tr><td>296</td><td>3924.704169661908</td><td>1586.5420950195162</td><td>18944.135655263068</td><td>1.066979179761192</td><td>1.0648042376434979</td><td>2.448456948684402</td></tr>
<tr><td>297</td><td>1349.672037398428</td><td>1889.2709182654376</td><td>23719.284446053513</td><td>1.0675980704498134</td><td>1.0681062036226</td><td>0.23461983014438023</td></tr>
<tr><td>298</td><td>787.4899431859599</td><td>834.4354849267897</td><td>6521.774161315369</td><td>1.0666277383620673</td><td>1.0691378501204618</td><td>2.776254516985</td></tr>
<tr><td>299</td><td>560.2867956283426</td><td>675.4838643564142</td><td>3249.2235656380913</td><td>1.0696288260546474</td><td>1.0601718945578338</td><td>0.08120462986196368</td></tr>
<tr><td>300</td><td>3864.0750442510675</td><td>485.298054308759</td><td>710.7189661087606</td><td>1.055301294889783</td><td>1.0694088760643832</td><td>2.214824097280904</td></tr>
</table></div></div></div>
</div>
<p>Next, we make an image from the table of Gaussian sources. Finally, we run the synthetic image through a Poisson sampler in order to simulate the Poisson noise of the scene.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Gaussian2D</span><span class="p">()</span>
<span class="n">synth_stars_image</span> <span class="o">=</span> <span class="n">make_model_image</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> 
                                     <span class="n">x_name</span><span class="o">=</span><span class="s1">&#39;x_mean&#39;</span><span class="p">,</span> <span class="n">y_name</span><span class="o">=</span><span class="s1">&#39;y_mean&#39;</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">synth_stars_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">synth_stars_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">synth_stars_image</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> 
          <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;x_mean&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;y_mean&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fdacbf4ea50&gt;]
</pre></div>
</div>
<img alt="../../../_images/1b8828b93af4ebb945d9a6d03ca001e130056684645e446f593a39f68681aaf7.png" src="../../../_images/1b8828b93af4ebb945d9a6d03ca001e130056684645e446f593a39f68681aaf7.png" />
</div>
</div>
<p><a id="option-a"></a></p>
</section>
<section id="option-a-start-with-an-observed-flc-image">
<h3>Option A: Start with an observed FLC image<a class="headerlink" href="#option-a-start-with-an-observed-flc-image" title="Permalink to this heading">#</a></h3>
<p>In this Option, we add synthetic stars to the scene in an <code class="docutils literal notranslate"><span class="pre">flc</span></code> image and process it appropriately for use with the forward model. We use the <code class="docutils literal notranslate"><span class="pre">flc</span></code> image because it is the closest approximation to a pristine image of the sky. Below we plot a portion of the downloaded 47 Tuc image. Stars of various magnitudes are visible, as well as cosmic rays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flc</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_flc.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flc</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800.0, 1300.0)
</pre></div>
</div>
<img alt="../../../_images/a581e81e15296f427405215d4d22494db21520c14bd2e41b01fc0c644a9e8292.png" src="../../../_images/a581e81e15296f427405215d4d22494db21520c14bd2e41b01fc0c644a9e8292.png" />
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="A4"></a></p>
</section>
<section id="a-add-artificial-stars">
<h3>4A. Add artificial stars<a class="headerlink" href="#a-add-artificial-stars" title="Permalink to this heading">#</a></h3>
<p>Add the image of artificial stars generated above to both CCDs of the <code class="docutils literal notranslate"><span class="pre">flc</span></code> image, and save it as a new file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_flc.fits&#39;</span><span class="p">)</span>

<span class="n">wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">wfc1</span> <span class="o">+=</span> <span class="n">synth_stars_image</span>
<span class="n">wfc2</span> <span class="o">+=</span> <span class="n">synth_stars_image</span>

<span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_flc.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Below we plot a section of the <code class="docutils literal notranslate"><span class="pre">flc</span></code> image with a few artificial stars circled in red.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flc_stars</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_flc.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flc_stars</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> 
          <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;x_mean&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;y_mean&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800.0, 1300.0)
</pre></div>
</div>
<img alt="../../../_images/8febf98186261198c5e13026ea0e7f58008b0fec366c9a11784f7026782809f9.png" src="../../../_images/8febf98186261198c5e13026ea0e7f58008b0fec366c9a11784f7026782809f9.png" />
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="A5"></a></p>
</section>
<section id="a-reverse-the-flat-and-dark-correction">
<h3>5A. Reverse the flat and dark correction<a class="headerlink" href="#a-reverse-the-flat-and-dark-correction" title="Permalink to this heading">#</a></h3>
<p>First, calculate the total exposure time of the 47 Tuc image by combining the exposure time, flash time (if any), and 3 seconds of extra dark time to approximate instrument commanding overheads.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_flc.fits&#39;</span><span class="p">)</span>

<span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>

<span class="n">exptime</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;EXPTIME&#39;</span><span class="p">]</span>
<span class="n">flashtime</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;FLASHDUR&#39;</span><span class="p">]</span>
<span class="n">darktime</span> <span class="o">=</span> <span class="n">exptime</span> <span class="o">+</span> <span class="n">flashtime</span> <span class="o">+</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we open the 47 Tuc image and obtain the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions of both CCDs. We multiply by the flat and scale the CTE-corrected dark by the total exposure time. We also run the scaled dark image through a Poisson sampler to include Poisson noise in the dark scene. We then add the dark current to the image. We save the result, which is now effectively a <code class="docutils literal notranslate"><span class="pre">blc_tmp</span></code> file. If the data are post-flashed, we also need to reverse the flash correction. We do this by multiplying the flash file by the flash duration, running it through a Poisson sampler, and adding it to the 47 Tuc image. The lines for this are commented out below. <strong>Note: It is not recommended to use a simulated exposure time that scales pixels in the dark or flash image to or above the full well depth of ~80,000 electrons.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">wfc1</span> <span class="o">*=</span> <span class="n">flat_wfc1</span>
<span class="n">wfc2</span> <span class="o">*=</span> <span class="n">flat_wfc2</span>

<span class="n">wfc1</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">dkc_wfc1</span><span class="o">*</span><span class="n">darktime</span><span class="p">)</span>
<span class="n">wfc2</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">dkc_wfc2</span><span class="o">*</span><span class="n">darktime</span><span class="p">)</span>

<span class="c1"># wfc1 += np.random.poisson(flash_wfc1*flashtime)</span>
<span class="c1"># wfc2 += np.random.poisson(flash_wfc2*flashtime)</span>

<span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_pfl_dkc.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we update the header keyword <code class="docutils literal notranslate"><span class="pre">PCTECORR</span></code> to <code class="docutils literal notranslate"><span class="pre">PERFORM</span></code>, which is necessary for running the forward model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_pfl_dkc.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;PCTECORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="A6"></a></p>
</section>
<section id="a-run-cte-forward-model">
<h3>6A. Run CTE forward model<a class="headerlink" href="#a-run-cte-forward-model" title="Permalink to this heading">#</a></h3>
<p>We are now ready to run the CTE forward model, which simulates the effects of CTE losses while reading out the detector. In this example, we will use the <code class="docutils literal notranslate"><span class="pre">acstools</span></code> module <code class="docutils literal notranslate"><span class="pre">acscteforwardmodel</span></code>. Note that this step may take a few minutes. The resulting filename will be <code class="docutils literal notranslate"><span class="pre">*_ctefmod.fits</span></code>. We rename the file to have the suffix <code class="docutils literal notranslate"><span class="pre">*_blv_tmp.fits</span></code> so that it can be processed by <code class="docutils literal notranslate"><span class="pre">CALACS</span></code> in a later step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acscteforwardmodel</span><span class="o">.</span><span class="n">acscteforwardmodel</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_pfl_dkc.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Setting max threads to 4 out of 4 available
Trying to open jd0q14ctq_stars_pfl_dkc.fits...
Read in Primary header from jd0q14ctq_stars_pfl_dkc.fits...


CALBEG*** ACSCTE -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 16:50:59 UTC
Input    jd0q14ctq_stars_pfl_dkc.fits
Output   jd0q14ctq_stars_pfl_dkc_ctefmod.fits
Trying to open jd0q14ctq_stars_pfl_dkc.fits...
Read in Primary header from jd0q14ctq_stars_pfl_dkc.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


PCTECORR PERFORM
PCTEFILE jref$8ch1518tj_cte.fits
PCTEFILE PEDIGREE=INFLIGHT 01/03/2002 22/07/2010
PCTEFILE DESCRIP =Parameters needed for gen3 pixel-based CTE correction -----------
Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...
(pctecorr) Parallel and Serial PCTETAB file auto-detected.
(pctecorr) Reading CTE parameters from PCTETAB file: &#39;jref$8ch1518tj_cte.fits&#39;...
(pctecorr) Collecting data for Correction Type: parallel.

Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...

CTE_NAME: Par/Serial PixelCTE 2023
CTE_VER: 3.0
PCTERNOI: 4.300000
PCTENSMD: 0
PCTETRSH: -10
FIXROCR: 1
Opening jref$8ch1518tj_cte.fits[1] to read QPROF table.
CTEDATE0: 52334.9
CTEDATE1: 57710.4
PCTETLEN: 60
PCTENFOR: 5
PCTENPAR: 7
Opening jref$8ch1518tj_cte.fits[2] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 1.
Reading in image from CPROF EXTVER 1.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
(pctecorr) The parallel CTE processing parameters have been read.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.300000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 5
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 7
(pctecorr) CTE_FRAC: 0.951805

(pctecorr) NOTE: No serial CTE correction is done for any subarray data.

(pctecorr) Collecting data for Correction Type: serial 

Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...

CTE_NAME: Par/Serial PixelCTE 2023
CTE_VER: 3.0
PCTERNOI: 4.300000
PCTENSMD: 0
PCTETRSH: -10
FIXROCR: 1
Opening jref$8ch1518tj_cte.fits[13] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[14] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 4.
Reading in image from CPROF EXTVER 4.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.300000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp C.
(pctecorr) Read noise level from CCDTAB: 4.050000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: C
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -23141.914062 (-0.003274%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: C

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp C.
(pctecorr) Read noise level from CCDTAB: 4.050000.
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -361068.812500 (-0.051092%)
(pctecorr) CTE run time for current chip: 46.52(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[17] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[18] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 5.
Reading in image from CPROF EXTVER 5.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.050000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp D.
(pctecorr) Read noise level from CCDTAB: 5.050000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: D

(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -17035.388672 (-0.002019%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: D

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp D.
(pctecorr) Read noise level from CCDTAB: 5.050000.
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -415023.343750 (-0.049185%)
(pctecorr) CTE run time for current chip: 53.82(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[5] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[6] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 2.
Reading in image from CPROF EXTVER 2.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 5.050000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp A.
(pctecorr) Read noise level from CCDTAB: 4.350000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: A

(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -21602.230469 (-0.003729%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: A

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp A.
(pctecorr) Read noise level from CCDTAB: 4.350000.
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -291065.156250 (-0.050241%)
(pctecorr) CTE run time for current chip: 48.97(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[9] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[10] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 3.
Reading in image from CPROF EXTVER 3.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.350000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp B.
(pctecorr) Read noise level from CCDTAB: 3.750000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: B

(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -29912.511719 (-0.002641%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: B

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp B.
(pctecorr) Read noise level from CCDTAB: 3.750000.
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -474379.093750 (-0.041881%)
(pctecorr) CTE run time for current chip: 63.31(s) with 4 procs/threads

PCTECORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>End      31-Dec-2024 16:54:34 UTC


*** ACSCTE complete ***
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_pfl_dkc_ctefmod.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>After the forward model is run, the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions of the image are equivalent to a <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code> file, in principle. However, the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions are the original <code class="docutils literal notranslate"><span class="pre">flc</span></code> <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions plus 10% of the forward model correction. To ensure the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions are accurate for a <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code> file, we will set every pixel to zero and calculate new values for each pixel according to</p>
<p><span class="math notranslate nohighlight">\(\mathrm{ERR} = \sqrt{\mathrm{SCI} + \mathrm{RN}^2 + (\mathrm{ERR}_{\mathrm{superbias}}g)^2}\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(\mathrm{SCI}\)</span> is the pixel value in the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extension (all negative pixels are set to zero), <span class="math notranslate nohighlight">\(\mathrm{RN}\)</span> is the readnoise, <span class="math notranslate nohighlight">\(\mathrm{ERR}_{\mathrm{superbias}}\)</span> is the pixel value in the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extension of the superbias, and <span class="math notranslate nohighlight">\(g\)</span> is the gain.</p>
<p>First, we access the header and <code class="docutils literal notranslate"><span class="pre">SCI</span></code> and <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions of the forward-modeled data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">)</span>

<span class="n">sci_wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">sci_wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">err_wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">err_wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we take the readnoise and gain values for each quadrant from the header.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rn_A</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEA&#39;</span><span class="p">]</span>
<span class="n">rn_B</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEB&#39;</span><span class="p">]</span>
<span class="n">rn_C</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEC&#39;</span><span class="p">]</span>
<span class="n">rn_D</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSED&#39;</span><span class="p">]</span>

<span class="n">gain_A</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;ATODGNA&#39;</span><span class="p">]</span>
<span class="n">gain_B</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;ATODGNB&#39;</span><span class="p">]</span>
<span class="n">gain_C</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;ATODGNC&#39;</span><span class="p">]</span>
<span class="n">gain_D</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;ATODGND&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we make copies of the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions in which to set all negative values to zero. We calculate the appropriate error for each quadrant and save them to the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions of the forward-modeled image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sci_wfc1_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">sci_wfc1</span><span class="p">)</span>
<span class="n">sci_wfc2_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">sci_wfc2</span><span class="p">)</span>

<span class="n">sci_wfc1_pos</span><span class="p">[</span><span class="n">sci_wfc1_pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sci_wfc2_pos</span><span class="p">[</span><span class="n">sci_wfc2_pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">err_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sci_wfc1_pos</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">+</span> <span class="n">rn_A</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">err_bias_wfc1</span><span class="p">[</span><span class="mi">20</span><span class="p">:,</span> <span class="mi">24</span><span class="p">:</span><span class="mi">2072</span><span class="p">]</span><span class="o">*</span><span class="n">gain_A</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">err_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sci_wfc1_pos</span><span class="p">[:,</span> <span class="mi">2048</span><span class="p">:]</span> <span class="o">+</span> <span class="n">rn_B</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">err_bias_wfc1</span><span class="p">[</span><span class="mi">20</span><span class="p">:,</span> <span class="mi">2072</span><span class="p">:</span><span class="o">-</span><span class="mi">24</span><span class="p">]</span><span class="o">*</span><span class="n">gain_B</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">err_C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sci_wfc2_pos</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">+</span> <span class="n">rn_C</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">err_bias_wfc2</span><span class="p">[:</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span><span class="mi">2072</span><span class="p">]</span><span class="o">*</span><span class="n">gain_C</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">err_D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sci_wfc2_pos</span><span class="p">[:,</span> <span class="mi">2048</span><span class="p">:]</span> <span class="o">+</span> <span class="n">rn_D</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">err_bias_wfc2</span><span class="p">[:</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2072</span><span class="p">:</span><span class="o">-</span><span class="mi">24</span><span class="p">]</span><span class="o">*</span><span class="n">gain_D</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">err_wfc1</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">err_A</span><span class="p">,</span> <span class="n">err_B</span><span class="p">))</span>
<span class="n">err_wfc2</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">err_C</span><span class="p">,</span> <span class="n">err_D</span><span class="p">))</span>

<span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="A7"></a></p>
</section>
<section id="optional-7a-run-cte-correction">
<h3>(Optional) 7A. Run CTE correction<a class="headerlink" href="#optional-7a-run-cte-correction" title="Permalink to this heading">#</a></h3>
<p>If desired, we now CTE correct the forward-modeled image. To do this, we need to update the <code class="docutils literal notranslate"><span class="pre">PCTECORR</span></code> keyword to <code class="docutils literal notranslate"><span class="pre">PERFORM</span></code> again and update the <code class="docutils literal notranslate"><span class="pre">NEXTEND</span></code> keyword to 6, the number of extensions left after running the forward model.  (This is because the forward model strips the distortion-related extensions from the input file, but does not update <code class="docutils literal notranslate"><span class="pre">NEXTEND</span></code>.) Finally, run <code class="docutils literal notranslate"><span class="pre">acscte</span></code> on the image. The resulting filename will be <code class="docutils literal notranslate"><span class="pre">*_blc_tmp.fits</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;PCTECORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;NEXTEND&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">acscte</span><span class="o">.</span><span class="n">acscte</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Setting max threads to 4 out of 4 available
Trying to open jd0q14ctq_stars_ctefmod_blv_tmp.fits...
Read in Primary header from jd0q14ctq_stars_ctefmod_blv_tmp.fits...


CALBEG*** ACSCTE -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 16:54:34 UTC
Input    jd0q14ctq_stars_ctefmod_blv_tmp.fits
Output   jd0q14ctq_stars_ctefmod_blc_tmp.fits
Trying to open jd0q14ctq_stars_ctefmod_blv_tmp.fits...
Read in Primary header from jd0q14ctq_stars_ctefmod_blv_tmp.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


PCTECORR PERFORM
PCTEFILE jref$8ch1518tj_cte.fits
PCTEFILE PEDIGREE=INFLIGHT 01/03/2002 22/07/2010
PCTEFILE DESCRIP =Parameters needed for gen3 pixel-based CTE correction -----------
Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...
(pctecorr) Parallel and Serial PCTETAB file auto-detected.
(pctecorr) Reading CTE parameters from PCTETAB file: &#39;jref$8ch1518tj_cte.fits&#39;...
(pctecorr) Collecting data for Correction Type: parallel.

Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...

CTE_NAME: Par/Serial PixelCTE 2023
CTE_VER: 3.0
PCTERNOI: 4.300000
PCTENSMD: 0
PCTETRSH: -10
FIXROCR: 1
Opening jref$8ch1518tj_cte.fits[1] to read QPROF table.
CTEDATE0: 52334.9
CTEDATE1: 57710.4
PCTETLEN: 60
PCTENFOR: 5
PCTENPAR: 7
Opening jref$8ch1518tj_cte.fits[2] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 1.
Reading in image from CPROF EXTVER 1.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
(pctecorr) The parallel CTE processing parameters have been read.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.300000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 5
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 7
(pctecorr) CTE_FRAC: 0.951805

(pctecorr) NOTE: No serial CTE correction is done for any subarray data.

(pctecorr) Collecting data for Correction Type: serial 

Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...

CTE_NAME: Par/Serial PixelCTE 2023
CTE_VER: 3.0
PCTERNOI: 4.300000
PCTENSMD: 0
PCTETRSH: -10
FIXROCR: 1
Opening jref$8ch1518tj_cte.fits[13] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[14] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 4.
Reading in image from CPROF EXTVER 4.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.300000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp C.
(pctecorr) Read noise level from CCDTAB: 4.050000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: C
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.99(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 22212.498047 (0.003144%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: C

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp C.
(pctecorr) Read noise level from CCDTAB: 4.050000.
(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 2.04(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 356094.875000 (0.050417%)
(pctecorr) CTE run time for current chip: 234.00(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[17] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[18] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 5.
Reading in image from CPROF EXTVER 5.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.050000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp D.
(pctecorr) Read noise level from CCDTAB: 5.050000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: D

(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.84(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 16201.007812 (0.001921%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: D

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp D.
(pctecorr) Read noise level from CCDTAB: 5.050000.
(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 2.05(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 409289.000000 (0.048529%)
(pctecorr) CTE run time for current chip: 269.73(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[5] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[6] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 2.
Reading in image from CPROF EXTVER 2.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 5.050000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp A.
(pctecorr) Read noise level from CCDTAB: 4.350000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: A

(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.85(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 16055.597656 (0.002773%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: A

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp A.
(pctecorr) Read noise level from CCDTAB: 4.350000.
(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 2.10(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 256026.468750 (0.044218%)
(pctecorr) CTE run time for current chip: 242.29(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[9] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[10] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 3.
Reading in image from CPROF EXTVER 3.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.350000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp B.
(pctecorr) Read noise level from CCDTAB: 3.750000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: B

(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 2.15(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 30918.591797 (0.002730%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: B

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp B.
(pctecorr) Read noise level from CCDTAB: 3.750000.
(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 2.32(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 470428.406250 (0.041545%)
(pctecorr) CTE run time for current chip: 315.39(s) with 4 procs/threads

PCTECORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>End      31-Dec-2024 17:12:21 UTC


*** ACSCTE complete ***
</pre></div>
</div>
</div>
</div>
<p><a id="A8"></a></p>
</section>
<section id="a-apply-flat-and-dark-correction">
<h3>8A. Apply flat and dark correction<a class="headerlink" href="#a-apply-flat-and-dark-correction" title="Permalink to this heading">#</a></h3>
<p>Finally, we flat-field and dark-correct the forward-modeled image using <code class="docutils literal notranslate"><span class="pre">acs2d</span></code> to produce an <code class="docutils literal notranslate"><span class="pre">flt</span></code>-like image. First, we update the keywords <code class="docutils literal notranslate"><span class="pre">DARKCORR</span></code> and <code class="docutils literal notranslate"><span class="pre">FLATCORR</span></code> to <code class="docutils literal notranslate"><span class="pre">PERFORM</span></code>. All other relevant <code class="docutils literal notranslate"><span class="pre">CALACS</span></code> header keyword switches are set to <code class="docutils literal notranslate"><span class="pre">COMPLETE</span></code> because the original data was an <code class="docutils literal notranslate"><span class="pre">flc</span></code> image. The resulting filename will be <code class="docutils literal notranslate"><span class="pre">*_flt.fits</span></code>. <strong>Note:</strong> If the data were post-flashed, and the flash background was added back in during an earlier step, we must also set <code class="docutils literal notranslate"><span class="pre">FLSHCORR</span></code> equal to <code class="docutils literal notranslate"><span class="pre">PERFORM</span></code>. This option is shown below in a commented out line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;DARKCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;FLATCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="c1"># fits.setval(&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;, &#39;FLSHCORR&#39;, value=&#39;PERFORM&#39;)</span>

<span class="n">acs2d</span><span class="o">.</span><span class="n">acs2d</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Trying to open jd0q14ctq_stars_ctefmod_blv_tmp.fits...
Read in Primary header from jd0q14ctq_stars_ctefmod_blv_tmp.fits...


CALBEG*** ACS2D -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 17:12:21 UTC
Input    jd0q14ctq_stars_ctefmod_blv_tmp.fits
Output   jd0q14ctq_stars_ctefmod_flt.fits
Trying to open jd0q14ctq_stars_ctefmod_blv_tmp.fits...
Read in Primary header from jd0q14ctq_stars_ctefmod_blv_tmp.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


Imset 1  Begin 17:12:21 UTC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  OMIT


DARKCORR PERFORM
DARKFILE jref$78f18443j_drk.fits
DARKFILE PEDIGREE=INFLIGHT 12/02/2016 09/03/2016
DARKFILE DESCRIP =Standard full-frame dark for data taken after Feb 11 2016 08:10:42-
Darktime from header 342.239197
Mean of dark image (MEANDARK) = 4.06977
DARKCORR COMPLETE


FLSHCORR OMIT


FLATCORR PERFORM
PFLTFILE jref$qb12257oj_pfl.fits
PFLTFILE PEDIGREE=INFLIGHT 18/04/2002 - 04/07/2006
PFLTFILE DESCRIP =Flats: P(Lab)*L(Flight)*delta(-81K,ISR06-06). UNCONFIRMED FWOFFSET
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FLATCORR COMPLETE


SHADCORR OMIT


PHOTCORR OMIT
Imset 1  End 17:12:22 UTC


Imset 2  Begin 17:12:22 UTC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  OMIT


DARKCORR PERFORM
Darktime from header 342.239197
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean of dark image (MEANDARK) = 4.16998
DARKCORR COMPLETE


FLSHCORR OMIT


FLATCORR PERFORM
FLATCORR COMPLETE


SHADCORR OMIT


PHOTCORR OMIT
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imset 2  End 17:12:22 UTC


End      31-Dec-2024 17:12:22 UTC


*** ACS2D complete ***
</pre></div>
</div>
</div>
</div>
<p>If the forward-modeled image was CTE-corrected in <span class="xref myst">Step 7A</span>, we run <code class="docutils literal notranslate"><span class="pre">acs2d</span></code> on the CTE-corrected image. The resulting filename will be <code class="docutils literal notranslate"><span class="pre">*_flc.fits</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blc_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;DARKCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blc_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;FLATCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="c1"># fits.setval(&#39;jd0q14ctq_stars_ctefmod_blv_tmp.fits&#39;, &#39;FLSHCORR&#39;, value=&#39;PERFORM&#39;)</span>

<span class="n">acs2d</span><span class="o">.</span><span class="n">acs2d</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_blc_tmp.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Trying to open jd0q14ctq_stars_ctefmod_blc_tmp.fits...
Read in Primary header from jd0q14ctq_stars_ctefmod_blc_tmp.fits...


CALBEG*** ACS2D -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 17:12:22 UTC
Input    jd0q14ctq_stars_ctefmod_blc_tmp.fits
Output   jd0q14ctq_stars_ctefmod_flc.fits
Trying to open jd0q14ctq_stars_ctefmod_blc_tmp.fits...
Read in Primary header from jd0q14ctq_stars_ctefmod_blc_tmp.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


Imset 1  Begin 17:12:22 UTC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  OMIT


DARKCORR PERFORM
DARKFILE jref$78g0300bj_dkc.fits
DARKFILE PEDIGREE=INFLIGHT 12/02/2016 09/03/2016
DARKFILE DESCRIP =CTE corrected dark for WFC data taken after Feb 11 2016 08:10:42---
Darktime from header 342.239197
Mean of dark image (MEANDARK) = 3.36636
DARKCORR COMPLETE


FLSHCORR OMIT


FLATCORR PERFORM
PFLTFILE jref$qb12257oj_pfl.fits
PFLTFILE PEDIGREE=INFLIGHT 18/04/2002 - 04/07/2006
PFLTFILE DESCRIP =Flats: P(Lab)*L(Flight)*delta(-81K,ISR06-06). UNCONFIRMED FWOFFSET
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FLATCORR COMPLETE


SHADCORR OMIT


PHOTCORR OMIT
Imset 1  End 17:12:22 UTC


Imset 2  Begin 17:12:22 UTC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  OMIT


DARKCORR PERFORM
Darktime from header 342.239197
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean of dark image (MEANDARK) = 3.4793
DARKCORR COMPLETE


FLSHCORR OMIT


FLATCORR PERFORM
FLATCORR COMPLETE


SHADCORR OMIT


PHOTCORR OMIT
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imset 2  End 17:12:23 UTC


End      31-Dec-2024 17:12:23 UTC


*** ACS2D complete ***
</pre></div>
</div>
</div>
</div>
<p>The 47 Tuc image(s) are now prepared for further analysis appropriate for the user’s science. The cells below plot a portion of the final images, the <code class="docutils literal notranslate"><span class="pre">flt</span></code> and, if produced, the <code class="docutils literal notranslate"><span class="pre">flc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flt_stars</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_flt.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flt_stars</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> 
          <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;x_mean&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;y_mean&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800.0, 1300.0)
</pre></div>
</div>
<img alt="../../../_images/ee6c53ad11e6b54f990989552dc9e534d328c66c59a2598473d72cb1d0ae674b.png" src="../../../_images/ee6c53ad11e6b54f990989552dc9e534d328c66c59a2598473d72cb1d0ae674b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flc_stars</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_stars_ctefmod_flc.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flc_stars</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> 
          <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;x_mean&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;y_mean&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800.0, 1300.0)
</pre></div>
</div>
<img alt="../../../_images/3d29394cce3a41fd154efcb7e29454a74044da0a23112581f8c9213577a86404.png" src="../../../_images/3d29394cce3a41fd154efcb7e29454a74044da0a23112581f8c9213577a86404.png" />
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="option-b"></a></p>
</section>
<section id="option-b-start-with-a-synthetic-image">
<h3>Option B: Start with a synthetic image<a class="headerlink" href="#option-b-start-with-a-synthetic-image" title="Permalink to this heading">#</a></h3>
<p>In this Option, we start with the <code class="docutils literal notranslate"><span class="pre">raw</span></code> file from the <code class="docutils literal notranslate"><span class="pre">jd0q14ctq</span></code> dataset and process the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions to make a completely synthetic dataset. We then process it appropriately for use in the forward model.</p>
<p><a id="B4"></a></p>
</section>
<section id="b-create-a-synthetic-image">
<h3>4B. Create a synthetic image<a class="headerlink" href="#b-create-a-synthetic-image" title="Permalink to this heading">#</a></h3>
<p>We will create an image that is equivalent to a <code class="docutils literal notranslate"><span class="pre">blc_tmp</span></code> file. This means that the image is not flat-fielded and includes sky background, Poisson noise from the sky, artificial stars or other sources, Poisson noise from the sources, dark current, and dark noise.</p>
<p>We first process the data with <code class="docutils literal notranslate"><span class="pre">acsccd</span></code> within <code class="docutils literal notranslate"><span class="pre">acstools</span></code> to create a <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code>. This ensures that the error (<code class="docutils literal notranslate"><span class="pre">ERR</span></code>) and data quality (<code class="docutils literal notranslate"><span class="pre">DQ</span></code>) extensions are created and the header keywords for every extension are initially populated, which is necessary for the CTE forward model to run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acsccd</span><span class="o">.</span><span class="n">acsccd</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_raw.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Trying to open jd0q14ctq_raw.fits...
Read in Primary header from jd0q14ctq_raw.fits...


CALBEG*** ACSCCD -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 17:12:24 UTC
Input    jd0q14ctq_raw.fits
Output   jd0q14ctq_blv_tmp.fits
Trying to open jd0q14ctq_raw.fits...
Read in Primary header from jd0q14ctq_raw.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  PERFORM
DQITAB   jref$25g1256nj_bpx.fits
DQITAB   PEDIGREE=INFLIGHT 30/03/2002 30/05/2002
DQITAB   DESCRIP =FITS reference table for bad pixel locations on ACS WFC
DQICORR  COMPLETE


BIASCORR PERFORM
BIASFILE jref$66418280j_bia.fits
BIASFILE PEDIGREE=INFLIGHT 12/02/2016 09/03/2016
BIASFILE DESCRIP =Standard full-frame bias for data taken after Feb 11 2016 08:10:42-
BIASCORR COMPLETE


BLEVCORR PERFORM
OSCNTAB  jref$17717071j_osc.fits
OSCNTAB  PEDIGREE=GROUND
OSCNTAB  DESCRIP =New OSCNTAB which includes entries for all subarrays.--------------
BLEVCORR PERFORM
Performing bias-shift and cross talk corrections for full frame data.
BLEVCORR PERFORM
Bias shift correcting for bias level in Amp A of 4217.9877 electrons.
Bias shift correcting for bias level in Amp A of 4217.9877 electrons.
Bias shift correcting for bias level in Amp B of 4025.7480 electrons.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bias shift correcting for bias level in Amp B of 4025.7480 electrons.
Bias shift correcting for bias level in Amp C of 4437.9683 electrons.
Bias shift correcting for bias level in Amp C of 4437.9683 electrons.
Bias shift correcting for bias level in Amp D of 4624.3633 electrons.
Performing stripe removal and bias level subtraction for full frame data.
Bias shift correcting for bias level in Amp D of 4624.3633 electrons.
Bias shift correcting for bias level in Amp D of 4624.3633 electrons.
Bias shift correcting for bias level in Amp D of 4624.3633 electrons.
Bias shift correcting for bias level in Amp D of 4624.3633 electrons.
     bias level of 0.561443 electrons was subtracted for AMP A.
     bias level of -0.0598474 electrons was subtracted for AMP B.
     bias level of -0.32127 electrons was subtracted for AMP C.
     bias level of 0.5666 electrons was subtracted for AMP D.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BLEVCORR COMPLETE
Full Frame adjusted Darktime: 342.239197

DARKTIME from SCI header: 342.239197  Offset from CCDTAB: 0.000000  Final DARKTIME: 342.239197

Full-well saturation flagging being performed for imset 1.

Full-frame full-well saturation image flagging step being performed.

Full-frame full-well saturation image flagging step done.


Full-well saturation flagging being performed for imset 2.

Full-frame full-well saturation image flagging step being performed.

Full-frame full-well saturation image flagging step done.


    Uncertainty array initialized,
    readnoise =4.35,3.75,4.05,5.05
    gain =2.02,1.886,2.017,2.011
   default bias levels =4242,4060.6,4481.8,4645.4


SINKCORR PERFORM
SNKCFILE jref$25e1534hj_snk.fits
SNKCFILE PEDIGREE=INFLIGHT 12/02/2016 09/03/2016
SNKCFILE DESCRIP =Sink pixel reference file ----------------------------
SINKCORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>End      31-Dec-2024 17:12:25 UTC


*** ACSCCD complete ***
</pre></div>
</div>
</div>
</div>
<p>Next, we obtain the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions from the <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code> file, and set the pixels to zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;jd0q14ctq_blv_tmp.fits&#39;</span><span class="p">)</span>
    
<span class="n">wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">wfc1</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
<span class="n">wfc2</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We then generate an image containing a user-selected sky background level (here we choose 40 electrons arbitrarily) and Poisson noise. Finally, we sum the noise image and the artificial star image, and save the result as a new file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise_image</span> <span class="o">=</span> <span class="n">make_noise_image</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;poisson&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>

<span class="n">wfc1</span> <span class="o">+=</span> <span class="n">noise_image</span> <span class="o">+</span> <span class="n">synth_stars_image</span>
<span class="n">wfc2</span> <span class="o">+=</span> <span class="n">noise_image</span> <span class="o">+</span> <span class="n">synth_stars_image</span>

<span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;synth.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Below we plot a portion of the synthetic image, with sources circled in red.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">synth</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;synth.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">synth</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> 
          <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;x_mean&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;y_mean&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800.0, 1300.0)
</pre></div>
</div>
<img alt="../../../_images/e6f12cf804f1ee53b3293a8b0e61e8add8a26a160478d6cf219ff7e8c8058e33.png" src="../../../_images/e6f12cf804f1ee53b3293a8b0e61e8add8a26a160478d6cf219ff7e8c8058e33.png" />
</div>
</div>
<p>In order to properly remove the dark current after the forward model is run, we update the exposure time and flash duration header keywords, <code class="docutils literal notranslate"><span class="pre">EXPTIME</span></code> and <code class="docutils literal notranslate"><span class="pre">FLASHDUR</span></code>, with the desired simulated exposure time. The total exposure time used for the dark correction is the combination of exposure time, flash duration, and overhead (which depends on whether the data are post-flashed or not). Here we set <code class="docutils literal notranslate"><span class="pre">EXPTIME</span></code> to 300 seconds and <code class="docutils literal notranslate"><span class="pre">FLASHDUR</span></code> to 0 seconds. In principle one should retrieve the overheads from CCDTAB, but we provide a simpler approach here. Please note that the overhead times may change.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exptime</span> <span class="o">=</span> <span class="mf">300.</span>
<span class="n">flashdur</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;synth.fits&#39;</span><span class="p">)</span>

<span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>

<span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;EXPTIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exptime</span>
<span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;FLASHDUR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flashdur</span>

<span class="k">if</span> <span class="n">flashdur</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">overhead</span> <span class="o">=</span> <span class="mf">2.43</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">overhead</span> <span class="o">=</span> <span class="mf">0.21</span>

<span class="n">darktime</span> <span class="o">=</span> <span class="n">exptime</span> <span class="o">+</span> <span class="n">flashdur</span> <span class="o">+</span> <span class="n">overhead</span>
</pre></div>
</div>
</div>
</div>
<p>We need to update the FITS header with the correct dark time for use in a later step. <strong>However, we leave off the overhead, because ACSCCD (run in a later step) will automatically append the overhead to the dark time in the header.</strong> We still use the darktime variable with overhead to manually add the dark current to our model below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;DARKTIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">darktime</span> <span class="o">-</span> <span class="n">overhead</span>
</pre></div>
</div>
</div>
</div>
<p>Next, obtain the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions of both CCDs. We then multiply by the flat and scale the CTE-corrected dark by a chosen exposure time. We also run the scaled dark image through a Poisson sampler to include Poisson noise in the dark scene. We then add the dark current to the image. If post-flash is desired, multiply the flash reference file by the flash duration, run it through a Poisson sampler, and add to the synthetic data. This is shown in the commented out lines below. We save the result, which is now effectively a <code class="docutils literal notranslate"><span class="pre">blc_tmp</span></code> file. <strong>Note: It is not recommended to use a simulated exposure time that scales pixels in the dark or flash image to or above the full well depth of ~80,000 electrons.</strong></p>
<p>Note that these reference files are specific to the anneal cycle in which these data were taken. If an observation date other than that listed in the <code class="docutils literal notranslate"><span class="pre">DATE-OBS</span></code> header keyword is desired for the synthetic data, different reference files will be needed. These can be found by updating the <code class="docutils literal notranslate"><span class="pre">DATE-OBS</span></code> header keyword in the synthetic image to the desired observation date, and rerunning the cell in <span class="xref myst">Step 2</span> which uses <code class="docutils literal notranslate"><span class="pre">CRDS</span> <span class="pre">bestrefs</span></code> to download the correct reference files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">wfc1</span> <span class="o">*=</span> <span class="n">flat_wfc1</span>
<span class="n">wfc2</span> <span class="o">*=</span> <span class="n">flat_wfc2</span>

<span class="n">wfc1</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">dkc_wfc1</span><span class="o">*</span><span class="n">darktime</span><span class="p">)</span>
<span class="n">wfc2</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">dkc_wfc2</span><span class="o">*</span><span class="n">darktime</span><span class="p">)</span>

<span class="c1"># wfc1 += np.random.poisson(flash_wfc1*flashdur)</span>
<span class="c1"># wfc2 += np.random.poisson(flash_wfc2*flashdur)</span>

<span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;synth_blc_tmp.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="B5"></a></p>
</section>
<section id="b-run-cte-forward-model">
<h3>5B. Run CTE forward model<a class="headerlink" href="#b-run-cte-forward-model" title="Permalink to this heading">#</a></h3>
<p>We are now ready to run the CTE forward model, which simulates the effects of CTE losses while reading out the detector. In this example, we will use the <code class="docutils literal notranslate"><span class="pre">acstools</span></code> module <code class="docutils literal notranslate"><span class="pre">acscteforwardmodel</span></code>. Note that this step may take a few minutes. The resulting filename will be <code class="docutils literal notranslate"><span class="pre">*_ctefmod.fits</span></code>. We rename this to <code class="docutils literal notranslate"><span class="pre">*_blv_tmp.fits</span></code> in order to ensure the correct behavior from <code class="docutils literal notranslate"><span class="pre">acs2d</span></code> in a later step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acscteforwardmodel</span><span class="o">.</span><span class="n">acscteforwardmodel</span><span class="p">(</span><span class="s1">&#39;synth_blc_tmp.fits&#39;</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;synth_blc_tmp_ctefmod.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;synth_ctefmod_blv_tmp.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Setting max threads to 4 out of 4 available
Trying to open synth_blc_tmp.fits...
Read in Primary header from synth_blc_tmp.fits...


CALBEG*** ACSCTE -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 17:12:28 UTC
Input    synth_blc_tmp.fits
Output   synth_blc_tmp_ctefmod.fits
Trying to open synth_blc_tmp.fits...
Read in Primary header from synth_blc_tmp.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


PCTECORR PERFORM
PCTEFILE jref$8ch1518tj_cte.fits
PCTEFILE PEDIGREE=INFLIGHT 01/03/2002 22/07/2010
PCTEFILE DESCRIP =Parameters needed for gen3 pixel-based CTE correction -----------
Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...
(pctecorr) Parallel and Serial PCTETAB file auto-detected.
(pctecorr) Reading CTE parameters from PCTETAB file: &#39;jref$8ch1518tj_cte.fits&#39;...
(pctecorr) Collecting data for Correction Type: parallel.

Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...

CTE_NAME: Par/Serial PixelCTE 2023
CTE_VER: 3.0
PCTERNOI: 4.300000
PCTENSMD: 0
PCTETRSH: -10
FIXROCR: 1
Opening jref$8ch1518tj_cte.fits[1] to read QPROF table.
CTEDATE0: 52334.9
CTEDATE1: 57710.4
PCTETLEN: 60
PCTENFOR: 5
PCTENPAR: 7
Opening jref$8ch1518tj_cte.fits[2] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 1.
Reading in image from CPROF EXTVER 1.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
(pctecorr) The parallel CTE processing parameters have been read.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.300000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 5
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 7
(pctecorr) CTE_FRAC: 0.951805

(pctecorr) NOTE: No serial CTE correction is done for any subarray data.

(pctecorr) Collecting data for Correction Type: serial 

Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...

CTE_NAME: Par/Serial PixelCTE 2023
CTE_VER: 3.0
PCTERNOI: 4.300000
PCTENSMD: 0
PCTETRSH: -10
FIXROCR: 1
Opening jref$8ch1518tj_cte.fits[13] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[14] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 4.
Reading in image from CPROF EXTVER 4.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.300000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp C.
(pctecorr) Read noise level from CCDTAB: 4.050000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: C
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -7847.236328 (-0.003547%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: C

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp C.
(pctecorr) Read noise level from CCDTAB: 4.050000.
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -300147.500000 (-0.135668%)
(pctecorr) CTE run time for current chip: 22.00(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[17] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[18] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 5.
Reading in image from CPROF EXTVER 5.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.050000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp D.
(pctecorr) Read noise level from CCDTAB: 5.050000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: D

(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -6596.672852 (-0.002837%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: D

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp D.
(pctecorr) Read noise level from CCDTAB: 5.050000.
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -312056.843750 (-0.134198%)
(pctecorr) CTE run time for current chip: 22.06(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[5] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[6] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 2.
Reading in image from CPROF EXTVER 2.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 5.050000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp A.
(pctecorr) Read noise level from CCDTAB: 4.350000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: A

(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -6695.199707 (-0.003170%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: A

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp A.
(pctecorr) Read noise level from CCDTAB: 4.350000.
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -301336.625000 (-0.142699%)
(pctecorr) CTE run time for current chip: 21.44(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[9] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[10] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 3.
Reading in image from CPROF EXTVER 3.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.350000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp B.
(pctecorr) Read noise level from CCDTAB: 3.750000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: B

(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -11378.298828 (-0.005034%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: B

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp B.
(pctecorr) Read noise level from CCDTAB: 3.750000.
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running forward model simulation...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: -311240.125000 (-0.137718%)
(pctecorr) CTE run time for current chip: 22.55(s) with 4 procs/threads

PCTECORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>End      31-Dec-2024 17:13:57 UTC


*** ACSCTE complete ***
</pre></div>
</div>
</div>
</div>
<p>At this point, we also add readnoise to the forward-modeled <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions to complete the readout simulation. We find the readnoise values for each quadrant of the image from the header keywords <code class="docutils literal notranslate"><span class="pre">READNSEA</span></code>, <code class="docutils literal notranslate"><span class="pre">READNSEB</span></code>, etc. We make a noise image for each quadrant, concatenate quadrants A and B and quadrants C and D, and add them to the synthetic image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rn_A</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEA&#39;</span><span class="p">]</span>
<span class="n">rn_B</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEB&#39;</span><span class="p">]</span>
<span class="n">rn_C</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEC&#39;</span><span class="p">]</span>
<span class="n">rn_D</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSED&#39;</span><span class="p">]</span>

<span class="n">img_rn_A</span> <span class="o">=</span> <span class="n">make_noise_image</span><span class="p">((</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> 
                            <span class="n">mean</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="n">rn_A</span><span class="p">)</span>
<span class="n">img_rn_B</span> <span class="o">=</span> <span class="n">make_noise_image</span><span class="p">((</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> 
                            <span class="n">mean</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="n">rn_B</span><span class="p">)</span>
<span class="n">img_rn_C</span> <span class="o">=</span> <span class="n">make_noise_image</span><span class="p">((</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> 
                            <span class="n">mean</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="n">rn_C</span><span class="p">)</span>
<span class="n">img_rn_D</span> <span class="o">=</span> <span class="n">make_noise_image</span><span class="p">((</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> 
                            <span class="n">mean</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="n">rn_D</span><span class="p">)</span>

<span class="n">wfc1_rn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">img_rn_A</span><span class="p">,</span> <span class="n">img_rn_B</span><span class="p">))</span>
<span class="n">wfc2_rn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">img_rn_C</span><span class="p">,</span> <span class="n">img_rn_D</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_blv_tmp.fits&#39;</span><span class="p">)</span>

<span class="n">wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">wfc1</span> <span class="o">+=</span> <span class="n">wfc1_rn</span>
<span class="n">wfc2</span> <span class="o">+=</span> <span class="n">wfc2_rn</span>

<span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions of this image are now equivalent to a <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code> file, in principle. However, the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions are the original <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code> <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions plus 10% of the forward model correction. To ensure the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions are accurate, we will calculate new values for each pixel according to</p>
<p><span class="math notranslate nohighlight">\(\mathrm{ERR} = \sqrt{\mathrm{SCI} + \mathrm{RN}^2 + (\mathrm{ERR}_{\mathrm{superbias}}g)^2}\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(\mathrm{SCI}\)</span> is the pixel value in the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extension (all negative pixels are set to zero), <span class="math notranslate nohighlight">\(\mathrm{RN}\)</span> is the readnoise, <span class="math notranslate nohighlight">\(\mathrm{ERR}_{\mathrm{superbias}}\)</span> is the pixel value in the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extension of the superbias, and <span class="math notranslate nohighlight">\(g\)</span> is the gain.</p>
<p>First, we access the header and <code class="docutils literal notranslate"><span class="pre">SCI</span></code> and <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions of the forward-modeled data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">)</span>

<span class="n">sci_wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">sci_wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">err_wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">err_wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we take the readnoise and gain values for each quadrant from the header.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rn_A</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEA&#39;</span><span class="p">]</span>
<span class="n">rn_B</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEB&#39;</span><span class="p">]</span>
<span class="n">rn_C</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSEC&#39;</span><span class="p">]</span>
<span class="n">rn_D</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;READNSED&#39;</span><span class="p">]</span>

<span class="n">gain_A</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;ATODGNA&#39;</span><span class="p">]</span>
<span class="n">gain_B</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;ATODGNB&#39;</span><span class="p">]</span>
<span class="n">gain_C</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;ATODGNC&#39;</span><span class="p">]</span>
<span class="n">gain_D</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;ATODGND&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we make copies of the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions in which to set all negative values to zero. We calculate the appropriate error for each quadrant and save them to the <code class="docutils literal notranslate"><span class="pre">ERR</span></code> extensions of the forward-modeled image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sci_wfc1_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">sci_wfc1</span><span class="p">)</span>
<span class="n">sci_wfc2_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">sci_wfc2</span><span class="p">)</span>

<span class="n">sci_wfc1_pos</span><span class="p">[</span><span class="n">sci_wfc1_pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sci_wfc2_pos</span><span class="p">[</span><span class="n">sci_wfc2_pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># The superbias ERR arrays contain 20 rows of virtual overscan at the edge of </span>
<span class="c1"># each CCD furthest from the amplifier and 24 columns of physical prescan on the</span>
<span class="c1"># left and right edges.</span>
<span class="n">err_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sci_wfc1_pos</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">+</span> <span class="n">rn_A</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">err_bias_wfc1</span><span class="p">[</span><span class="mi">20</span><span class="p">:,</span> <span class="mi">24</span><span class="p">:</span><span class="mi">2072</span><span class="p">]</span><span class="o">*</span><span class="n">gain_A</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">err_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sci_wfc1_pos</span><span class="p">[:,</span> <span class="mi">2048</span><span class="p">:]</span> <span class="o">+</span> <span class="n">rn_B</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">err_bias_wfc1</span><span class="p">[</span><span class="mi">20</span><span class="p">:,</span> <span class="mi">2072</span><span class="p">:</span><span class="o">-</span><span class="mi">24</span><span class="p">]</span><span class="o">*</span><span class="n">gain_B</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">err_C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sci_wfc2_pos</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">+</span> <span class="n">rn_C</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">err_bias_wfc2</span><span class="p">[:</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span><span class="mi">2072</span><span class="p">]</span><span class="o">*</span><span class="n">gain_C</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">err_D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sci_wfc2_pos</span><span class="p">[:,</span> <span class="mi">2048</span><span class="p">:]</span> <span class="o">+</span> <span class="n">rn_D</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">err_bias_wfc2</span><span class="p">[:</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2072</span><span class="p">:</span><span class="o">-</span><span class="mi">24</span><span class="p">]</span><span class="o">*</span><span class="n">gain_D</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">err_wfc1</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">err_A</span><span class="p">,</span> <span class="n">err_B</span><span class="p">))</span>
<span class="n">err_wfc2</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">err_C</span><span class="p">,</span> <span class="n">err_D</span><span class="p">))</span>

<span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We also repopulate the DQ extensions because they reflect the processing of the original <code class="docutils literal notranslate"><span class="pre">blv_tmp</span></code> <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extensions. To do this, we reprocess the data with <code class="docutils literal notranslate"><span class="pre">DQICORR</span></code> and <code class="docutils literal notranslate"><span class="pre">SINKCORR</span></code>, both within <code class="docutils literal notranslate"><span class="pre">acsccd</span></code>, and add in the DQ extensions of the appropriate superbias file. First, we rename the synthetic image to have a filename <code class="docutils literal notranslate"><span class="pre">*_raw.fits</span></code>, or <code class="docutils literal notranslate"><span class="pre">acsccd</span></code> will fail. Then, we update the <code class="docutils literal notranslate"><span class="pre">DQICORR</span></code> and <code class="docutils literal notranslate"><span class="pre">SINKCORR</span></code> header keywords to <code class="docutils literal notranslate"><span class="pre">PERFORM</span></code> and run <code class="docutils literal notranslate"><span class="pre">acsccd</span></code>. The output will be <code class="docutils literal notranslate"><span class="pre">*_blv_tmp.fits</span></code> again.</p>
<p>This step will also add the proper overhead to <code class="docutils literal notranslate"><span class="pre">DARKTIME</span></code> header keyword, but only if using CALACS v10.3.3 or later. We first check the version.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;calacs.e --version&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.4.0 (07-May-2024)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>If your version of CALCACS is prior to v10.3.3, please update. Now let’s run ACSCCD.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;synth_ctefmod_rn_raw.fits&#39;</span><span class="p">)</span>

<span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_raw.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;DQICORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_raw.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;SINKCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>

<span class="n">acsccd</span><span class="o">.</span><span class="n">acsccd</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_raw.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Trying to open synth_ctefmod_rn_raw.fits...
Read in Primary header from synth_ctefmod_rn_raw.fits...


CALBEG*** ACSCCD -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 17:13:58 UTC
Input    synth_ctefmod_rn_raw.fits
Output   synth_ctefmod_rn_blv_tmp.fits
Trying to open synth_ctefmod_rn_raw.fits...
Read in Primary header from synth_ctefmod_rn_raw.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009
Warning    Could not find appropriate row from OSCNTAB. 
Warning    Could not find appropriate row from OSCNTAB. 


DQICORR  PERFORM
DQITAB   jref$25g1256nj_bpx.fits
DQITAB   PEDIGREE=INFLIGHT 30/03/2002 30/05/2002
DQITAB   DESCRIP =FITS reference table for bad pixel locations on ACS WFC
DQICORR  COMPLETE


BIASCORR OMIT
BIASCORR COMPLETE


BLEVCORR OMIT
Full Frame adjusted Darktime: 300.000000

DARKTIME from SCI header: 300.000000  Offset from CCDTAB: 0.000000  Final DARKTIME: 300.000000
Warning    
No Full-well saturation flagging being performed for imset 1.

Warning    
No Full-well saturation flagging being performed for imset 2.


    Uncertainty array initialized,
    readnoise =4.35,3.75,4.05,5.05
    gain =2.02,1.886,2.017,2.011
   default bias levels =4242,4060.6,4481.8,4645.4


SINKCORR PERFORM
SNKCFILE jref$25e1534hj_snk.fits
SNKCFILE PEDIGREE=INFLIGHT 12/02/2016 09/03/2016
SNKCFILE DESCRIP =Sink pixel reference file ----------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SINKCORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>End      31-Dec-2024 17:13:58 UTC


*** ACSCCD complete ***
</pre></div>
</div>
</div>
</div>
<p>Next, obtain the DQ extensions of the superbias file, and add them to the new DQ extensions of the synthetic data with a <code class="docutils literal notranslate"><span class="pre">bitwise_or</span></code> operator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">)</span>

<span class="n">dq_wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">dq_wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">dq_wfc1</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bitwise_or</span><span class="p">(</span><span class="n">dq_wfc1</span><span class="p">,</span> <span class="n">dq_bias_wfc1</span><span class="p">[</span><span class="mi">20</span><span class="p">:,</span> <span class="mi">24</span><span class="p">:</span><span class="o">-</span><span class="mi">24</span><span class="p">])</span>
<span class="n">dq_wfc2</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bitwise_or</span><span class="p">(</span><span class="n">dq_wfc2</span><span class="p">,</span> <span class="n">dq_bias_wfc2</span><span class="p">[:</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span><span class="o">-</span><span class="mi">24</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Also, acsccd assumes the input image is in DN and converts it to counts by multiplying by the gain. We defined our model in electrons though, so the acsccd conversion to electrons was unnecessary. We divide by the gains to fix this and replace the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sci_wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">sci_wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">sci_wfc1</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">/=</span> <span class="n">gain_A</span>
<span class="n">sci_wfc1</span><span class="p">[:,</span> <span class="mi">2048</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">gain_B</span>
<span class="n">sci_wfc2</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">/=</span> <span class="n">gain_C</span>
<span class="n">sci_wfc2</span><span class="p">[:,</span> <span class="mi">2048</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">gain_D</span>

<span class="n">err_wfc1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">err_wfc2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">err_wfc1</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">/=</span> <span class="n">gain_A</span>
<span class="n">err_wfc1</span><span class="p">[:,</span> <span class="mi">2048</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">gain_B</span>
<span class="n">err_wfc2</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2048</span><span class="p">]</span> <span class="o">/=</span> <span class="n">gain_C</span>
<span class="n">err_wfc2</span><span class="p">[:,</span> <span class="mi">2048</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">gain_D</span>

<span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span class="xref myst">Top of Page</span></p>
<p><a id="B6"></a></p>
</section>
<section id="b-optional-run-cte-correction">
<h3>6B. (Optional) Run CTE correction<a class="headerlink" href="#b-optional-run-cte-correction" title="Permalink to this heading">#</a></h3>
<p>If desired, we now CTE correct the forward-modeled image. To do this, we need to update the <code class="docutils literal notranslate"><span class="pre">PCTECORR</span></code> keyword to <code class="docutils literal notranslate"><span class="pre">PERFORM</span></code> again, and run <code class="docutils literal notranslate"><span class="pre">acscte</span></code> on the image. The resulting filename will be <code class="docutils literal notranslate"><span class="pre">*_blc_tmp.fits</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;PCTECORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>

<span class="n">acscte</span><span class="o">.</span><span class="n">acscte</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Setting max threads to 4 out of 4 available
Trying to open synth_ctefmod_rn_blv_tmp.fits...
Read in Primary header from synth_ctefmod_rn_blv_tmp.fits...


CALBEG*** ACSCTE -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 17:13:59 UTC
Input    synth_ctefmod_rn_blv_tmp.fits
Output   synth_ctefmod_rn_blc_tmp.fits
Trying to open synth_ctefmod_rn_blv_tmp.fits...
Read in Primary header from synth_ctefmod_rn_blv_tmp.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


PCTECORR PERFORM
PCTEFILE jref$8ch1518tj_cte.fits
PCTEFILE PEDIGREE=INFLIGHT 01/03/2002 22/07/2010
PCTEFILE DESCRIP =Parameters needed for gen3 pixel-based CTE correction -----------
Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...
(pctecorr) Parallel and Serial PCTETAB file auto-detected.
(pctecorr) Reading CTE parameters from PCTETAB file: &#39;jref$8ch1518tj_cte.fits&#39;...
(pctecorr) Collecting data for Correction Type: parallel.

Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...

CTE_NAME: Par/Serial PixelCTE 2023
CTE_VER: 3.0
PCTERNOI: 4.300000
PCTENSMD: 0
PCTETRSH: -10
FIXROCR: 1
Opening jref$8ch1518tj_cte.fits[1] to read QPROF table.
CTEDATE0: 52334.9
CTEDATE1: 57710.4
PCTETLEN: 60
PCTENFOR: 5
PCTENPAR: 7
Opening jref$8ch1518tj_cte.fits[2] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 1.
Reading in image from CPROF EXTVER 1.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
(pctecorr) The parallel CTE processing parameters have been read.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.300000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 5
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 7
(pctecorr) CTE_FRAC: 0.951805

(pctecorr) NOTE: No serial CTE correction is done for any subarray data.

(pctecorr) Collecting data for Correction Type: serial 

Trying to open jref$8ch1518tj_cte.fits...
Read in Primary header from jref$8ch1518tj_cte.fits...

CTE_NAME: Par/Serial PixelCTE 2023
CTE_VER: 3.0
PCTERNOI: 4.300000
PCTENSMD: 0
PCTETRSH: -10
FIXROCR: 1
Opening jref$8ch1518tj_cte.fits[13] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[14] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 4.
Reading in image from CPROF EXTVER 4.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.300000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp C.
(pctecorr) Read noise level from CCDTAB: 4.050000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: C
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.66(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 7020.614258 (0.003177%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: C

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp C.
(pctecorr) Read noise level from CCDTAB: 4.050000.
(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.66(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 294275.343750 (0.133181%)
(pctecorr) CTE run time for current chip: 109.58(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[17] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[18] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 5.
Reading in image from CPROF EXTVER 5.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.050000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp D.
(pctecorr) Read noise level from CCDTAB: 5.050000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: D

(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.56(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 5900.260742 (0.002541%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: D

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp D.
(pctecorr) Read noise level from CCDTAB: 5.050000.
(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.60(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 305030.875000 (0.131336%)
(pctecorr) CTE run time for current chip: 109.71(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[5] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[6] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 2.
Reading in image from CPROF EXTVER 2.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 5.050000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp A.
(pctecorr) Read noise level from CCDTAB: 4.350000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: A

(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.60(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 6005.364258 (0.002848%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: A

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp A.
(pctecorr) Read noise level from CCDTAB: 4.350000.
(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.65(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 295008.625000 (0.139891%)
(pctecorr) CTE run time for current chip: 106.75(s) with 4 procs/threads

(pctecorr) Collecting data for Correction Type: serial 

Opening jref$8ch1518tj_cte.fits[9] to read QPROF table.
CTEDATE0: 49000
CTEDATE1: 60500
PCTETLEN: 100
PCTENFOR: 1
PCTENPAR: 1
Opening jref$8ch1518tj_cte.fits[10] to read SCLBYCOL table.
Reading in image from RPROF EXTVER 3.
Reading in image from CPROF EXTVER 3.
Begin attempt to read CTE keywords from input image header. Missing CTE keywords
from input image header are not a fatal error as the values from PCTETAB will be used.
ERROR:    Keyword = `PCTENSMD&#39;.
ERROR:    Keyword = `PCTETLEN&#39;.
ERROR:    Keyword = `PCTERNOI&#39;.
ERROR:    Keyword = `PCTENFOR&#39;.
ERROR:    Keyword = `PCTENPAR&#39;.
ERROR:    Keyword = `FIXROCR&#39;.
End attempt to read CTE keywords from input image header.
Warning    (pctecorr) IGNORING read noise level PCTERNOI from PCTETAB: 4.350000. Using amp dependent values from CCDTAB instead
(pctecorr) Readout simulation forward modeling iterations PCTENFOR: 1
(pctecorr) Number of iterations used in the parallel transfer PCTENPAR: 1
(pctecorr) CTE_FRAC: 0.734902
(pctecorr) The serial CTE processing parameters have been read.
(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type serial for amp B.
(pctecorr) Read noise level from CCDTAB: 3.750000.

(pctecorr) Invoking rotation for CTE Correction Type: serial
(pctecorr) Rotation for Amp: B

(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.67(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 10522.394531 (0.004662%)

(pctecorr) Invoking de-rotation for CTE Correction Type: serial
(pctecorr) Derotation for Amp: B

(pctecorr) Using multiprocessing provided by OpenMP inside CTE routine.
(pctecorr) Performing CTE correction type parallel for amp B.
(pctecorr) Read noise level from CCDTAB: 3.750000.
(pctecorr) Calculating smooth readnoise image...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) Time taken to smooth image: 1.70(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Creating charge trap image...
(pctecorr) Time taken to populate pixel trap map image: 0.01(s) with 4 threads
(pctecorr) ...complete.
(pctecorr) Running correction algorithm...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pctecorr) ...complete.
(pctecorr) Total count difference (corrected-raw) incurred from correction: 305812.593750 (0.135490%)
(pctecorr) CTE run time for current chip: 112.16(s) with 4 procs/threads

PCTECORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>End      31-Dec-2024 17:21:20 UTC


*** ACSCTE complete ***
</pre></div>
</div>
</div>
</div>
<p><a id="B7"></a></p>
</section>
<section id="b-apply-flat-and-dark-correction">
<h3>7B. Apply flat and dark correction<a class="headerlink" href="#b-apply-flat-and-dark-correction" title="Permalink to this heading">#</a></h3>
<p>Finally, we flat-field and dark-correct the forward-modeled image using <code class="docutils literal notranslate"><span class="pre">acs2d</span></code> to produce an <code class="docutils literal notranslate"><span class="pre">flt</span></code>-like image. We first ensure that the <code class="docutils literal notranslate"><span class="pre">DARKCORR</span></code>, <code class="docutils literal notranslate"><span class="pre">FLATCORR</span></code>, and if necessary, <code class="docutils literal notranslate"><span class="pre">FLSHCORR</span></code> header keywords are set to <code class="docutils literal notranslate"><span class="pre">PERFORM</span></code>. The resulting filename will be <code class="docutils literal notranslate"><span class="pre">*_flt.fits</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;DARKCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;FLATCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="c1"># fits.setval(&#39;synth_ctefmod_rn_blv_tmp.fits&#39;, &#39;FLSHCORR&#39;, value=&#39;PERFORM&#39;)</span>

<span class="n">acs2d</span><span class="o">.</span><span class="n">acs2d</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blv_tmp.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Trying to open synth_ctefmod_rn_blv_tmp.fits...
Read in Primary header from synth_ctefmod_rn_blv_tmp.fits...


CALBEG*** ACS2D -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 17:21:20 UTC
Input    synth_ctefmod_rn_blv_tmp.fits
Output   synth_ctefmod_rn_flt.fits
Trying to open synth_ctefmod_rn_blv_tmp.fits...
Read in Primary header from synth_ctefmod_rn_blv_tmp.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


Imset 1  Begin 17:21:20 UTC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  OMIT


DARKCORR PERFORM
DARKFILE jref$78f18443j_drk.fits
DARKFILE PEDIGREE=INFLIGHT 12/02/2016 09/03/2016
DARKFILE DESCRIP =Standard full-frame dark for data taken after Feb 11 2016 08:10:42-
Darktime from header 300.000000
Mean of dark image (MEANDARK) = 3.56748
DARKCORR COMPLETE


FLSHCORR OMIT


FLATCORR PERFORM
PFLTFILE jref$qb12257oj_pfl.fits
PFLTFILE PEDIGREE=INFLIGHT 18/04/2002 - 04/07/2006
PFLTFILE DESCRIP =Flats: P(Lab)*L(Flight)*delta(-81K,ISR06-06). UNCONFIRMED FWOFFSET
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FLATCORR COMPLETE


SHADCORR OMIT


PHOTCORR PERFORM
Found parameterized variable 1.
NUMPAR=1, N=1
Allocated 1 parnames
Adding parameter mjd#57451.3694 as parnames[0]
==&gt; Value of PHOTFLAM = 1.0033185e-19
==&gt; Value of PHOTPLAM = 7693.4699
==&gt; Value of PHOTBW = 434.53752
IMPHTTAB jref$4af1559ij_imp.fits
IMPHTTAB PEDIGREE=INFLIGHT 18/04/2000 29/09/2020
IMPHTTAB DESCRIP =photometry keywords reference file---------------------------------
PHOTCORR COMPLETE
Imset 1  End 17:21:20 UTC


Imset 2  Begin 17:21:20 UTC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  OMIT


DARKCORR PERFORM
Darktime from header 300.000000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean of dark image (MEANDARK) = 3.65532
DARKCORR COMPLETE


FLSHCORR OMIT


FLATCORR PERFORM
FLATCORR COMPLETE


SHADCORR OMIT


PHOTCORR PERFORM
Found parameterized variable 1.
NUMPAR=1, N=1
Allocated 1 parnames
Adding parameter mjd#57451.3694 as parnames[0]
==&gt; Value of PHOTFLAM = 1.0033185e-19
==&gt; Value of PHOTPLAM = 7693.4699
==&gt; Value of PHOTBW = 434.53752
IMPHTTAB jref$4af1559ij_imp.fits
IMPHTTAB PEDIGREE=INFLIGHT 18/04/2000 29/09/2020
IMPHTTAB DESCRIP =photometry keywords reference file---------------------------------
PHOTCORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imset 2  End 17:21:20 UTC


End      31-Dec-2024 17:21:20 UTC


*** ACS2D complete ***
</pre></div>
</div>
</div>
</div>
<p>If the forward-modeled image was CTE-corrected in <span class="xref myst">Step 6</span>, we run <code class="docutils literal notranslate"><span class="pre">acs2d</span></code> on the CTE-corrected image. The resulting filename will be <code class="docutils literal notranslate"><span class="pre">*_flc.fits</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blc_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;DARKCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="n">fits</span><span class="o">.</span><span class="n">setval</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blc_tmp.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;FLATCORR&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;PERFORM&#39;</span><span class="p">)</span>
<span class="c1"># fits.setval(&#39;synth_ctefmod_rn_blc_tmp.fits&#39;, &#39;FLSHCORR&#39;, value=&#39;PERFORM&#39;)</span>

<span class="n">acs2d</span><span class="o">.</span><span class="n">acs2d</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_blc_tmp.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>git tag: ee6a390a-dirty
git branch: HEAD
HEAD @: ee6a390a7edc9597074d481a57a6d2926d1cc1c4
Trying to open synth_ctefmod_rn_blc_tmp.fits...
Read in Primary header from synth_ctefmod_rn_blc_tmp.fits...


CALBEG*** ACS2D -- Version 10.4.0 (07-May-2024) ***
Begin    31-Dec-2024 17:21:20 UTC
Input    synth_ctefmod_rn_blc_tmp.fits
Output   synth_ctefmod_rn_flc.fits
Trying to open synth_ctefmod_rn_blc_tmp.fits...
Read in Primary header from synth_ctefmod_rn_blc_tmp.fits...
APERTURE WFCENTER
FILTER1 F775W
FILTER2 CLEAR2L
DETECTOR WFC


Imset 1  Begin 17:21:20 UTC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  OMIT


DARKCORR PERFORM
DARKFILE jref$78g0300bj_dkc.fits
DARKFILE PEDIGREE=INFLIGHT 12/02/2016 09/03/2016
DARKFILE DESCRIP =CTE corrected dark for WFC data taken after Feb 11 2016 08:10:42---
Darktime from header 300.000000
Mean of dark image (MEANDARK) = 2.95088
DARKCORR COMPLETE


FLSHCORR OMIT


FLATCORR PERFORM
PFLTFILE jref$qb12257oj_pfl.fits
PFLTFILE PEDIGREE=INFLIGHT 18/04/2002 - 04/07/2006
PFLTFILE DESCRIP =Flats: P(Lab)*L(Flight)*delta(-81K,ISR06-06). UNCONFIRMED FWOFFSET
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FLATCORR COMPLETE


SHADCORR OMIT


PHOTCORR PERFORM
Found parameterized variable 1.
NUMPAR=1, N=1
Allocated 1 parnames
Adding parameter mjd#57451.3694 as parnames[0]
==&gt; Value of PHOTFLAM = 1.0033185e-19
==&gt; Value of PHOTPLAM = 7693.4699
==&gt; Value of PHOTBW = 434.53752
IMPHTTAB jref$4af1559ij_imp.fits
IMPHTTAB PEDIGREE=INFLIGHT 18/04/2000 29/09/2020
IMPHTTAB DESCRIP =photometry keywords reference file---------------------------------
PHOTCORR COMPLETE
Imset 1  End 17:21:21 UTC


Imset 2  Begin 17:21:21 UTC


CCDTAB   jref$72m1821dj_ccd.fits
CCDTAB   PEDIGREE=inflight
CCDTAB   DESCRIP =CCD table with updated readnoise values for CCDGAIN=2.-------------
CCDTAB   DESCRIP =July 2009


DQICORR  OMIT


DARKCORR PERFORM
Darktime from header 300.000000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean of dark image (MEANDARK) = 3.04988
DARKCORR COMPLETE


FLSHCORR OMIT


FLATCORR PERFORM
FLATCORR COMPLETE


SHADCORR OMIT


PHOTCORR PERFORM
Found parameterized variable 1.
NUMPAR=1, N=1
Allocated 1 parnames
Adding parameter mjd#57451.3694 as parnames[0]
==&gt; Value of PHOTFLAM = 1.0033185e-19
==&gt; Value of PHOTPLAM = 7693.4699
==&gt; Value of PHOTBW = 434.53752
IMPHTTAB jref$4af1559ij_imp.fits
IMPHTTAB PEDIGREE=INFLIGHT 18/04/2000 29/09/2020
IMPHTTAB DESCRIP =photometry keywords reference file---------------------------------
PHOTCORR COMPLETE
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imset 2  End 17:21:21 UTC


End      31-Dec-2024 17:21:21 UTC


*** ACS2D complete ***
</pre></div>
</div>
</div>
</div>
<p>The image(s) are now prepared for further analysis appropriate for the user’s science. The cells below plot a portion of the final images, the <code class="docutils literal notranslate"><span class="pre">flt</span></code> and, if produced, the <code class="docutils literal notranslate"><span class="pre">flc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">synth_ctefmod</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_flt.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">synth_ctefmod</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> 
          <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;x_mean&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;y_mean&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800.0, 1300.0)
</pre></div>
</div>
<img alt="../../../_images/1bb79a47ce3d24f808c04780b6f5c3739bc3b345d8bb1d05c3fc7ca6435ffb59.png" src="../../../_images/1bb79a47ce3d24f808c04780b6f5c3739bc3b345d8bb1d05c3fc7ca6435ffb59.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">synth_ctefmod_flc</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="s1">&#39;synth_ctefmod_rn_flc.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">synth_ctefmod_flc</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">,</span> 
          <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;x_mean&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;y_mean&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(800.0, 1300.0)
</pre></div>
</div>
<img alt="../../../_images/014ab13f738ac4c39c4270942a0970aa2f1cb5b31acb17cf013fda08dcf7ded6.png" src="../../../_images/014ab13f738ac4c39c4270942a0970aa2f1cb5b31acb17cf013fda08dcf7ded6.png" />
</div>
</div>
</section>
<section id="for-more-help">
<h3>For more help:<a class="headerlink" href="#for-more-help" title="Permalink to this heading">#</a></h3>
<p>More details may be found on the <a class="reference external" href="http://www.stsci.edu/hst/instrumentation/acs">ACS website</a> and in the <a class="reference external" href="https://hst-docs.stsci.edu/display/ACSIHB">ACS Instrument</a> and <a class="reference external" href="http://www.stsci.edu/files/live/sites/www/files/home/hst/instrumentation/acs/documentation/other-documents/_documents/acs_dhb.pdf">Data Handbooks</a>.</p>
<p>Please visit the <a class="reference external" href="http://hsthelp.stsci.edu">HST Help Desk</a>. Through the help desk portal, you can explore the HST Knowledge Base and request additional help from experts.</p>
<p><a id="about_ID"></a></p>
</section>
<section id="about-this-notebook">
<h3>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h3>
<p><strong>Author:</strong> Jenna Ryon, ACS Instrument Team <br>
<strong>Updated On:</strong> 04/21/2022</p>
<hr class="docutils" />
<p><span class="xref myst">Top of Page</span>
<a class="reference internal" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a>
<br></br>
<br></br></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/ACS/acs_cte_forward_model"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../acs_saturation_trails/acs_saturation_trails.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">ACS Linearity with Saturated Stars</p>
      </div>
    </a>
    <a class="right-next"
       href="../acs_subarrays/acs_subarrays.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ACS Image Reduction for Subarray Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-update-stenv">0. Install/update stenv</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#astroconda-is-no-longer-supported-and-is-superseded-by-stenv">*AstroConda is no longer supported and is superseded by stenv.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">1. Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data-and-reference-files">2. Download data and reference files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-image-of-artificial-stars">3. Create image of artificial stars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#option-a-start-with-an-observed-flc-image">Option A: Start with an observed FLC image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-add-artificial-stars">4A. Add artificial stars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-reverse-the-flat-and-dark-correction">5A. Reverse the flat and dark correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-run-cte-forward-model">6A. Run CTE forward model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-7a-run-cte-correction">(Optional) 7A. Run CTE correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-apply-flat-and-dark-correction">8A. Apply flat and dark correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#option-b-start-with-a-synthetic-image">Option B: Start with a synthetic image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-create-a-synthetic-image">4B. Create a synthetic image</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-run-cte-forward-model">5B. Run CTE forward model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-optional-run-cte-correction">6B. (Optional) Run CTE correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-apply-flat-and-dark-correction">7B. Apply flat and dark correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-more-help">For more help:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>